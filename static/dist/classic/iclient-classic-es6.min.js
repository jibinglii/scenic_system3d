/*!
 * 
 *          iclient-classic.(http://iclient.supermap.io)
 *          Copyright© 2000 - 2019 SuperMap Software Co.Ltd
 *          license: Apache-2.0
 *          version: v9.1.2
 *         
 */!function(e){var t={};function r(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(s,n,function(t){return e[t]}.bind(null,n));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(e,t){e.exports=function(){try{return mapv}catch(e){return{}}}()},function(e,t){e.exports=function(){try{return XLSX}catch(e){return{}}}()},function(e,t,r){var s,n,i;n=[t,e],void 0===(i="function"==typeof(s=function(e,t){"use strict";var r={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function s(e){try{delete window[e]}catch(t){window[e]=void 0}}function n(e){var t=document.getElementById(e);document.getElementsByTagName("head")[0].removeChild(t)}t.exports=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=e,o=t.timeout||r.timeout,a=t.jsonpCallback||r.jsonpCallback,l=void 0;return new Promise(function(r,u){var h=t.jsonpCallbackFunction||"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),c=a+"_"+h;window[h]=function(e){r({ok:!0,json:function(){return Promise.resolve(e)}}),l&&clearTimeout(l),n(c),s(h)},i+=-1===i.indexOf("?")?"?":"&";var p=document.createElement("script");p.setAttribute("src",""+i+a+"="+h),p.id=c,document.getElementsByTagName("head")[0].appendChild(p),l=setTimeout(function(){u(new Error("JSONP request to "+e+" timed out")),s(h),n(c)},o)})}})?s.apply(t,n):s)||(e.exports=i)},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){e.exports=function(){try{return echarts}catch(e){return{}}}()},function(e,t,r){(function(t){!function(r){var s=setTimeout;function n(){}function i(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],h(e,this)}function o(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn(function(){var r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){var s;try{s=r(e._value)}catch(e){return void l(t.promise,e)}a(t.promise,s)}else(1===e._state?a:l)(t.promise,e._value)})):e._deferreds.push(t)}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var r=t.then;if(t instanceof i)return e._state=3,e._value=t,void u(e);if("function"==typeof r)return void h((s=r,n=t,function(){s.apply(n,arguments)}),e)}e._state=1,e._value=t,u(e)}catch(t){l(e,t)}var s,n}function l(e,t){e._state=2,e._value=t,u(e)}function u(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,r=e._deferreds.length;t<r;t++)o(e,e._deferreds[t]);e._deferreds=null}function h(e,t){var r=!1;try{e(function(e){r||(r=!0,a(t,e))},function(e){r||(r=!0,l(t,e))})}catch(e){if(r)return;r=!0,l(t,e)}}i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var r=new this.constructor(n);return o(this,new function(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}(e,t,r)),r},i.all=function(e){var t=Array.prototype.slice.call(e);return new i(function(e,r){if(0===t.length)return e([]);var s=t.length;function n(i,o){try{if(o&&("object"==typeof o||"function"==typeof o)){var a=o.then;if("function"==typeof a)return void a.call(o,function(e){n(i,e)},r)}t[i]=o,0==--s&&e(t)}catch(e){r(e)}}for(var i=0;i<t.length;i++)n(i,t[i])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,r){r(e)})},i.race=function(e){return new i(function(t,r){for(var s=0,n=e.length;s<n;s++)e[s].then(t,r)})},i._immediateFn="function"==typeof t&&function(e){t(e)}||function(e){s(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},void 0!==e&&e.exports?e.exports=i:r.Promise||(r.Promise=i)}(this)}).call(this,r(11).setImmediate)},function(e,t){e.exports=function(){try{return elasticsearch}catch(e){return{}}}()},function(e,t,r){"use strict";r.r(t);
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
var s=window.SuperMap=window.SuperMap||{};s.Widgets=window.SuperMap.Widgets||{};
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class n{constructor(e,t,r){this.x=e?parseFloat(e):0,this.y=t?parseFloat(t):0,this.mode=r,this.CLASS_NAME="SuperMap.Pixel",s.Pixel.Mode={LeftTop:"lefttop",RightTop:"righttop",RightBottom:"rightbottom",LeftBottom:"leftbottom"}}toString(){return"x="+this.x+",y="+this.y}clone(){return new n(this.x,this.y,this.mode)}equals(e){var t=!1;return null!=e&&(t=this.x==e.x&&this.y==e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)),t}distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}add(e,t){if(null==e||null==t)throw new TypeError("Pixel.add cannot receive null values");return new n(this.x+e,this.y+t)}offset(e){var t=this.clone();return e&&(t=this.add(e.x,e.y)),t}destroy(){this.x=null,this.y=null,this.mode=null}}s.Pixel=n,
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
s.inherit=function(e,t){var r,n,i,o=function(){};for(o.prototype=t.prototype,e.prototype=new o,r=2,n=arguments.length;r<n;r++)"function"==typeof(i=arguments[r])&&(i=i.prototype),s.Util.extend(e.prototype,i)},s.mixin=function(...e){class t{constructor(t){for(var r=0;r<e.length;r++)n(this,new e[r](t))}}for(var r=0;r<e.length;r++){var s=e[r];n(t,s),n(t.prototype,s.prototype),n(t.prototype,new s)}return t;function n(e,t){var r=Object.getOwnPropertyNames(t);Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t)));for(var s=0;s<r.length;s++){var n=r[s];if("constructor"!==n&&"prototype"!==n&&"name"!==n&&"length"!==n){let r=Object.getOwnPropertyDescriptor(t,n);window.ActiveXObject?Object.defineProperty(e,n,r||{}):Object.defineProperty(e,n,r)}}}};s.String={startsWith:function(e,t){return 0==e.indexOf(t)},contains:function(e,t){return-1!=e.indexOf(t)},trim:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(e){for(var t=e.split("-"),r=t[0],s=1,n=t.length;s<n;s++){var i=t[s];r+=i.charAt(0).toUpperCase()+i.substring(1)}return r},format:function(e,t,r){t||(t=window);return e.replace(s.String.tokenRegEx,function(e,s){for(var n,i=s.split(/\.+/),o=0;o<i.length;o++)0==o&&(n=t),n=n[i[o]];return"function"==typeof n&&(n=r?n.apply(null,r):n()),void 0===n?"undefined":n})},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(e){return s.String.numberRegEx.test(e)},numericIf:function(e){return s.String.isNumeric(e)?parseFloat(e):e}};var i=s.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(e,t){var r=0;return t>0&&(r=parseFloat(e.toPrecision(t))),r},format:function(e,t,r,n){t=void 0!==t?t:0,r=void 0!==r?r:s.Number.thousandsSeparator,n=void 0!==n?n:s.Number.decimalSeparator,null!=t&&(e=parseFloat(e.toFixed(t)));var i=e.toString().split(".");1===i.length&&null==t&&(t=0);var o,a=i[0];if(r)for(var l=/(-?[0-9]+)([0-9]{3})/;l.test(a);)a=a.replace(l,"$1"+r+"$2");if(0==t)o=a;else{var u=i.length>1?i[1]:"0";null!=t&&(u+=new Array(t-u.length+1).join("0")),o=a+n+u}return o}};Number.prototype.limitSigDigs||(Number.prototype.limitSigDigs=function(e){return i.limitSigDigs(this,e)});var o,a,l,u=s.Function={bind:function(e,t){var r=Array.prototype.slice.apply(arguments,[2]);return function(){var s=r.concat(Array.prototype.slice.apply(arguments,[0]));return e.apply(t,s)}},bindAsEventListener:function(e,t){return function(r){return e.call(t,r||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}},h=(s.Array={filter:function(e,t,r){var s=[];if(Array.prototype.filter)s=e.filter(t,r);else{var n=e.length;if("function"!=typeof t)throw new TypeError;for(var i=0;i<n;i++)if(i in e){var o=e[i];t.call(r,o,i,e)&&s.push(o)}}return s}},s.Util=s.Util||{});s.Util.extend=function(e,t){if(e=e||{},t){for(var r in t){var s=t[r];void 0!==s&&(e[r]=s)}!("function"==typeof window.Event&&t instanceof window.Event)&&t.hasOwnProperty&&t.hasOwnProperty("toString")&&(e.toString=t.toString)}return e},s.Util.copy=function(e,t){var r;if(e=e||{},t)for(var s in e)void 0!==(r=t[s])&&(e[s]=r)},s.Util.reset=function(e){for(var t in e=e||{})if(e.hasOwnProperty(t)){if("object"==typeof e[t]&&e[t]instanceof Array){for(var r in e[t])e[t][r].destroy&&e[t][r].destroy();e[t].length=0}else"object"==typeof e[t]&&e[t]instanceof Object&&e[t].destroy&&e[t].destroy();e[t]=null}},s.Util.getElement=function(){for(var e=[],t=0,r=arguments.length;t<r;t++){var s=arguments[t];if("string"==typeof s&&(s=document.getElementById(s)),1===arguments.length)return s;e.push(s)}return e},s.Util.isElement=function(e){return!(!e||1!==e.nodeType)},s.Util.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},s.Util.removeItem=function(e,t){for(var r=e.length-1;r>=0;r--)e[r]===t&&e.splice(r,1);return e},s.Util.indexOf=function(e,t){if(null==e)return-1;if("function"==typeof e.indexOf)return e.indexOf(t);for(var r=0,s=e.length;r<s;r++)if(e[r]===t)return r;return-1},s.Util.modifyDOMElement=function(e,t,r,s,n,i,o,a){t&&(e.id=t),r&&(e.style.left=r.x+"px",e.style.top=r.y+"px"),s&&(e.style.width=s.w+"px",e.style.height=s.h+"px"),n&&(e.style.position=n),i&&(e.style.border=i),o&&(e.style.overflow=o),parseFloat(a)>=0&&parseFloat(a)<1?(e.style.filter="alpha(opacity="+100*a+")",e.style.opacity=a):1===parseFloat(a)&&(e.style.filter="",e.style.opacity="")},s.Util.applyDefaults=function(e,t){e=e||{};var r="function"==typeof window.Event&&t instanceof window.Event;for(var s in t)(void 0===e[s]||!r&&t.hasOwnProperty&&t.hasOwnProperty(s)&&!e.hasOwnProperty(s))&&(e[s]=t[s]);return!r&&t&&t.hasOwnProperty&&t.hasOwnProperty("toString")&&!e.hasOwnProperty("toString")&&(e.toString=t.toString),e},s.Util.getParameterString=function(e){var t=[];for(var r in e){var s=e[r];if(null!=s&&"function"!=typeof s){var n;if("object"==typeof s&&s.constructor===Array){for(var i,o=[],a=0,l=s.length;a<l;a++)i=s[a],o.push(encodeURIComponent(null===i||void 0===i?"":i));n=o.join(",")}else n=encodeURIComponent(s);t.push(encodeURIComponent(r)+"="+n)}}return t.join("&")},s.Util.urlAppend=function(e,t){var r=e;if(t){var s=(e+" ").split(/[?&]/);r+=" "===s.pop()?t:s.length?"&"+t:"?"+t}return r},s.Util.DEFAULT_PRECISION=14,s.Util.toFloat=function(e,t){return null==t&&(t=s.Util.DEFAULT_PRECISION),"number"!=typeof e&&(e=parseFloat(e)),0===t?e:parseFloat(e.toPrecision(t))},s.Util.rad=function(e){return e*Math.PI/180},s.Util.getParameters=function(e){e=null===e||void 0===e?window.location.href:e;var t="";if(s.String.contains(e,"?")){var r=e.indexOf("?")+1,n=s.String.contains(e,"#")?e.indexOf("#"):e.length;t=e.substring(r,n)}for(var i={},o=t.split(/[&;]/),a=0,l=o.length;a<l;++a){var u=o[a].split("=");if(u[0]){var h=u[0];try{h=decodeURIComponent(h)}catch(e){h=unescape(h)}var c=(u[1]||"").replace(/\+/g," ");try{c=decodeURIComponent(c)}catch(e){c=unescape(c)}1==(c=c.split(",")).length&&(c=c[0]),i[h]=c}}return i},s.Util.lastSeqID=0,s.Util.createUniqueID=function(e){return null==e&&(e="id_"),s.Util.lastSeqID+=1,e+s.Util.lastSeqID},s.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.3701,km:39370.1,dd:4374754,yd:36},s.INCHES_PER_UNIT.in=s.INCHES_PER_UNIT.inches,s.INCHES_PER_UNIT.degrees=s.INCHES_PER_UNIT.dd,s.INCHES_PER_UNIT.nmi=1852*s.INCHES_PER_UNIT.m,s.METERS_PER_INCH=.0254000508001016,s.Util.extend(s.INCHES_PER_UNIT,{Inch:s.INCHES_PER_UNIT.inches,Meter:1/s.METERS_PER_INCH,Foot:.3048006096012192/s.METERS_PER_INCH,IFoot:.3048/s.METERS_PER_INCH,ClarkeFoot:.3047972651151/s.METERS_PER_INCH,SearsFoot:.30479947153867626/s.METERS_PER_INCH,GoldCoastFoot:.3047997101815088/s.METERS_PER_INCH,IInch:.0254/s.METERS_PER_INCH,MicroInch:254e-7/s.METERS_PER_INCH,Mil:2.54e-8/s.METERS_PER_INCH,Centimeter:.01/s.METERS_PER_INCH,Kilometer:1e3/s.METERS_PER_INCH,Yard:.9144018288036576/s.METERS_PER_INCH,SearsYard:.914398414616029/s.METERS_PER_INCH,IndianYard:.9143985307444408/s.METERS_PER_INCH,IndianYd37:.91439523/s.METERS_PER_INCH,IndianYd62:.9143988/s.METERS_PER_INCH,IndianYd75:.9143985/s.METERS_PER_INCH,IndianFoot:.30479951/s.METERS_PER_INCH,IndianFt37:.30479841/s.METERS_PER_INCH,IndianFt62:.3047996/s.METERS_PER_INCH,IndianFt75:.3047995/s.METERS_PER_INCH,Mile:1609.3472186944373/s.METERS_PER_INCH,IYard:.9144/s.METERS_PER_INCH,IMile:1609.344/s.METERS_PER_INCH,NautM:1852/s.METERS_PER_INCH,"Lat-66":110943.31648893273/s.METERS_PER_INCH,"Lat-83":110946.25736872235/s.METERS_PER_INCH,Decimeter:.1/s.METERS_PER_INCH,Millimeter:.001/s.METERS_PER_INCH,Dekameter:10/s.METERS_PER_INCH,Decameter:10/s.METERS_PER_INCH,Hectometer:100/s.METERS_PER_INCH,GermanMeter:1.0000135965/s.METERS_PER_INCH,CaGrid:.999738/s.METERS_PER_INCH,ClarkeChain:20.1166194976/s.METERS_PER_INCH,GunterChain:20.11684023368047/s.METERS_PER_INCH,BenoitChain:20.116782494375872/s.METERS_PER_INCH,SearsChain:20.11676512155/s.METERS_PER_INCH,ClarkeLink:.201166194976/s.METERS_PER_INCH,GunterLink:.2011684023368047/s.METERS_PER_INCH,BenoitLink:.20116782494375873/s.METERS_PER_INCH,SearsLink:.2011676512155/s.METERS_PER_INCH,Rod:5.02921005842012/s.METERS_PER_INCH,IntnlChain:20.1168/s.METERS_PER_INCH,IntnlLink:.201168/s.METERS_PER_INCH,Perch:5.02921005842012/s.METERS_PER_INCH,Pole:5.02921005842012/s.METERS_PER_INCH,Furlong:201.1684023368046/s.METERS_PER_INCH,Rood:3.778266898/s.METERS_PER_INCH,CapeFoot:.3047972615/s.METERS_PER_INCH,Brealey:375/s.METERS_PER_INCH,ModAmFt:.304812252984506/s.METERS_PER_INCH,Fathom:1.8288/s.METERS_PER_INCH,"NautM-UK":1853.184/s.METERS_PER_INCH,"50kilometers":5e4/s.METERS_PER_INCH,"150kilometers":15e4/s.METERS_PER_INCH}),s.Util.extend(s.INCHES_PER_UNIT,{mm:s.INCHES_PER_UNIT.Meter/1e3,cm:s.INCHES_PER_UNIT.Meter/100,dm:100*s.INCHES_PER_UNIT.Meter,km:1e3*s.INCHES_PER_UNIT.Meter,kmi:s.INCHES_PER_UNIT.nmi,fath:s.INCHES_PER_UNIT.Fathom,ch:s.INCHES_PER_UNIT.IntnlChain,link:s.INCHES_PER_UNIT.IntnlLink,"us-in":s.INCHES_PER_UNIT.inches,"us-ft":s.INCHES_PER_UNIT.Foot,"us-yd":s.INCHES_PER_UNIT.Yard,"us-ch":s.INCHES_PER_UNIT.GunterChain,"us-mi":s.INCHES_PER_UNIT.Mile,"ind-yd":s.INCHES_PER_UNIT.IndianYd37,"ind-ft":s.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/s.METERS_PER_INCH}),s.DOTS_PER_INCH=96,s.Util.normalizeScale=function(e){return e>1?1/e:e},s.Util.getResolutionFromScale=function(e,t){var r;e&&(null==t&&(t="degrees"),r=1/(s.Util.normalizeScale(e)*s.INCHES_PER_UNIT[t]*s.DOTS_PER_INCH));return r},s.Util.getScaleFromResolution=function(e,t){return null==t&&(t="degrees"),e*s.INCHES_PER_UNIT[t]*s.DOTS_PER_INCH},s.IS_GECKO=-1===(o=navigator.userAgent.toLowerCase()).indexOf("webkit")&&-1!==o.indexOf("gecko"),s.Browser=function(){var e,t="",r="",s="pc",n=navigator.userAgent.toLowerCase();return n.indexOf("msie")>-1||n.indexOf("trident")>-1&&n.indexOf("rv")>-1?(t="msie",e=n.match(/msie ([\d.]+)/)||n.match(/rv:([\d.]+)/)):n.indexOf("chrome")>-1?(t="chrome",e=n.match(/chrome\/([\d.]+)/)):n.indexOf("firefox")>-1?(t="firefox",e=n.match(/firefox\/([\d.]+)/)):n.indexOf("opera")>-1?(t="opera",e=n.match(/version\/([\d.]+)/)):n.indexOf("safari")>-1&&(t="safari",e=n.match(/version\/([\d.]+)/)),r=e?e[1]:"",n.indexOf("ipad")>-1||n.indexOf("ipod")>-1||n.indexOf("iphone")>-1?s="apple":n.indexOf("android")>-1&&(r=(e=n.match(/version\/([\d.]+)/))?e[1]:"",s="android"),{name:t,version:r,device:s}}(),s.Util.getBrowser=function(){return s.Browser},s.Util.isSupportCanvas=(a=!0,l=s.Util.getBrowser(),document.createElement("canvas").getContext?("firefox"===l.name&&parseFloat(l.version)<5&&(a=!1),"safari"===l.name&&parseFloat(l.version)<4&&(a=!1),"opera"===l.name&&parseFloat(l.version)<10&&(a=!1),"msie"===l.name&&parseFloat(l.version)<9&&(a=!1)):a=!1,a),s.Util.supportCanvas=function(){return s.Util.isSupportCanvas},s.INCHES_PER_UNIT.degree=s.INCHES_PER_UNIT.dd,s.INCHES_PER_UNIT.meter=s.INCHES_PER_UNIT.m,s.INCHES_PER_UNIT.foot=s.INCHES_PER_UNIT.ft,s.INCHES_PER_UNIT.inch=s.INCHES_PER_UNIT.inches,s.INCHES_PER_UNIT.mile=s.INCHES_PER_UNIT.mi,s.INCHES_PER_UNIT.kilometer=s.INCHES_PER_UNIT.km,s.INCHES_PER_UNIT.yard=s.INCHES_PER_UNIT.yd,s.Util.isInTheSameDomain=function(e){if(!e)return!0;var t=e.indexOf("//"),r=document.location.toString(),s=r.indexOf("//");if(-1===t)return!0;var n,i=n=e.substring(0,t),o=r.substring(s+2);s=o.indexOf("/");var a=o.indexOf(":"),l=o.substring(0,s),u=document.location.protocol;if(-1!==a||(l+=":"+("http:"===u.toLowerCase()?80:443)),u.toLowerCase()!==i.toLowerCase())return!1;var h=(i=e.substring(t+2)).indexOf(":");t=i.indexOf("/");var c,p=i.substring(0,t);return-1!==h?c=i.substring(0,h):(c=i.substring(0,t),p+=":"+("http:"===n.toLowerCase()?80:443)),c===document.domain&&p===l},s.Util.calculateDpi=function(e,t,r,s,n){if(e&&t&&r){var i,o=e.getWidth(),a=e.getHeight(),l=t.w,u=t.h;if(n=n||6378137,"degree"===(s=s||"degrees").toLowerCase()||"degrees"===s.toLowerCase()||"dd"===s.toLowerCase()){let e=o/l,t=a/u;i=254/(e>t?e:t)/r/(2*Math.PI*n/360)/1e4}else{i=254/(o/l)/r/1e4}return i}},s.Util.toJSON=function(e){var t=e;if(null==t)return null;switch(t.constructor){case String:return t=(t=(t=(t=(t=(t=(t='"'+t.replace(/(["\\])/g,"\\$1")+'"').replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace("<","&lt;")).replace(">","&gt;")).replace(/%/g,"%25")).replace(/&/g,"%26");case Array:for(var r=[],n=0,i=t.length;n<i;n++)r.push(s.Util.toJSON(t[n]));return"["+r.join(",")+"]";case Number:return isFinite(t)?String(t):null;case Boolean:return String(t);case Date:return"{'__type':\"System.DateTime\",'Year':"+t.getFullYear()+",'Month':"+(t.getMonth()+1)+",'Day':"+t.getDate()+",'Hour':"+t.getHours()+",'Minute':"+t.getMinutes()+",'Second':"+t.getSeconds()+",'Millisecond':"+t.getMilliseconds()+",'TimezoneOffset':"+t.getTimezoneOffset()+"}";default:if(null!=t.toJSON&&"function"==typeof t.toJSON)return t.toJSON();if("object"==typeof t){if(t.length){let e=[];for(let r=0,n=t.length;r<n;r++)e.push(s.Util.toJSON(t[r]));return"["+e.join(",")+"]"}let e=[];for(let r in t)"function"!=typeof t[r]&&"CLASS_NAME"!==r&&"parent"!==r&&e.push("'"+r+"':"+s.Util.toJSON(t[r]));return e.length>0?"{"+e.join(",")+"}":"{}"}return t.toString()}},s.Util.getResolutionFromScaleDpi=function(e,t,r,n){return n=n||6378137,r=r||"",e>0&&t>0?(e=s.Util.normalizeScale(e),"degree"===r.toLowerCase()||"degrees"===r.toLowerCase()||"dd"===r.toLowerCase()?254/t/e/(2*Math.PI*n/360)/1e4:254/t/e/1e4):-1},s.Util.getScaleFromResolutionDpi=function(e,t,r,s){return s=s||6378137,r=r||"",e>0&&t>0?"degree"===r.toLowerCase()||"degrees"===r.toLowerCase()||"dd"===r.toLowerCase()?254/t/e/(2*Math.PI*s/360)/1e4:254/t/e/1e4:-1},s.Util.transformResult=function(e){return e.responseText&&"string"==typeof e.responseText&&(e=JSON.parse(e.responseText)),e},s.Util.copyAttributes=function(e,t){if(e=e||{},t)for(var r in t){var s=t[r];void 0!==s&&"CLASS_NAME"!==r&&"function"!=typeof s&&(e[r]=s)}return e},s.Util.copyAttributesWithClip=function(e,t,r){if(e=e||{},t)for(var s in t){var n=!1;if(r&&r.length)for(var i=0,o=r.length;i<o;i++)if(s===r[i]){n=!0;break}if(!0!==n){var a=t[s];void 0!==a&&"CLASS_NAME"!==s&&"function"!=typeof a&&(e[s]=a)}}return e},s.Util.cloneObject=function(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Date){let t=new Date;return t.setTime(e.getTime()),t}if(e instanceof Array){return e.slice(0)}if(e instanceof Object){let r={};for(var t in e)e.hasOwnProperty(t)&&(r[t]=s.Util.cloneObject(e[t]));return r}throw new Error("Unable to copy obj! Its type isn't supported.")},s.Util.lineIntersection=function(e,t,r,n){var i,o,a=null,l=(n.x-r.x)*(e.y-r.y)-(n.y-r.y)*(e.x-r.x),u=(t.x-e.x)*(e.y-r.y)-(t.y-e.y)*(e.x-r.x),h=(n.y-r.y)*(t.x-e.x)-(n.x-r.x)*(t.y-e.y);if(0!=h)o=u/h,a=(i=l/h)>=0&&o<=1&&i<=1&&o>=0?new s.Geometry.Point(e.x+i*(t.x-e.x),e.y+i*(t.y-e.y)):"No Intersection";else if(0==l&&0==u){var c=Math.max(e.y,t.y),p=Math.min(e.y,t.y),d=Math.max(e.x,t.x),m=Math.min(e.x,t.x);a=(r.y>=p&&r.y<=c||n.y>=p&&n.y<=c)&&r.x>=m&&r.x<=d||n.x>=m&&n.x<=d?"Coincident":"Parallel"}else a="Parallel";return a},s.Util.getTextBounds=function(e,t,r){document.body.appendChild(r),r.style.width="auto",r.style.height="auto",e.fontSize&&(r.style.fontSize=e.fontSize),e.fontFamily&&(r.style.fontFamily=e.fontFamily),e.fontWeight&&(r.style.fontWeight=e.fontWeight),r.style.position="relative",r.style.visibility="hidden",r.style.display="inline-block",r.innerHTML=t;var s=r.clientWidth,n=r.clientHeight;return document.body.removeChild(r),{textWidth:s,textHeight:n}};
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
var c=s.Event={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(e){return e.target||e.srcElement},isSingleTouch:function(e){return e.touches&&1===e.touches.length},isMultiTouch:function(e){return e.touches&&e.touches.length>1},isLeftClick:function(e){return e.which&&1===e.which||e.button&&1===e.button},isRightClick:function(e){return e.which&&3===e.which||e.button&&2===e.button},stop:function(e,t){t||(e.preventDefault?e.preventDefault():e.returnValue=!1),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},findElement:function(e,t){for(var r=s.Event.element(e);r.parentNode&&(!r.tagName||r.tagName.toUpperCase()!=t.toUpperCase());)r=r.parentNode;return r},observe:function(e,t,r,s){var n=h.getElement(e);if(s=s||!1,"keypress"===t&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||n.attachEvent)&&(t="keydown"),this.observers||(this.observers={}),!n._eventCacheID){var i="eventCacheID_";n.id&&(i=n.id+"_"+i),n._eventCacheID=h.createUniqueID(i)}var o=n._eventCacheID;this.observers[o]||(this.observers[o]=[]),this.observers[o].push({element:n,name:t,observer:r,useCapture:s}),n.addEventListener?n.addEventListener(t,r,s):n.attachEvent&&n.attachEvent("on"+t,r)},stopObservingElement:function(e){var t=h.getElement(e)._eventCacheID;this._removeElementObservers(s.Event.observers[t])},_removeElementObservers:function(e){if(e)for(var t=e.length-1;t>=0;t--){var r=e[t],n=new Array(r.element,r.name,r.observer,r.useCapture);s.Event.stopObserving.apply(this,n)}},stopObserving:function(e,t,r,n){n=n||!1;var i=h.getElement(e),o=i._eventCacheID;"keypress"===t&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||i.detachEvent)&&(t="keydown");var a=!1,l=s.Event.observers[o];if(l)for(var u=0;!a&&u<l.length;){var c=l[u];if(c.name===t&&c.observer===r&&c.useCapture===n){l.splice(u,1),0==l.length&&delete s.Event.observers[o],a=!0;break}u++}return a&&(i.removeEventListener?i.removeEventListener(t,r,n):i&&i.detachEvent&&i.detachEvent("on"+t,r)),a},unloadCache:function(){if(s.Event&&s.Event.observers){for(var e in s.Event.observers){var t=s.Event.observers[e];s.Event._removeElementObservers.apply(this,[t])}s.Event.observers=!1}},CLASS_NAME:"SuperMap.Event"};s.Event=c,s.Event.observe(window,"unload",s.Event.unloadCache,!1);
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class p{constructor(e,t,r,s,n){if(this.BROWSER_EVENTS=["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur","touchstart","touchmove","touchend","keydown","MSPointerDown","MSPointerUp","pointerdown","pointerup","MSGestureStart","MSGestureChange","MSGestureEnd","contextmenu"],this.listeners={},this.object=e,this.element=null,this.eventTypes=[],this.eventHandler=null,this.fallThrough=s,this.includeXY=!1,this.extensions={},this.extensionCount={},this.clearMouseListener=null,h.extend(this,n),null!=r)for(var i=0,o=r.length;i<o;i++)this.addEventType(r[i]);null!=t&&this.attachToElement(t),this.CLASS_NAME="SuperMap.Events"}destroy(){for(var e in this.extensions)"boolean"!=typeof this.extensions[e]&&this.extensions[e].destroy();this.extensions=null,this.element&&(c.stopObservingElement(this.element),this.element.hasScrollEvent&&c.stopObserving(window,"scroll",this.clearMouseListener)),this.element=null,this.listeners=null,this.object=null,this.eventTypes=null,this.fallThrough=null,this.eventHandler=null}addEventType(e){this.listeners[e]||(this.eventTypes.push(e),this.listeners[e]=[])}attachToElement(e){this.element?c.stopObservingElement(this.element):(this.eventHandler=u.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=u.bind(this.clearMouseCache,this)),this.element=e;for(var t=0,r=this.BROWSER_EVENTS.length;t<r;t++){var s=this.BROWSER_EVENTS[t];this.addEventType(s),c.observe(e,s,this.eventHandler)}c.observe(e,"dragstart",c.stop)}on(e){for(var t in e)"scope"!==t&&e.hasOwnProperty(t)&&this.register(t,e.scope,e[t])}register(e,t,r,s){if(e in p&&!this.extensions[e]&&(this.extensions[e]=new p[e](this)),null!=r&&-1!==h.indexOf(this.eventTypes,e)){null==t&&(t=this.object);var n=this.listeners[e];n||(n=[],this.listeners[e]=n,this.extensionCount[e]=0);var i={obj:t,func:r};s?(n.splice(this.extensionCount[e],0,i),"object"==typeof s&&s.extension&&this.extensionCount[e]++):n.push(i)}}registerPriority(e,t,r){this.register(e,t,r,!0)}un(e){for(var t in e)"scope"!==t&&e.hasOwnProperty(t)&&this.unregister(t,e.scope,e[t])}unregister(e,t,r){null==t&&(t=this.object);var s=this.listeners[e];if(null!=s)for(var n=0,i=s.length;n<i;n++)if(s[n].obj===t&&s[n].func===r){s.splice(n,1);break}}remove(e){null!=this.listeners[e]&&(this.listeners[e]=[])}triggerEvent(e,t){var r=this.listeners[e];if(r&&0!=r.length){var s;null==t&&(t={}),t.object=this.object,t.element=this.element,t.type||(t.type=e);for(var n=0,i=(r=r.slice()).length;n<i;n++){var o=r[n];if(void 0!=(s=o.func.apply(o.obj,[t]))&&0==s)break}return this.fallThrough||c.stop(t,!0),s}}handleBrowserEvent(e){var t=e.type,r=this.listeners[t];if(r&&0!=r.length){var s=e.touches;if(s&&s[0]){for(var n,i=0,o=0,a=s.length,l=0;l<a;++l)i+=(n=s[l]).clientX,o+=n.clientY;e.clientX=i/a,e.clientY=o/a}this.includeXY&&(e.xy=this.getMousePosition(e)),this.triggerEvent(t,e)}}clearMouseCache(){this.element.scrolls=null,this.element.lefttop=null;var e=document.body;e&&(0==e.scrollTop&&0==e.scrollLeft||!navigator.userAgent.match(/iPhone/i))&&(this.element.offsets=null)}getMousePosition(e){if(this.includeXY?this.element.hasScrollEvent||(c.observe(window,"scroll",this.clearMouseListener),this.element.hasScrollEvent=!0):this.clearMouseCache(),!this.element.scrolls){var t=h.getViewportElement();this.element.scrolls=[t.scrollLeft,t.scrollTop]}return this.element.lefttop||(this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]),this.element.offsets||(this.element.offsets=h.pagePosition(this.element)),new n(e.clientX+this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],e.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])}}s.Events=p,s.Events.prototype.BROWSER_EVENTS=["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur","touchstart","touchmove","touchend","keydown","MSPointerDown","MSPointerUp","pointerdown","pointerup","MSGestureStart","MSGestureChange","MSGestureEnd","contextmenu"];var d=r(6),m=r.n(d);
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class f{constructor(e,t){t=t||{},this.url=e,this.client=new m.a.Client({host:this.url}),this.change=null,this.openGeoFence=!1,this.outOfGeoFence=null,this.geoFence=null,this.EVENT_TYPES=["change","error","outOfGeoFence"],this.events=new p(this,null,this.EVENT_TYPES),this.eventListeners=null,h.extend(this,t),this.eventListeners instanceof Object&&this.events.on(this.eventListeners)}setGeoFence(e){this.geoFence=e}bulk(e,t){return this.client.bulk(e,t)}clearScroll(e,t){return this.client.clearScroll(e,t)}count(e,t){return this.client.count(e,t)}create(e,t){return this.client.create(e,t)}delete(e,t){return this.client.delete(e,t)}deleteByQuery(e,t){return this.client.deleteByQuery(e,t)}deleteScript(e,t){return this.client.deleteScript(e,t)}deleteTemplate(e,t){return this.client.deleteTemplate(e,t)}exists(e,t){return this.client.exists(e,t)}existsSource(e,t){return this.client.existsSource(e,t)}explain(e,t){return this.client.explain(e,t)}fieldCaps(e,t){return this.client.fieldCaps(e,t)}get(e,t){return this.client.get(e,t)}getScript(e,t){return this.client.getScript(e,t)}getSource(e,t){return this.client.getSource(e,t)}getTemplate(e,t){return this.client.getTemplate(e,t)}index(e,t){return this.client.index(e,t)}info(e,t){return this.client.info(e,t)}mget(e,t){return this.client.mget(e,t)}msearch(e,t){let r=this;return r.client.msearch(e).then(function(e){return r._update(e.responses,t),e},function(e){return t(e),r.events.triggerEvent("error",{error:e}),e})}msearchTemplate(e,t){return this.client.msearchTemplate(e,t)}mtermvectors(e,t){return this.client.mtermvectors(e,t)}ping(e,t){return this.client.ping(e,t)}putScript(e,t){return this.client.putScript(e,t)}putTemplate(e,t){return this.client.putTemplate(e,t)}reindex(e,t){return this.client.reindex(e,t)}reindexRessrottle(e,t){return this.client.reindexRessrottle(e,t)}renderSearchTemplate(e,t){return this.client.renderSearchTemplate(e,t)}scroll(e,t){return this.client.scroll(e,t)}search(e,t){let r=this;return r.client.search(e).then(function(e){return r._update(e.responses,t),e},function(e){return t(e),r.events.triggerEvent("error",{error:e}),e})}searchShards(e,t){return this.client.searchShards(e,t)}searchTemplate(e,t){return this.client.searchTemplate(e,t)}suggest(e,t){return this.client.suggest(e,t)}termvectors(e,t){return this.client.termvectors(e,t)}update(e,t){return this.client.update(e,t)}updateByQuery(e,t){return this.client.updateByQuery(e,t)}_update(e,t){let r=this;e&&(r.data=e,r.openGeoFence&&r.geoFence&&r._validateDatas(e),r.events.triggerEvent("change",{data:r.data}),r.change?r.change&&r.change(e):t&&t(void 0,{responses:e}))}_validateDatas(e){if(e){e instanceof Array||(e=[e]);var t,r=e.length;for(t=0;t<r;t++)this._validateData(e[t])}}_validateData(e){let t=this;e.hits.hits.map(function(r){let s=r._source,n=t._getMeterPerMapUnit(t.geoFence.unit),i=t.geoFence.center[0]*n,o=t.geoFence.center[1]*n,a=s.x*n,l=s.y*n;return t._distance(a,l,i,o)>t.geoFence.radius&&(t.outOfGeoFence&&t.outOfGeoFence(e),t.events.triggerEvent("outOfGeoFence",{data:e})),r})}_distance(e,t,r,s){return Math.sqrt((e-r)*(e-r)+(t-s)*(t-s))}_getMeterPerMapUnit(e){let t;return"meter"===e?t=1:"degree"===e&&(t=2*Math.PI*6378137/360),t}}s.ElasticSearch=f;var y=r(5),g=r.n(y);
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
window.Promise=g.a;r(8);var E=r(2),v=r.n(E);
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
const S=window.fetch;s.setCORS=function(e){s.CORS=e};var T=s.isCORS=function(){return void 0!=s.CORS?s.CORS:window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest},C=(s.setRequestTimeout=function(e){return s.RequestTimeout=e},s.getRequestTimeout=function(){return s.RequestTimeout||45e3}),N=s.FetchRequest={commit:function(e,t,r,s){switch(e=e?e.toUpperCase():e){case"GET":return this.get(t,r,s);case"POST":return this.post(t,r,s);case"PUT":return this.put(t,r,s);case"DELETE":return this.delete(t,r,s);default:return this.get(t,r,s)}},supportDirectRequest:function(e,t){return h.isInTheSameDomain(e)||T()||t.proxy},get:function(e,t,r){r=r||{};if(e=this._processUrl(e,r),e=h.urlAppend(e,this._getParameterString(t||{})),!this.supportDirectRequest(e,r)){var n={url:e=e.replace(".json",".jsonp"),data:t};return s.Util.RequestJSONPPromise.GET(n)}return this.urlIsLong(e)?this._postSimulatie("GET",e.substring(0,e.indexOf("?")-1),t,r):this._fetch(e,t,r,"GET")},delete:function(e,t,r){r=r||{};if(e=this._processUrl(e,r),e=h.urlAppend(e,this._getParameterString(t||{})),!this.supportDirectRequest(e,r)){e=e.replace(".json",".jsonp");var n={url:e+="&_method=DELETE",data:t};return s.Util.RequestJSONPPromise.DELETE(n)}return this.urlIsLong(e)?this._postSimulatie("DELETE",e.substring(0,e.indexOf("?")-1),t,r):this._fetch(e,t,r,"DELETE")},post:function(e,t,r){if(r=r||{},!this.supportDirectRequest(e,r)){e=e.replace(".json",".jsonp");var n={url:e+="&_method=POST",data:t};return s.Util.RequestJSONPPromise.POST(n)}return this._fetch(this._processUrl(e,r),t,r,"POST")},put:function(e,t,r){if(r=r||{},e=this._processUrl(e,r),!this.supportDirectRequest(e,r)){e=e.replace(".json",".jsonp");var n={url:e+="&_method=PUT",data:t};return s.Util.RequestJSONPPromise.PUT(n)}return this._fetch(e,t,r,"PUT")},urlIsLong:function(e){for(var t=0,r=null,s=0,n=e.length;s<n;s++)(r=e.charCodeAt(s))<127?t++:128<=r&&r<=2047?t+=2:2048<=r&&r<=65535&&(t+=3);return!(t<2e3)},_postSimulatie:function(e,t,r,s){return t+=(t.indexOf("?")>-1?"&":"?")+"_method="+e,"string"!=typeof r&&(r=JSON.stringify(r)),this.post(t,r,s)},_processUrl:function(e,t){if(this._isMVTRequest(e))return e;if(-1===e.indexOf(".json")&&!t.withoutFormatSuffix)if(e.indexOf("?")<0)e+=".json";else{var r=e.split("?");2===r.length&&(e=r[0]+".json?"+r[1])}return t&&t.proxy&&("function"==typeof t.proxy?e=t.proxy(e):(e=decodeURIComponent(e),e=t.proxy+encodeURIComponent(e))),e},_fetch:function(e,t,r,s){return(r=r||{}).headers=r.headers||{},r.headers["Content-Type"]||(r.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8"),r.timeout?this._timeout(r.timeout,S(e,{method:s,headers:r.headers,body:"PUT"===s||"POST"===s?t:void 0,credentials:r.withCredentials?"include":"omit",mode:"cors",timeout:C()}).then(function(e){return e})):S(e,{method:s,body:"PUT"===s||"POST"===s?t:void 0,headers:r.headers,credentials:r.withCredentials?"include":"omit",mode:"cors",timeout:C()}).then(function(e){return e})},_fetchJsonp:function(e,t){return t=t||{},v()(e,{method:"GET",timeout:t.timeout}).then(function(e){return e})},_timeout:function(e,t){return new Promise(function(r,s){setTimeout(function(){s(new Error("timeout"))},e),t.then(r,s)})},_getParameterString:function(e){var t=[];for(var r in e){var s=e[r];if(null!=s&&"function"!=typeof s){var n;if("object"==typeof s&&s.constructor===Array){for(var i,o=[],a=0,l=s.length;a<l;a++)i=s[a],o.push(encodeURIComponent(null===i||void 0===i?"":i));n="["+o.join(",")+"]"}else n=encodeURIComponent(s);t.push(encodeURIComponent(r)+"="+n)}}return t.join("&")},_isMVTRequest:function(e){return e.indexOf(".mvt")>-1||e.indexOf(".pbf")>-1}};s.Util.RequestJSONPPromise={limitLength:1500,queryKeys:[],queryValues:[],supermap_callbacks:{},addQueryStrings:function(e){for(var t in e){this.queryKeys.push(t),"string"!=typeof e[t]&&(e[t]=s.Util.toJSON(e[t]));var r=encodeURIComponent(e[t]);this.queryValues.push(r)}},issue:function(e){for(var t=this,r=t.getUid(),s=e.url,n=[],i=new Promise(function(e){t.supermap_callbacks[r]=function(s){delete t.supermap_callbacks[r],e(s)}}),o=s,a=0,l=t.queryKeys?t.queryKeys.length:0,u=0;u<l;u++)if(o.length+t.queryKeys[u].length+2>=t.limitLength){if(0==a)return!1;n.push(o),o=s,a=0,u--}else if(o.length+t.queryKeys[u].length+2+t.queryValues[u].length>t.limitLength)for(var h=t.queryValues[u];h.length>0;){var c=t.limitLength-o.length-t.queryKeys[u].length-2;o.indexOf("?")>-1?o+="&":o+="?";var p=h.substring(0,c);"%"===p.substring(c-1,c)?(c-=1,p=h.substring(0,c)):"%"===p.substring(c-2,c-1)&&(c-=2,p=h.substring(0,c)),o+=t.queryKeys[u]+"="+p,h=h.substring(c),p.length>0&&(n.push(o),o=s,a=0)}else a++,o.indexOf("?")>-1?o+="&":o+="?",o+=t.queryKeys[u]+"="+t.queryValues[u];return n.push(o),t.send(n,"SuperMap.Util.RequestJSONPPromise.supermap_callbacks["+r+"]",e&&e.proxy),i},getUid:function(){return 1e3*(new Date).getTime()+Math.floor(1e17*Math.random())},send:function(e,t,r){var s=e.length;if(s>0)for(var n=(new Date).getTime(),i=0;i<s;i++){var o=e[i];o.indexOf("?")>-1?o+="&":o+="?",o+="sectionCount="+s,o+="&sectionIndex="+i,o+="&jsonpUserID="+n,r&&(o=decodeURIComponent(o),o=r+encodeURIComponent(o)),v()(o,{jsonpCallbackFunction:t,timeout:3e4})}},GET:function(e){return this.queryKeys.length=0,this.queryValues.length=0,this.addQueryStrings(e.params),this.issue(e)},POST:function(e){return this.queryKeys.length=0,this.queryValues.length=0,this.addQueryStrings({requestEntity:e.data}),this.issue(e)},PUT:function(e){return this.queryKeys.length=0,this.queryValues.length=0,this.addQueryStrings({requestEntity:e.data}),this.issue(e)},DELETE:function(e){return this.queryKeys.length=0,this.queryValues.length=0,this.addQueryStrings({requestEntity:e.data}),this.issue(e)}};
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class b{static generateToken(e,t){var r=this.servers[e];if(r)return N.post(r.tokenServiceUrl,JSON.stringify(t.toJSON())).then(function(e){return e.text()})}static registerServers(e){this.servers=this.servers||{},h.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var r=e[t];this.servers[r.server]=r}}static registerToken(e,t){if(this.tokens=this.tokens||{},e&&t){var r=this._getTokenStorageKey(e);this.tokens[r]=t}}static registerKey(e,t){if(this.keys=this.keys||{},e&&!(e.length<1)&&t){e=h.isArray(e)?e:[e];for(var r=0;r<e.length;r++){var s=this._getUrlRestString(e[0])||e[0];this.keys[s]=t}}}static getServerInfo(e){return this.servers=this.servers||{},this.servers[e]}static getToken(e){if(e){this.tokens=this.tokens||{};var t=this._getTokenStorageKey(e);return this.tokens[t]}}static getKey(e){this.keys=this.keys||{};var t=this._getUrlRestString(e)||e;return this.keys[t]}static loginiServer(e,t,r,s){e+="/"===e.substr(e.length-1,1)?"services/security/login.json":"/services/security/login.json";var n={username:t&&t.toString(),password:r&&r.toString(),rememberme:s};n=JSON.stringify(n);return N.post(e,n,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(e){return e.json()})}static logoutiServer(e){e+="/"===e.substr(e.length-1,1)?"services/security/logout":"/services/security/logout";return N.get(e,"",{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withoutFormatSuffix:!0}).then(function(){return!0}).catch(function(){return!1})}static loginOnline(e,t){var r=b.SSO+"/login?service="+e;this._open(r,t)}static loginiPortal(e,t,r){e+="/"===e.substr(e.length-1,1)?"web/login.json":"/web/login.json";var s={username:t&&t.toString(),password:r&&r.toString()};s=JSON.stringify(s);return N.post(e,s,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withCredentials:!0}).then(function(e){return e.json()})}static logoutiPortal(e){e+="/"===e.substr(e.length-1,1)?"services/security/logout":"/services/security/logout";return N.get(e,"",{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},withCredentials:!0,withoutFormatSuffix:!0}).then(function(){return!0}).catch(function(){return!1})}static loginManager(e,t,r){if(h.isInTheSameDomain(e)){var s="/"===e.substr(e.length-1,1)?e+"icloud/security/tokens.json":e+"/icloud/security/tokens.json",n=t||{},i={username:n.userName&&n.userName.toString(),password:n.password&&n.password.toString()};i=JSON.stringify(i);var o=this;return N.post(s,i,{headers:{Accept:"*/*","Content-Type":"application/json"}}).then(function(e){e.text().then(function(e){return o.imanagerToken=e,e})})}var a=!r||r.isNewTab;this._open(e,a)}static destroyAllCredentials(){this.keys=null,this.tokens=null,this.servers=null}static destroyToken(e){if(e){var t=this._getTokenStorageKey(e);this.tokens=this.tokens||{},this.tokens[t]&&delete this.tokens[t]}}static destroyKey(e){if(e){this.keys=this.keys||{};var t=this._getUrlRestString(e)||e;this.keys[t]&&delete this.keys[t]}}static _open(e,t){t=null==t||t;var r=window.screen.availWidth/2-this.INNER_WINDOW_WIDTH/2,s=window.screen.availHeight/2-this.INNER_WINDOW_HEIGHT/2,n="height="+this.INNER_WINDOW_HEIGHT+", width="+this.INNER_WINDOW_WIDTH+",top="+s+", left="+r+",toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no";t?window.open(e,"login"):window.open(e,"login",n)}static _getTokenStorageKey(e){var t=e.match(/(.*?):\/\/([^\/]+)/i);return t?t[0]:e}static _getUrlRestString(e){if(!e)return e;var t=e.match(/http:\/\/(.*\/rest)/i);return t?t[0]:e}}b.INNER_WINDOW_WIDTH=600,b.INNER_WINDOW_HEIGHT=600,b.SSO="https://sso.supermap.com",b.ONLINE="http://www.supermapol.com",s.SecurityManager=b;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
var _=s.DataFormat={GEOJSON:"GEOJSON",ISERVER:"ISERVER"},I=s.ServerType={ISERVER:"ISERVER",IPORTAL:"IPORTAL",ONLINE:"ONLINE"},w=s.GeometryType={LINE:"LINE",LINEM:"LINEM",POINT:"POINT",REGION:"REGION",POINTEPS:"POINTEPS",LINEEPS:"LINEEPS",REGIONEPS:"REGIONEPS",ELLIPSE:"ELLIPSE",CIRCLE:"CIRCLE",TEXT:"TEXT",RECTANGLE:"RECTANGLE",UNKNOWN:"UNKNOWN"},x=s.QueryOption={ATTRIBUTE:"ATTRIBUTE",ATTRIBUTEANDGEOMETRY:"ATTRIBUTEANDGEOMETRY",GEOMETRY:"GEOMETRY"},R=(s.JoinType={INNERJOIN:"INNERJOIN",LEFTJOIN:"LEFTJOIN"},s.SpatialQueryMode={CONTAIN:"CONTAIN",CROSS:"CROSS",DISJOINT:"DISJOINT",IDENTITY:"IDENTITY",INTERSECT:"INTERSECT",NONE:"NONE",OVERLAP:"OVERLAP",TOUCH:"TOUCH",WITHIN:"WITHIN"}),L=(s.SpatialRelationType={CONTAIN:"CONTAIN",INTERSECT:"INTERSECT",WITHIN:"WITHIN"},s.MeasureMode={DISTANCE:"DISTANCE",AREA:"AREA"},s.Unit={METER:"METER",KILOMETER:"KILOMETER",MILE:"MILE",YARD:"YARD",DEGREE:"DEGREE",MILLIMETER:"MILLIMETER",CENTIMETER:"CENTIMETER",INCH:"INCH",DECIMETER:"DECIMETER",FOOT:"FOOT",SECOND:"SECOND",MINUTE:"MINUTE",RADIAN:"RADIAN"},s.BufferRadiusUnit={CENTIMETER:"CENTIMETER",DECIMETER:"DECIMETER",FOOT:"FOOT",INCH:"INCH",KILOMETER:"KILOMETER",METER:"METER",MILE:"MILE",MILLIMETER:"MILLIMETER",YARD:"YARD"},s.EngineType={IMAGEPLUGINS:"IMAGEPLUGINS",OGC:"OGC",ORACLEPLUS:"ORACLEPLUS",SDBPLUS:"SDBPLUS",SQLPLUS:"SQLPLUS",UDB:"UDB"},s.ThemeGraphTextFormat={CAPTION:"CAPTION",CAPTION_PERCENT:"CAPTION_PERCENT",CAPTION_VALUE:"CAPTION_VALUE",PERCENT:"PERCENT",VALUE:"VALUE"},s.ThemeGraphType={AREA:"AREA",BAR:"BAR",BAR3D:"BAR3D",LINE:"LINE",PIE:"PIE",PIE3D:"PIE3D",POINT:"POINT",RING:"RING",ROSE:"ROSE",ROSE3D:"ROSE3D",STACK_BAR:"STACK_BAR",STACK_BAR3D:"STACK_BAR3D",STEP:"STEP"},s.GraphAxesTextDisplayMode={ALL:"ALL",NONE:"NONE",YAXES:"YAXES"},s.GraduatedMode={CONSTANT:"CONSTANT",LOGARITHM:"LOGARITHM",SQUAREROOT:"SQUAREROOT"},s.RangeMode={CUSTOMINTERVAL:"CUSTOMINTERVAL",EQUALINTERVAL:"EQUALINTERVAL",LOGARITHM:"LOGARITHM",QUANTILE:"QUANTILE",SQUAREROOT:"SQUAREROOT",STDDEVIATION:"STDDEVIATION"}),A=(s.ThemeType={DOTDENSITY:"DOTDENSITY",GRADUATEDSYMBOL:"GRADUATEDSYMBOL",GRAPH:"GRAPH",LABEL:"LABEL",RANGE:"RANGE",UNIQUE:"UNIQUE"},s.ColorGradientType={BLACK_WHITE:"BLACKWHITE",BLUE_BLACK:"BLUEBLACK",BLUE_RED:"BLUERED",BLUE_WHITE:"BLUEWHITE",CYAN_BLACK:"CYANBLACK",CYAN_BLUE:"CYANBLUE",CYAN_GREEN:"CYANGREEN",CYAN_WHITE:"CYANWHITE",GREEN_BLACK:"GREENBLACK",GREEN_BLUE:"GREENBLUE",GREEN_ORANGE_VIOLET:"GREENORANGEVIOLET",GREEN_RED:"GREENRED",GREEN_WHITE:"GREENWHITE",PINK_BLACK:"PINKBLACK",PINK_BLUE:"PINKBLUE",PINK_RED:"PINKRED",PINK_WHITE:"PINKWHITE",RAIN_BOW:"RAINBOW",RED_BLACK:"REDBLACK",RED_WHITE:"REDWHITE",SPECTRUM:"SPECTRUM",TERRAIN:"TERRAIN",YELLOW_BLACK:"YELLOWBLACK",YELLOW_BLUE:"YELLOWBLUE",YELLOW_GREEN:"YELLOWGREEN",YELLOW_RED:"YELLOWRED",YELLOW_WHITE:"YELLOWWHITE"}),P=(s.TextAlignment={TOPLEFT:"TOPLEFT",TOPCENTER:"TOPCENTER",TOPRIGHT:"TOPRIGHT",BASELINELEFT:"BASELINELEFT",BASELINECENTER:"BASELINECENTER",BASELINERIGHT:"BASELINERIGHT",BOTTOMLEFT:"BOTTOMLEFT",BOTTOMCENTER:"BOTTOMCENTER",BOTTOMRIGHT:"BOTTOMRIGHT",MIDDLELEFT:"MIDDLELEFT",MIDDLECENTER:"MIDDLECENTER",MIDDLERIGHT:"MIDDLERIGHT"},s.FillGradientMode={NONE:"NONE",LINEAR:"LINEAR",RADIAL:"RADIAL",CONICAL:"CONICAL",SQUARE:"SQUARE"},s.AlongLineDirection={NORMAL:"ALONG_LINE_NORMAL",LB_TO_RT:"LEFT_BOTTOM_TO_RIGHT_TOP",LT_TO_RB:"LEFT_TOP_TO_RIGHT_BOTTOM",RB_TO_LT:"RIGHT_BOTTOM_TO_LEFT_TOP",RT_TO_LB:"RIGHT_TOP_TO_LEFT_BOTTOM"},s.LabelBackShape={DIAMOND:"DIAMOND",ELLIPSE:"ELLIPSE",MARKER:"MARKER",NONE:"NONE",RECT:"RECT",ROUNDRECT:"ROUNDRECT",TRIANGLE:"TRIANGLE"},s.LabelOverLengthMode={NEWLINE:"NEWLINE",NONE:"NONE",OMIT:"OMIT"},s.DirectionType={EAST:"EAST",NONE:"NONE",NORTH:"NORTH",SOURTH:"SOURTH",WEST:"WEST"},s.SideType={LEFT:"LEFT",MIDDLE:"MIDDLE",NONE:"NONE",RIGHT:"RIGHT"},s.SupplyCenterType={FIXEDCENTER:"FIXEDCENTER",NULL:"NULL",OPTIONALCENTER:"OPTIONALCENTER"},s.TurnType={AHEAD:"AHEAD",BACK:"BACK",END:"END",LEFT:"LEFT",NONE:"NONE",RIGHT:"RIGHT"},s.BufferEndType={FLAT:"FLAT",ROUND:"ROUND"},s.OverlayOperationType={CLIP:"CLIP",ERASE:"ERASE",IDENTITY:"IDENTITY",INTERSECT:"INTERSECT",UNION:"UNION",UPDATE:"UPDATE",XOR:"XOR"},s.OutputType={INDEXEDHDFS:"INDEXEDHDFS",UDB:"UDB",MONGODB:"MONGODB",PG:"PG"}),O=(s.SmoothMethod={BSPLINE:"BSPLINE",POLISH:"POLISH"},s.SurfaceAnalystMethod={ISOLINE:"ISOLINE",ISOREGION:"ISOREGION"},s.DataReturnMode={DATASET_AND_RECORDSET:"DATASET_AND_RECORDSET",DATASET_ONLY:"DATASET_ONLY",RECORDSET_ONLY:"RECORDSET_ONLY"},s.EditType={ADD:"add",UPDATE:"update",DELETE:"delete"},s.TransferTactic={LESS_TIME:"LESS_TIME",LESS_TRANSFER:"LESS_TRANSFER",LESS_WALK:"LESS_WALK",MIN_DISTANCE:"MIN_DISTANCE"},s.TransferPreference={BUS:"BUS",SUBWAY:"SUBWAY",NO_SUBWAY:"NO_SUBWAY",NONE:"NONE"},s.GridType={CROSS:"CROSS",GRID:"GRID",POINT:"POINT"},s.ColorSpaceType={CMYK:"CMYK",RGB:"RGB"},s.LayerType={UGC:"UGC",WMS:"WMS",WFS:"WFS",CUSTOM:"CUSTOM"},s.UGCLayerType={THEME:"THEME",VECTOR:"VECTOR",GRID:"GRID",IMAGE:"IMAGE"},s.StatisticMode={AVERAGE:"AVERAGE",MAX:"MAX",MIN:"MIN",STDDEVIATION:"STDDEVIATION",SUM:"SUM",VARIANCE:"VARIANCE"},s.PixelFormat={BIT16:"BIT16",BIT32:"BIT32",BIT64:"BIT64",SINGLE:"SINGLE",DOUBLE:"DOUBLE",UBIT1:"UBIT1",UBIT4:"UBIT4",UBIT8:"UBIT8",UBIT24:"UBIT24",UBIT32:"UBIT32"},s.SearchMode={KDTREE_FIXED_COUNT:"KDTREE_FIXED_COUNT",KDTREE_FIXED_RADIUS:"KDTREE_FIXED_RADIUS",NONE:"NONE",QUADTREE:"QUADTREE"},s.InterpolationAlgorithmType={KRIGING:"KRIGING",SimpleKriging:"SimpleKriging",UniversalKriging:"UniversalKriging"},s.VariogramMode={EXPONENTIAL:"EXPONENTIAL",GAUSSIAN:"GAUSSIAN",SPHERICAL:"SPHERICAL"},s.Exponent={EXP1:"EXP1",EXP2:"EXP2"},s.ClientType={IP:"IP",REFERER:"Referer",REQUESTIP:"RequestIP",NONE:"NONE",SERVER:"SERVER",WEB:"WEB"},s.ChartType={BAR:"Bar",BAR3D:"Bar3D",CIRCLE:"Circle",PIE:"Pie",POINT:"Point",LINE:"Line",RING:"Ring"},s.ClipAnalystMode={CLIP:"clip",INTERSECT:"intersect"}),M=s.AnalystAreaUnit={SQUAREMETER:"SquareMeter",SQUAREKILOMETER:"SquareKiloMeter",HECTARE:"Hectare",ARE:"Are",ACRE:"Acre",SQUAREFOOT:"SquareFoot",SQUAREYARD:"SquareYard",SQUAREMILE:"SquareMile"},D=s.AnalystSizeUnit={METER:"Meter",KILOMETER:"Kilometer",YARD:"Yard",FOOT:"Foot",MILE:"Mile"},F=s.StatisticAnalystMode={MAX:"max",MIN:"min",AVERAGE:"average",SUM:"sum",VARIANCE:"variance",STDDEVIATION:"stdDeviation"},U=s.SummaryType={SUMMARYMESH:"SUMMARYMESH",SUMMARYREGION:"SUMMARYREGION"},G=s.TopologyValidatorRule={REGIONNOOVERLAP:"REGIONNOOVERLAP",REGIONNOOVERLAPWITH:"REGIONNOOVERLAPWITH",REGIONCONTAINEDBYREGION:"REGIONCONTAINEDBYREGION",REGIONCOVEREDBYREGION:"REGIONCOVEREDBYREGION",LINENOOVERLAP:"LINENOOVERLAP",LINENOOVERLAPWITH:"LINENOOVERLAPWITH",POINTNOIDENTICAL:"POINTNOIDENTICAL"};s.AggregationType={GEOHASH_GRID:"geohash_grid",FILTER:"filter"},s.AggregationQueryBuilderType={GEO_BOUNDING_BOX:"geo_bounding_box"},s.GetFeatureMode={BOUNDS:"BOUNDS",BUFFER:"BUFFER",ID:"ID",SPATIAL:"SPATIAL",SQL:"SQL"};
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class B{constructor(e){this.alias=null,this.connect=null,this.dataBase=null,this.driver=null,this.engineType=null,this.exclusive=null,this.OpenLinkTable=null,this.password=null,this.readOnly=null,this.server=null,this.user=null,e&&h.extend(this,e),this.CLASS_NAME="SuperMap.DatasourceConnectionInfo"}destroy(){var e=this;e.alias=null,e.connect=null,e.dataBase=null,e.driver=null,e.engineType=null,e.exclusive=null,e.OpenLinkTable=null,e.password=null,e.readOnly=null,e.server=null,e.user=null}}s.DatasourceConnectionInfo=B;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class J{constructor(e){this.type=P.UDB,this.datasetName="analystResult",this.datasourceInfo=null,this.outputPath="",h.extend(this,e),this.CLASS_NAME="SuperMap.OutputSetting"}destroy(){var e=this;e.type=null,e.datasetName=null,e.outputPath=null,e.datasourceInfo instanceof B&&(e.datasourceInfo.destroy(),e.datasourceInfo=null)}}s.OutputSetting=J;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class k{constructor(e){this.items=null,this.numericPrecision=1,this.rangeMode=L.EQUALINTERVAL,this.rangeCount="",this.colorGradientType=A.YELLOW_RED,h.extend(this,e),this.CLASS_NAME="SuperMap.MappingParameters"}destroy(){var e=this;if(e.items){if(e.items.length>0)for(var t in e.items)e.items[t].destroy(),e.items[t]=null;e.items=null}e.numericPrecision=null,e.rangeMode=null,e.rangeCount=null,e.colorGradientType=null}}s.MappingParameters=k;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class H{constructor(e){e&&(this.datasetName="",this.query="",this.resolution=80,this.method=0,this.meshType=0,this.fields="",this.radius=300,this.meshSizeUnit=D.METER,this.radiusUnit=D.METER,this.areaUnit=M.SQUAREMILE,this.output=null,this.mappingParameters=null,h.extend(this,e),this.CLASS_NAME="SuperMap.KernelDensityJobParameter")}destroy(){this.datasetName=null,this.query=null,this.resolution=null,this.method=null,this.radius=null,this.meshType=null,this.fields=null,this.meshSizeUnit=null,this.radiusUnit=null,this.areaUnit=null,this.output instanceof J&&(this.output.destroy(),this.output=null),this.mappingParameters instanceof k&&(this.mappingParameters.destroy(),this.mappingParameters=null)}static toObject(e,t){for(var r in e)"datasetName"!==r?"output"!==r?(t.analyst=t.analyst||{},"query"===r&&e[r]?t.analyst[r]=e[r].toBBOX():t.analyst[r]=e[r],"mappingParameters"===r&&(t.analyst[r]=t.analyst[r]||{},t.analyst.mappingParameters=e[r])):(t.output=t.output||{},t.output=e[r]):(t.input=t.input||{},t.input[r]=e[r])}}s.KernelDensityJobParameter=H;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class V{constructor(e){e&&(this.datasetName="",this.datasetQuery="",this.geometryQuery="",this.mode=R.CONTAIN,this.output=null,this.mappingParameters=null,h.extend(this,e),this.CLASS_NAME="SuperMap.SingleObjectQueryJobsParameter")}destroy(){this.datasetName=null,this.datasetQuery=null,this.geometryQuery=null,this.mode=null,this.output instanceof J&&(this.output.destroy(),this.output=null),this.mappingParameters instanceof k&&(this.mappingParameters.destroy(),this.mappingParameters=null)}static toObject(e,t){for(var r in e)"datasetName"!==r?"output"!==r?(t.analyst=t.analyst||{},t.analyst[r]=e[r],"mappingParameters"===r&&(t.analyst[r]=t.analyst[r]||{},t.analyst.mappingParameters=e[r])):(t.output=t.output||{},t.output=e[r]):(t.input=t.input||{},t.input[r]=e[r])}}s.SingleObjectQueryJobsParameter=V;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class j{constructor(e){e&&(this.datasetName="",this.groupField="",this.attributeField="",this.statisticModes="",this.output=null,this.mappingParameters=null,h.extend(this,e),this.CLASS_NAME="SuperMap.SummaryAttributesJobsParameter")}destroy(){this.datasetName=null,this.groupField=null,this.attributeField=null,this.statisticModes=null,this.output instanceof J&&(this.output.destroy(),this.output=null),this.mappingParameters instanceof k&&(this.mappingParameters.destroy(),this.mappingParameters=null)}static toObject(e,t){for(var r in e)"datasetName"!==r?"output"!==r?(t.analyst=t.analyst||{},t.analyst[r]=e[r],"mappingParameters"===r&&(t.analyst[r]=t.analyst[r]||{},t.analyst.mappingParameters=e[r])):(t.output=t.output||{},t.output=e[r]):(t.input=t.input||{},t.input[r]=e[r])}}s.SummaryAttributesJobsParameter=j;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class q{constructor(e){e&&(this.datasetName="",this.regionDataset="",this.query="",this.resolution=100,this.meshType=0,this.statisticModes=F.AVERAGE,this.fields="",this.type=U.SUMMARYMESH,this.output=null,this.mappingParameters=null,h.extend(this,e),this.CLASS_NAME="SuperMap.SummaryMeshJobParameter")}destroy(){this.datasetName=null,this.query=null,this.resolution=null,this.statisticModes=null,this.meshType=null,this.fields=null,this.regionDataset=null,this.type=null,this.output instanceof J&&(this.output.destroy(),this.output=null),this.mappingParameters instanceof k&&(this.mappingParameters.destroy(),this.mappingParameters=null)}static toObject(e,t){for(var r in e)"datasetName"!==r?"type"!==r?"output"!==r?("SUMMARYMESH"===e.type&&"regionDataset"!==r||"SUMMARYREGION"===e.type&&!s(["meshType","resolution","query"],r))&&(t.analyst=t.analyst||{},"query"===r&&e[r]?t.analyst[r]=e[r].toBBOX():t.analyst[r]=e[r],"mappingParameters"===r&&(t.analyst[r]=t.analyst[r]||{},t.analyst.mappingParameters=e[r])):(t.output=t.output||{},t.output=e[r]):t.type=e[r]:(t.input=t.input||{},t.input[r]=e[r]);function s(e,t){for(var r=e.length;r--;)if(e[r]===t)return!0;return!1}}}s.SummaryMeshJobParameter=q;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class W{constructor(e){e&&(this.datasetName="",this.regionDataset="",this.sumShape=!0,this.query="",this.standardSummaryFields=!1,this.standardFields="",this.standardStatisticModes="",this.weightedSummaryFields=!1,this.weightedFields="",this.weightedStatisticModes="",this.meshType=0,this.resolution=100,this.meshSizeUnit=D.METER,this.type=U.SUMMARYMESH,this.output=null,this.mappingParameters=null,h.extend(this,e),this.CLASS_NAME="SuperMap.SummaryRegionJobParameter")}destroy(){this.datasetName=null,this.sumShape=null,this.regionDataset=null,this.query=null,this.standardSummaryFields=null,this.standardFields=null,this.standardStatisticModes=null,this.weightedSummaryFields=null,this.weightedFields=null,this.weightedStatisticModes=null,this.meshType=null,this.resolution=null,this.meshSizeUnit=null,this.type=null,this.output instanceof J&&(this.output.destroy(),this.output=null),this.mappingParameters instanceof k&&(this.mappingParameters.destroy(),this.mappingParameters=null)}static toObject(e,t){for(var r in e)"datasetName"!==r?"type"!==r&&"type"!==r?"output"!==r?("SUMMARYREGION"===e.type||"SUMMARYMESH"===e.type&&"regionDataset"!==r)&&(t.analyst=t.analyst||{},"query"===r&&e[r]?t.analyst[r]=e[r].toBBOX():t.analyst[r]=e[r],"mappingParameters"===r&&(t.analyst[r]=t.analyst[r]||{},t.analyst.mappingParameters=e[r])):(t.output=t.output||{},t.output=e[r]):t.type=e[r]:(t.input=t.input||{},t.input[r]=e[r])}}s.SummaryRegionJobParameter=W;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class K{constructor(e){e&&(this.datasetName="",this.datasetOverlay="",this.mode="",this.srcFields="",this.overlayFields="",this.output=null,this.mappingParameters=null,h.extend(this,e),this.CLASS_NAME="SuperMap.OverlayGeoJobParameter")}destroy(){this.datasetName=null,this.datasetOverlay=null,this.mode=null,this.srcFields=null,this.overlayFields=null,this.output instanceof J&&(this.output.destroy(),this.output=null),this.mappingParameters instanceof k&&(this.mappingParameters.destroy(),this.mappingParameters=null)}static toObject(e,t){for(var r in e)"datasetName"!=r?"output"!==r?(t.analyst=t.analyst||{},t.analyst[r]=e[r],"mappingParameters"===r&&(t.analyst[r]=t.analyst[r]||{},t.analyst.mappingParameters=e[r])):(t.output=t.output||{},t.output=e[r]):(t.input=t.input||{},t.input[r]=e[r])}}s.OverlayGeoJobParameter=K;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Y{constructor(e){if(this.datasetName="",this.bounds="",this.distance="",this.distanceField="",this.distanceUnit=D.METER,this.dissolveField="",this.output=null,this.mappingParameters=null,!e)return this;h.extend(this,e),this.CLASS_NAME="SuperMap.BuffersAnalystJobsParameter"}destroy(){this.datasetName=null,this.bounds=null,this.distance=null,this.distanceField=null,this.distanceUnit=null,this.dissolveField=null,this.output instanceof J&&(this.output.destroy(),this.output=null),this.mappingParameters instanceof k&&(this.mappingParameters.destroy(),this.mappingParameters=null)}static toObject(e,t){for(var r in e)"datasetName"!==r?"output"!==r?(t.analyst=t.analyst||{},t.analyst[r]="bounds"===r?e[r].toBBOX():e[r],"mappingParameters"===r&&(t.analyst[r]=t.analyst[r]||{},t.analyst.mappingParameters=e[r])):(t.output=t.output||{},t.output=e[r]):(t.input=t.input||{},t.input[r]=e[r])}}s.BuffersAnalystJobsParameter=Y;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Q{constructor(e){e&&(this.datasetName="",this.datasetTopology="",this.tolerance="",this.rule=G.REGIONNOOVERLAP,this.output=null,this.mappingParameters=null,h.extend(this,e),this.CLASS_NAME="SuperMap.TopologyValidatorJobsParameter")}destroy(){this.datasetName=null,this.datasetTopology=null,this.tolerance=null,this.rule=null,this.output instanceof J&&(this.output.destroy(),this.output=null),this.mappingParameters instanceof k&&(this.mappingParameters.destroy(),this.mappingParameters=null)}static toObject(e,t){for(var r in e)"datasetName"!==r?"output"!==r?(t.analyst=t.analyst||{},t.analyst[r]=e[r],"mappingParameters"===r&&(t.analyst[r]=t.analyst[r]||{},t.analyst.mappingParameters=e[r])):(t.output=t.output||{},t.output=e[r]):(t.input=t.input||{},t.input[r]=e[r])}}s.TopologyValidatorJobsParameter=Q;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class X{constructor(e){if(e.filters){let t=[];e.filters.split(",").map(function(e){return t.push('"'+e+'"'),e}),e.filters=t}this.address=null,this.fromIndex=null,this.toIndex=null,this.filters=null,this.prjCoordSys=null,this.maxReturn=null,h.extend(this,e)}destroy(){this.address=null,this.fromIndex=null,this.toIndex=null,this.filters=null,this.prjCoordSys=null,this.maxReturn=null}}s.GeoCodingParameter=X;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class z{constructor(e){if(e.filters){let t=[];e.filters.split(",").map(function(e){return t.push('"'+e+'"'),e}),e.filters=t}this.x=null,this.y=null,this.fromIndex=null,this.toIndex=null,this.filters=null,this.prjCoordSys=null,this.maxReturn=null,this.geoDecodingRadius=null,h.extend(this,e)}destroy(){this.x=null,this.y=null,this.fromIndex=null,this.toIndex=null,this.filters=null,this.prjCoordSys=null,this.maxReturn=null,this.geoDecodingRadius=null}}s.GeoDecodingParameter=z;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
const $={EXCEL:"EXCEL",CSV:"CSV",ISERVER:"ISERVER",GEOJSON:"GEOJSON",JSON:"JSON"},Z={fileMaxSize:10485760};
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ee{constructor(e){this.FileTypes=$,this.FileConfig=Z,this.loadFileObject=e&&e.loadFileObject?e.loadFileObject:[]}set(e,t){this[e]=t}get(e){return this[e]}}
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/class te{constructor(){this._initView()}_initView(){const e=document.createElement("div");e.hidden=!0,e.setAttribute("class","widget-messageboxcontainer widget-border-bottom-orange");const t=document.createElement("div");t.setAttribute("class","icon"),this.icon=document.createElement("span"),this.icon.setAttribute("class","supermapol-icons-message-warning"),t.appendChild(this.icon),e.appendChild(t);const r=document.createElement("div");r.setAttribute("class","widget-messagebox"),r.innerHTML="",e.appendChild(r),this.messageBox=r;const s=document.createElement("div");s.setAttribute("class","widget-messagebox__cancelbtncontainer");const n=document.createElement("button");n.setAttribute("class","widget-messagebox__cancelBtn"),n.innerHTML="x",n.onclick=this.closeView.bind(this),s.appendChild(n),e.appendChild(s),this.messageBoxContainer=e,document.body.appendChild(this.messageBoxContainer)}closeView(){this.messageBoxContainer.hidden=!0}showView(e,t="warring"){"success"===t?(this.icon.setAttribute("class","supermapol-icons-message-success"),this.messageBoxContainer.setAttribute("class","widget-messageboxcontainer widget-border-bottom-green")):"failure"===t?(this.icon.setAttribute("class","supermapol-icons-message-failure"),this.messageBoxContainer.setAttribute("class","widget-messageboxcontainer widget-border-bottom-red")):"warring"===t&&(this.icon.setAttribute("class","supermapol-icons-message-warning"),this.messageBoxContainer.setAttribute("class","widget-messageboxcontainer widget-border-bottom-orange")),this.messageBox.innerHTML=e,this.messageBoxContainer.hidden=!1}}s.Widgets.MessageBox=te;var re=r(4),se=r.n(re);
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ne{constructor(e){this.datasetNames=null,this.returnContent=!0,this.fromIndex=0,this.toIndex=19,this.returnCountOnly=!1,this.maxFeatures=null,this.aggregations=null,h.extend(this,e),this.CLASS_NAME="SuperMap.GetFeaturesParametersBase"}destroy(){var e=this;e.datasetNames=null,e.returnContent=null,e.fromIndex=null,e.toIndex=null,e.maxFeatures=null,e.aggregation&&(e.aggregation=null)}}s.GetFeaturesParametersBase=ne;s.JoinItem=
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class{constructor(e){this.foreignTableName=null,this.joinFilter=null,this.joinType=null,e&&h.extend(this,e),this.CLASS_NAME="SuperMap.JoinItem"}destroy(){this.foreignTableName=null,this.joinFilter=null,this.joinType=null}toServerJSONObject(){var e={};return e=h.copyAttributes(e,this)}};s.LinkItem=
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class{constructor(e){this.datasourceConnectionInfo=null,this.foreignKeys=null,this.foreignTable=null,this.linkFields=null,this.linkFilter=null,this.name=null,this.primaryKeys=null,e&&h.extend(this,e),this.CLASS_NAME="SuperMap.LinkItem"}destroy(){var e=this;e.datasourceConnectionInfo instanceof B&&(e.datasourceConnectionInfo.destroy(),e.datasourceConnectionInfo=null),e.foreignKeys=null,e.foreignTable=null,e.linkFields=null,e.linkFilter=null,e.name=null,e.primaryKeys=null}};
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ie{constructor(e){this.attributeFilter=null,this.name=null,this.joinItems=null,this.linkItems=null,this.ids=null,this.orderBy=null,this.groupBy=null,this.fields=null,e&&h.extend(this,e),this.CLASS_NAME="SuperMap.FilterParameter"}destroy(){var e=this;if(e.attributeFilter=null,e.name=null,e.joinItems){for(let t=0,r=e.joinItems,s=r.length;t<s;t++)r[t].destroy();e.joinItems=null}if(e.linkItems){for(let t=0,r=e.linkItems,s=r.length;t<s;t++)r[t].destroy();e.linkItems=null}e.ids=null,e.orderBy=null,e.groupBy=null,e.fields=null}}s.FilterParameter=ie;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class oe extends ne{constructor(e){super(e),this.getFeatureMode="SQL",this.queryParameter=null,h.extend(this,e),this.CLASS_NAME="SuperMap.GetFeaturesBySQLParameters"}destroy(){super.destroy();this.getFeatureMode=null,this.queryParameter&&(this.queryParameter.destroy(),this.queryParameter=null)}static toJsonParameters(e){var t={datasetNames:e.datasetNames,getFeatureMode:"SQL",queryParameter:e.queryParameter};return e.maxFeatures&&!isNaN(e.maxFeatures)&&(t.maxFeatures=e.maxFeatures),e.aggregations&&(t.aggregations=e.aggregations),h.toJSON(t)}}s.GetFeaturesBySQLParameters=oe;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ae{constructor(e,t){this.value=e||"",this.name=t||"token",this.CLASS_NAME="SuperMap.Credential"}getUrlParameters(){return this.name+"="+this.value}getValue(){return this.value}destroy(){this.value=null,this.name=null}}ae.CREDENTIAL=null,s.Credential=ae;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class le{constructor(e){this.data=null,this.keepData=!1,h.extend(this,e),this.options=e,this.CLASS_NAME="SuperMap.Format"}destroy(){}read(e){}write(e){}}s.Format=le;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ue extends le{constructor(e){super(e),this.indent="    ",this.space=" ",this.newline="\n",this.level=0,this.pretty=!1,this.nativeJSON=!(!window.JSON||"function"!=typeof JSON.parse||"function"!=typeof JSON.stringify),this.CLASS_NAME="SuperMap.Format.JSON",this.serialize={object:function(e){if(null==e)return"null";if(e.constructor===Date)return this.serialize.date.apply(this,[e]);if(e.constructor===Array)return this.serialize.array.apply(this,[e]);var t,r,s,n=["{"];this.level+=1;var i=!1;for(t in e)e.hasOwnProperty(t)&&(r=this.write.apply(this,[t,this.pretty]),s=this.write.apply(this,[e[t],this.pretty]),null!=r&&null!=s&&(i&&n.push(","),n.push(this.writeNewline(),this.writeIndent(),r,":",this.writeSpace(),s),i=!0));return this.level-=1,n.push(this.writeNewline(),this.writeIndent(),"}"),n.join("")},array:function(e){var t,r=["["];this.level+=1;for(var s=0,n=e.length;s<n;++s)null!=(t=this.write.apply(this,[e[s],this.pretty]))&&(s>0&&r.push(","),r.push(this.writeNewline(),this.writeIndent(),t));return this.level-=1,r.push(this.writeNewline(),this.writeIndent(),"]"),r.join("")},string:function(e){var t={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(e)?'"'+e.replace(/([\x00-\x1f\\"])/g,function(e,r){var s=t[r];return s||(s=r.charCodeAt(),"\\u00"+Math.floor(s/16).toString(16)+(s%16).toString(16))})+'"':'"'+e+'"'},number:function(e){return isFinite(e)?String(e):"null"},boolean:function(e){return String(e)},date:function(e){function t(e){return e<10?"0"+e:e}return'"'+e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+"T"+t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds())+'"'}}}read(e,t){var r;if(this.nativeJSON)try{r=JSON.parse(e,t)}catch(e){}return this.keepData&&(this.data=r),r}write(e,t){this.pretty=!!t;var r=null,s=typeof e;if(this.serialize[s])try{r=!this.pretty&&this.nativeJSON?JSON.stringify(e):this.serialize[s].apply(this,[e])}catch(e){}return r}writeIndent(){var e=[];if(this.pretty)for(var t=0;t<this.level;++t)e.push(this.indent);return e.join("")}writeNewline(){return this.pretty?this.newline:""}writeSpace(){return this.pretty?this.space:""}}s.Format.JSON=ue;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class he{constructor(e,t){let r=this;this.EVENT_TYPES=["processCompleted","processFailed"],this.events=null,this.eventListeners=null,this.url=null,this.urls=null,this.proxy=null,this.serverType=null,this.index=null,this.length=null,this.options=null,this.totalTimes=null,this.POLLING_TIMES=3,this._processSuccess=null,this._processFailed=null,this.isInTheSameDomain=null,this.withCredentials=!1,h.isArray(e)?(r.urls=e,r.length=e.length,r.totalTimes=r.length,1===r.length?r.url=e[0]:(r.index=parseInt(Math.random()*r.length),r.url=e[r.index])):(r.totalTimes=1,r.url=e),h.isArray(e)&&!r.isServiceSupportPolling()&&(r.url=e[0],r.totalTimes=1),r.serverType=r.serverType||I.ISERVER,t=t||{},h.extend(this,t),r.isInTheSameDomain=h.isInTheSameDomain(r.url),r.events=new p(r,null,r.EVENT_TYPES,!0),r.eventListeners instanceof Object&&r.events.on(r.eventListeners),this.CLASS_NAME="SuperMap.CommonServiceBase"}destroy(){let e=this;h.isArray(e.urls)&&(e.urls=null,e.index=null,e.length=null,e.totalTimes=null),e.url=null,e.options=null,e._processSuccess=null,e._processFailed=null,e.isInTheSameDomain=null,e.EVENT_TYPES=null,e.events&&(e.events.destroy(),e.events=null),e.eventListeners&&(e.eventListeners=null)}request(e){let t=this;e.url=e.url||t.url,e.proxy=e.proxy||t.proxy,e.withCredentials=void 0!=e.withCredentials?e.withCredentials:t.withCredentials,e.isInTheSameDomain=t.isInTheSameDomain;let r=this.getCredential(e.url);if(r){let t=e.url.substring(e.url.length-1,e.url.length);e.url.indexOf("?")>-1&&"?"===t?e.url+=r.getUrlParameters():e.url.indexOf("?")>-1&&"?"!==t?e.url+="&"+r.getUrlParameters():e.url+="?"+r.getUrlParameters()}t.calculatePollingTimes(),t._processSuccess=e.success,t._processFailed=e.failure,e.scope=t,e.success=t.getUrlCompleted,e.failure=t.getUrlFailed,t.options=e,t._commit(t.options)}getCredential(e){let t,r,s=e;switch(this.serverType){case I.IPORTAL:(t=(r=b.getToken(s))?new ae(r,"token"):null)||(t=(r=b.getKey(s))?new ae(r,"key"):null);break;case I.ONLINE:t=(r=b.getKey(s))?new ae(r,"key"):null;break;default:t=(r=b.getToken(s))?new ae(r,"token"):null}return t}getUrlCompleted(e){this._processSuccess(e)}getUrlFailed(e){let t=this;t.totalTimes>0?(t.totalTimes--,t.ajaxPolling()):t._processFailed(e)}ajaxPolling(){let e=this,t=e.options.url,r=/^http:\/\/([a-z]{9}|(\d+\.){3}\d+):\d{0,4}/;e.index=parseInt(Math.random()*e.length),e.url=e.urls[e.index],t=t.replace(r,r.exec(e.url)[0]),e.options.url=t,e.options.isInTheSameDomain=h.isInTheSameDomain(t),e._commit(e.options)}calculatePollingTimes(){let e=this;e.times?e.totalTimes>e.POLLING_TIMES?e.times>e.POLLING_TIMES?e.totalTimes=e.POLLING_TIMES:e.totalTimes=e.times:e.times<e.totalTimes&&(e.totalTimes=e.times):e.totalTimes>e.POLLING_TIMES&&(e.totalTimes=e.POLLING_TIMES),e.totalTimes--}isServiceSupportPolling(){return!("SuperMap.REST.ThemeService"===this.CLASS_NAME||"SuperMap.REST.EditFeaturesService"===this.CLASS_NAME)}serviceProcessCompleted(e){e=h.transformResult(e),this.events.triggerEvent("processCompleted",{result:e})}serviceProcessFailed(e){let t=(e=h.transformResult(e)).error||e;this.events.triggerEvent("processFailed",{error:t})}_commit(e){"POST"!==e.method&&"PUT"!==e.method||(e.params&&(e.url=h.urlAppend(e.url,h.getParameterString(e.params||{}))),e.params=e.data),N.commit(e.method,e.url,e.params,{headers:e.headers,withCredentials:e.withCredentials,timeout:e.async?0:null,proxy:e.proxy}).then(function(e){return e.text?e.text():e.json?e.json():e}).then(function(t){var r=t;("string"==typeof t&&(r=(new ue).read(t)),(!r||r.error||r.code>=300&&304!==r.code)&&(r=r&&r.error?{error:r.error}:{error:r}),r.error)?(e.scope?u.bind(e.failure,e.scope):e.failure)(r):(r.succeed=void 0==r.succeed||r.succeed,(e.scope?u.bind(e.success,e.scope):e.success)(r))}).catch(function(t){(e.scope?u.bind(e.failure,e.scope):e.failure)(t)})}}s.CommonServiceBase=he;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ce{constructor(e,t,r){this.CLASS_NAME="SuperMap.Feature",this.layer=e,this.id=h.createUniqueID(this.CLASS_NAME+"_"),this.lonlat=t,this.data=null!=r?r:{}}destroy(){this.id=null,this.lonlat=null,this.data=null}}s.Feature=ce;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class pe extends ce{constructor(e,t,r){super(null,null,t),this.fid=null,this.geometry=e||null,this.attributes={},t&&(this.attributes=h.extend(this.attributes,t)),this.bounds=null,this.state=null,this.style=r||null,this.url=null,this.lonlat=null,this.CLASS_NAME="SuperMap.Feature.Vector",s.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"},pe.style={default:{fillColor:"#ee9900",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:.2,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"default",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},delete:{display:"none"}}}destroy(){this.layer&&(this.layer.removeFeatures(this),this.layer=null),this.geometry=null,super.destroy()}clone(){return new pe(this.geometry?this.geometry.clone():null,this.attributes,this.style)}toState(e){if(e===s.State.UPDATE)switch(this.state){case s.State.UNKNOWN:case s.State.DELETE:this.state=e;break;case s.State.UPDATE:case s.State.INSERT:}else if(e===s.State.INSERT)switch(this.state){case s.State.UNKNOWN:break;default:this.state=e}else if(e===s.State.DELETE)switch(this.state){case s.State.INSERT:case s.State.DELETE:break;case s.State.UNKNOWN:case s.State.UPDATE:this.state=e}else e===s.State.UNKNOWN&&(this.state=e)}}s.Feature.Vector=pe;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class de{constructor(e,t){this.w=e?parseFloat(e):0,this.h=e?parseFloat(t):0,this.CLASS_NAME="SuperMap.Size"}toString(){return"w="+this.w+",h="+this.h}clone(){return new de(this.w,this.h)}equals(e){var t=!1;return null!=e&&(t=this.w===e.w&&this.h===e.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(e.w)&&isNaN(e.h)),t}destroy(){this.w=null,this.h=null}}s.Size=de;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class me{constructor(e,t){h.isArray(e)&&(t=e[1],e=e[0]),this.lon=e?h.toFloat(e):0,this.lat=t?h.toFloat(t):0,this.CLASS_NAME="SuperMap.LonLat"}toString(){return"lon="+this.lon+",lat="+this.lat}toShortString(){return this.lon+","+this.lat}clone(){return new me(this.lon,this.lat)}add(e,t){if(null==e||null==t)throw new TypeError("LonLat.add cannot receive null values");return new me(this.lon+h.toFloat(e),this.lat+h.toFloat(t))}equals(e){var t=!1;return null!=e&&(t=this.lon===e.lon&&this.lat===e.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(e.lon)&&isNaN(e.lat)),t}wrapDateLine(e){var t=this.clone();if(e){for(;t.lon<e.left;)t.lon+=e.getWidth();for(;t.lon>e.right;)t.lon-=e.getWidth()}return t}destroy(){this.lon=null,this.lat=null}static fromString(e){var t=e.split(",");return new me(t[0],t[1])}static fromArray(e){var t=h.isArray(e),r=t&&e[0],s=t&&e[1];return new me(r,s)}}
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/class fe{constructor(e,t,r,s){h.isArray(e)&&(s=e[3],r=e[2],t=e[1],e=e[0]),this.left=null!=e?h.toFloat(e):this.left,this.bottom=null!=t?h.toFloat(t):this.bottom,this.right=null!=r?h.toFloat(r):this.right,this.top=null!=s?h.toFloat(s):this.top,this.centerLonLat=null,this.CLASS_NAME="SuperMap.Bounds"}clone(){return new fe(this.left,this.bottom,this.right,this.top)}equals(e){var t=!1;return null!=e&&(t=this.left===e.left&&this.right===e.right&&this.top===e.top&&this.bottom===e.bottom),t}toString(){return[this.left,this.bottom,this.right,this.top].join(",")}toArray(e){return!0===e?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]}toBBOX(e,t){null==e&&(e=6);var r=Math.pow(10,e),s=Math.round(this.left*r)/r,n=Math.round(this.bottom*r)/r,i=Math.round(this.right*r)/r,o=Math.round(this.top*r)/r;return!0===t?n+","+s+","+o+","+i:s+","+n+","+i+","+o}getWidth(){return this.right-this.left}getHeight(){return this.top-this.bottom}getSize(){return new de(this.getWidth(),this.getHeight())}getCenterPixel(){return new n((this.left+this.right)/2,(this.bottom+this.top)/2)}getCenterLonLat(){return this.centerLonLat||(this.centerLonLat=new me((this.left+this.right)/2,(this.bottom+this.top)/2)),this.centerLonLat}scale(e,t){var r,s;e=e||1,null==t&&(t=this.getCenterLonLat()),"SuperMap.LonLat"===t.CLASS_NAME?(r=t.lon,s=t.lat):(r=t.x,s=t.y);var n=(this.left-r)*e+r,i=(this.bottom-s)*e+s,o=(this.right-r)*e+r,a=(this.top-s)*e+s;return new fe(n,i,o,a)}add(e,t){if(null==e||null==t)throw new TypeError("Bounds.add cannot receive null values");return new fe(this.left+e,this.bottom+t,this.right+e,this.top+t)}extend(e){var t=null;if(e){switch(e.CLASS_NAME){case"SuperMap.LonLat":t=new fe(e.lon,e.lat,e.lon,e.lat);break;case"SuperMap.Geometry.Point":t=new fe(e.x,e.y,e.x,e.y);break;case"SuperMap.Bounds":t=e}t&&(this.centerLonLat=null,(null==this.left||t.left<this.left)&&(this.left=t.left),(null==this.bottom||t.bottom<this.bottom)&&(this.bottom=t.bottom),(null==this.right||t.right>this.right)&&(this.right=t.right),(null==this.top||t.top>this.top)&&(this.top=t.top))}}containsLonLat(e,t){"boolean"==typeof t&&(t={inclusive:t}),t=t||{};var r=this.contains(e.lon,e.lat,t.inclusive),s=t.worldBounds;if(s&&!r){var n=s.getWidth(),i=(s.left+s.right)/2,o=Math.round((e.lon-i)/n);r=this.containsLonLat({lon:e.lon-o*n,lat:e.lat},{inclusive:t.inclusive})}return r}containsPixel(e,t){return this.contains(e.x,e.y,t)}contains(e,t,r){if(null==r&&(r=!0),null==e||null==t)return!1;return r?e>=this.left&&e<=this.right&&t>=this.bottom&&t<=this.top:e>this.left&&e<this.right&&t>this.bottom&&t<this.top}intersectsBounds(e,t){if("boolean"==typeof t&&(t={inclusive:t}),(t=t||{}).worldBounds){var r=this.wrapDateLine(t.worldBounds);e=e.wrapDateLine(t.worldBounds)}else r=this;null==t.inclusive&&(t.inclusive=!0);var s=!1,n=r.left===e.right||r.right===e.left||r.top===e.bottom||r.bottom===e.top;if(t.inclusive||!n){var i=e.bottom>=r.bottom&&e.bottom<=r.top||r.bottom>=e.bottom&&r.bottom<=e.top,o=e.top>=r.bottom&&e.top<=r.top||r.top>e.bottom&&r.top<e.top,a=e.left>=r.left&&e.left<=r.right||r.left>=e.left&&r.left<=e.right,l=e.right>=r.left&&e.right<=r.right||r.right>=e.left&&r.right<=e.right;s=(i||o)&&(a||l)}if(t.worldBounds&&!s){var u=t.worldBounds,h=u.getWidth(),c=!u.containsBounds(r),p=!u.containsBounds(e);c&&!p?(e=e.add(-h,0),s=r.intersectsBounds(e,{inclusive:t.inclusive})):p&&!c&&(r=r.add(-h,0),s=e.intersectsBounds(r,{inclusive:t.inclusive}))}return s}containsBounds(e,t,r){null==t&&(t=!1),null==r&&(r=!0);var s=this.contains(e.left,e.bottom,r),n=this.contains(e.right,e.bottom,r),i=this.contains(e.left,e.top,r),o=this.contains(e.right,e.top,r);return t?s||n||i||o:s&&n&&i&&o}determineQuadrant(e){var t="",r=this.getCenterLonLat();return t+=e.lat<r.lat?"b":"t",t+=e.lon<r.lon?"l":"r"}wrapDateLine(e,t){var r=(t=t||{}).leftTolerance||0,s=t.rightTolerance||0,n=this.clone();if(e){for(var i=e.getWidth();n.left<e.left&&n.right-s<=e.left;)n=n.add(i,0);for(;n.left+r>=e.right&&n.right>e.right;)n=n.add(-i,0);var o=n.left+r;o<e.right&&o>e.left&&n.right-s>e.right&&(n=n.add(-i,0))}return n}toServerJSONObject(){return{rightTop:{x:this.right,y:this.top},leftBottom:{x:this.left,y:this.bottom},left:this.left,right:this.right,top:this.top,bottom:this.bottom}}destroy(){this.left=null,this.right=null,this.top=null,this.bottom=null,this.centerLonLat=null}static fromString(e,t){var r=e.split(",");return fe.fromArray(r,t)}static fromArray(e,t){return!0===t?new fe(e[1],e[0],e[3],e[2]):new fe(e[0],e[1],e[2],e[3])}static fromSize(e){return new fe(0,e.h,e.w,0)}static oppositeQuadrant(e){var t="";return t+="t"===e.charAt(0)?"b":"t",t+="l"===e.charAt(1)?"r":"l"}}s.Bounds=fe;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ye{constructor(){this.CLASS_NAME="SuperMap.Geometry",this.id=h.createUniqueID(this.CLASS_NAME+"_"),this.parent=null,this.bounds=null,this.SRID=null}destroy(){this.id=null,this.bounds=null,this.SRID=null}clone(){return new ye}setBounds(e){e&&(this.bounds=e.clone())}clearBounds(){this.bounds=null,this.parent&&this.parent.clearBounds()}extendBounds(e){this.getBounds()?this.bounds.extend(e):this.setBounds(e)}getBounds(){return null==this.bounds&&this.calculateBounds(),this.bounds}calculateBounds(){}getVertices(e){}getArea(){return 0}}s.Geometry=ye;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ge extends ye{constructor(e){super(),this.components=[],this.componentTypes=null,null!=e&&this.addComponents(e),this.CLASS_NAME="SuperMap.Geometry.Collection",this.geometryType="Collection"}destroy(){this.components.length=0,this.components=null,super.destroy()}clone(){for(var e=new ge,t=0,r=this.components.length;t<r;t++)e.addComponent(this.components[t].clone());return h.applyDefaults(e,this),e}getComponentsString(){for(var e=[],t=0,r=this.components.length;t<r;t++)e.push(this.components[t].toShortString());return e.join(",")}calculateBounds(){this.bounds=null;var e=new fe,t=this.components;if(t)for(var r=0,s=t.length;r<s;r++)e.extend(t[r].getBounds());null!=e.left&&null!=e.bottom&&null!=e.right&&null!=e.top&&this.setBounds(e)}addComponents(e){h.isArray(e)||(e=[e]);for(var t=0,r=e.length;t<r;t++)this.addComponent(e[t])}addComponent(e,t){var r=!1;if(e&&(null==this.componentTypes||h.indexOf(this.componentTypes,e.CLASS_NAME)>-1)){if(null!=t&&t<this.components.length){var s=this.components.slice(0,t),n=this.components.slice(t,this.components.length);s.push(e),this.components=s.concat(n)}else this.components.push(e);e.parent=this,this.clearBounds(),r=!0}return r}removeComponents(e){var t=!1;h.isArray(e)||(e=[e]);for(var r=e.length-1;r>=0;--r)t=this.removeComponent(e[r])||t;return t}removeComponent(e){return h.removeItem(this.components,e),this.clearBounds(),!0}getArea(){for(var e=0,t=0,r=this.components.length;t<r;t++)e+=this.components[t].getArea();return e}equals(e){var t=!0;if(e&&e.CLASS_NAME&&this.CLASS_NAME===e.CLASS_NAME)if(h.isArray(e.components)&&e.components.length===this.components.length){for(var r=0,s=this.components.length;r<s;++r)if(!this.components[r].equals(e.components[r])){t=!1;break}}else t=!1;else t=!1;return t}getVertices(e){for(var t=[],r=0,s=this.components.length;r<s;++r)Array.prototype.push.apply(t,this.components[r].getVertices(e));return t}}s.Geometry.Collection=ge;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Ee extends ye{constructor(e,t,r,s){super(e,t,r,s),this.x=parseFloat(e),this.y=parseFloat(t),this.tag=s||0==s?parseFloat(s):null,this.type=r||"Point",this.CLASS_NAME="SuperMap.Geometry.Point",this.geometryType="Point"}clone(e){return null==e&&(e=new Ee(this.x,this.y)),h.applyDefaults(e,this),e}calculateBounds(){this.bounds=new fe(this.x,this.y,this.x,this.y)}equals(e){var t=!1;return null!=e&&(t=this.x===e.x&&this.y===e.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(e.x)&&isNaN(e.y)),t}move(e,t){this.x=this.x+e,this.y=this.y+t,this.clearBounds()}toShortString(){return this.x+", "+this.y}destroy(){this.x=null,this.y=null,this.tag=null,super.destroy()}getVertices(e){return[this]}}s.Geometry.Point=Ee;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ve extends ge{constructor(e){super(e),this.componentTypes=["SuperMap.Geometry.Point"],this.CLASS_NAME="SuperMap.Geometry.MultiPoint",this.geometryType="MultiPoint"}addPoint(e,t){this.addComponent(e,t)}removePoint(e){this.removeComponent(e)}}s.Geometry.MultiPoint=ve;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Se extends ve{constructor(e){super(e),this.componentTypes=["SuperMap.Geometry.Point","SuperMap.PointWithMeasure"],this.CLASS_NAME="SuperMap.Geometry.Curve",this.geometryType="Curve"}}s.Geometry.Curve=Se;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Te extends Se{constructor(e){super(e),this.CLASS_NAME="SuperMap.Geometry.LineString",this.geometryType="LineString"}removeComponent(e){var t=this.components&&this.components.length>2;return t&&super.removeComponent.apply(this,arguments),t}getSortedSegments(){for(var e,t,r=this.components.length-1,s=new Array(r),n=0;n<r;++n)e=this.components[n],t=this.components[n+1],e.x<t.x?s[n]={x1:e.x,y1:e.y,x2:t.x,y2:t.y}:s[n]={x1:t.x,y1:t.y,x2:e.x,y2:e.y};return s.sort(function(e,t){return e.x1-t.x1})}getVertices(e){return!0===e?[this.components[0],this.components[this.components.length-1]]:!1===e?this.components.slice(1,this.components.length-1):this.components.slice()}static calculateCircle(e){if(e.length<3)return e;var t={},r=e[0],s=e[1],n=e[2],i=0,o=0,a=!0,l=0,u=0,h=0,c=[],p=(n.y-r.y)/(n.x-r.x),d=n.y-p*n.x;if(n.x!=r.x&&n.y!=r.y&&s.y==p*s.x+d||n.x==r.x&&s.x==r.x||n.y==r.y&&s.y==r.y||n.x==r.x&&n.y==r.y||n.x==s.x&&n.y==s.y||r.x==s.x&&r.y==s.y)c.push(r),c.push(s),c.push(n);else{var m=(s.x*s.x+s.y*s.y-(r.x*r.x+r.y*r.y))*(2*(n.y-r.y))-(n.x*n.x+n.y*n.y-(r.x*r.x+r.y*r.y))*(2*(s.y-r.y)),f=2*(s.x-r.x)*(n.x*n.x+n.y*n.y-(r.x*r.x+r.y*r.y))-2*(n.x-r.x)*(s.x*s.x+s.y*s.y-(r.x*r.x+r.y*r.y)),y=4*((s.x-r.x)*(n.y-r.y)-(n.x-r.x)*(s.y-r.y));t.x=m/y,t.y=f/y;var g=(2*(i=Math.sqrt((r.x-t.x)*(r.x-t.x)+(r.y-t.y)*(r.y-t.y)))*i-((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y)))/(2*i*i);g=(g=g>=1?1:g)<=-1?-1:g,h=180*Math.acos(g)/Math.PI,o=(h=n.x==r.x?t.x>r.x&&s.x>r.x||t.x<r.x&&s.x<r.x?360-h:h:t.y>p*t.x+d&&s.y>p*s.x+d||t.y<p*t.x+d&&s.y<p*s.x+d?360-h:h)/72,n.y!=r.y?n.x==r.x?n.y>r.y?s.x<r.x&&(a=!1):s.x>r.x&&(a=!1):n.x<r.x?s.y<p*s.x+d&&(a=!1):s.y>p*s.x+d&&(a=!1):n.x>r.x?s.y>r.y&&(a=!1):s.y<r.y&&(a=!1);var E=(r.y-t.y)/(r.x-t.x),v=E>=0?180*Math.atan(E)/Math.PI:Math.abs(180*Math.atan(E)/Math.PI)+90,S=Math.abs(t.y);r.y==S&&S==n.y&&r.x<n.x&&(v+=180);var T=r.y-t.y;c.push(r);for(var C=1;C<72;C++){l=o*C,u=v,a?T>=0?E>=0?u+=l:u=180-(u-90)+l:u=E>0?u-180+l:90-u+l:T>=0?E>=0?u-=l:u=180-(u-90)-l:u=E>=0?u-180-l:90-u-l,u=u*Math.PI/180;var N=t.x+i*Math.cos(u),b=t.y+i*Math.sin(u);c.push(new Ee(N,b))}c.push(n)}return c}static createLineEPS(e){var t=[],r=e.length;if(r<2)return e;for(var s=0;s<r;){if("LTypeArc"==e[s].type){var n=Te.createLineArc(t,s,r,e);t=n[0],s=n[1]}else t.push(e[s]),s++}return t}static createLineArc(e,t,r,s){if(0==t){let n=Te.addPointEPS(s,t,r,"LTypeArc");Array.prototype.push.apply(e,n[0]),t=n[1]+1}else if(t==r-1){var n=[s[t-1],s[t]],i=Te.calculateCircle(n);Array.prototype.push.apply(e,i),t++}else{let n=Te.addPointEPS(s,t,r,"LTypeArc");e.pop(),Array.prototype.push.apply(e,n[0]),t=n[1]+1}return[e,t]}static addPointEPS(e,t,r,s){var n,i=[],o=t+1;return 0==t?Array.prototype.push.apply(i,[e[t],e[t+1]]):t==r-1?Array.prototype.push.apply(i,[e[t-1],e[t]]):Array.prototype.push.apply(i,[e[t-1],e[t],e[t+1]]),"LTypeCurve"==s?n=Te.calculatePointsFBZN(i):"LTypeArc"==s&&(n=Te.calculateCircle(i)),[n,o]}}s.Geometry.LineString=Te;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Ce extends ge{constructor(e){super(e),this.componentTypes=["SuperMap.Geometry.LineString"],this.CLASS_NAME="SuperMap.Geometry.MultiLineString",this.geometryType="MultiLineString"}}s.Geometry.MultiLineString=Ce;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Ne extends Te{constructor(e){super(e),this.componentTypes=["SuperMap.Geometry.Point"],this.CLASS_NAME="SuperMap.Geometry.LinearRing",this.geometryType="LinearRing"}addComponent(e,t){var r=!1,s=this.components.pop();null==t&&e.equals(s)||(r=super.addComponent.apply(this,arguments));var n=this.components[0];return super.addComponent.apply(this,[n]),r}removeComponent(e){var t=this.components&&this.components.length>3;if(t){this.components.pop(),super.removeComponent.apply(this,arguments);var r=this.components[0];super.addComponent.apply(this,[r])}return t}getArea(){var e=0;if(this.components&&this.components.length>2){for(var t=0,r=0,s=this.components.length;r<s-1;r++){var n=this.components[r],i=this.components[r+1];t+=(n.x+i.x)*(i.y-n.y)}e=-t/2}return e}getVertices(e){return!0===e?[]:this.components.slice(0,this.components.length-1)}}s.Geometry.LinearRing=Ne;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class be extends ge{constructor(e){super(e),this.componentTypes=["SuperMap.Geometry.LinearRing"],this.CLASS_NAME="SuperMap.Geometry.Polygon",this.geometryType="Polygon"}getArea(){var e=0;if(this.components&&this.components.length>0){e+=Math.abs(this.components[0].getArea());for(var t=1,r=this.components.length;t<r;t++)e-=Math.abs(this.components[t].getArea())}return e}}s.Geometry.Polygon=be;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class _e extends ge{constructor(e){super(e),this.componentTypes=["SuperMap.Geometry.Polygon"],this.CLASS_NAME="SuperMap.Geometry.MultiPolygon",this.geometryType="MultiPolygon"}}s.Geometry.MultiPolygon=_e;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Ie{constructor(e,t,r){this.red=e||0==e?e:255,this.green=t||0,this.blue=r||0,this.CLASS_NAME="SuperMap.ServerColor"}destroy(){this.red=null,this.green=null,this.blue=null}static fromJson(e){if(e){var t=new Ie,r=255;null!==e.red&&(r=Number(e.red)),t.red=r;var s=0;null!==e.green&&(s=Number(e.green)),t.green=s;var n=0;return null!==e.blue&&(n=Number(e.blue)),t.blue=n,t}}}s.ServerColor=Ie;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class we{constructor(e){this.fillBackColor=new Ie(255,255,255),this.fillBackOpaque=!1,this.fillForeColor=new Ie(255,0,0),this.fillGradientMode=null,this.fillGradientAngle=0,this.fillGradientOffsetRatioX=0,this.fillGradientOffsetRatioY=0,this.fillOpaqueRate=100,this.fillSymbolID=0,this.lineColor=new Ie(0,0,0),this.lineSymbolID=0,this.lineWidth=1,this.markerAngle=0,this.markerSize=1,this.markerSymbolID=-1,e&&h.extend(this,e),this.CLASS_NAME="SuperMap.ServerStyle"}destroy(){var e=this;e.fillBackColor&&(e.fillBackColor.destroy(),e.fillBackColor=null),e.fillBackOpaque=null,e.fillForeColor&&(e.fillForeColor.destroy(),e.fillForeColor=null),e.fillGradientMode=null,e.fillGradientAngle=null,e.fillGradientOffsetRatioX=null,e.fillGradientOffsetRatioY=null,e.fillOpaqueRate=null,e.fillSymbolID=null,e.lineColor&&(e.lineColor.destroy(),e.lineColor=null),e.lineSymbolID=null,e.lineWidth=null,e.markerAngle=null,e.markerSize=null,e.markerSymbolID=null}toServerJSONObject(){var e={};return e=h.copyAttributes(e,this)}static fromJson(e){if(e)return new we({fillBackColor:Ie.fromJson(e.fillBackColor),fillBackOpaque:e.fillBackOpaque,fillForeColor:Ie.fromJson(e.fillForeColor),fillGradientMode:e.fillGradientMode,fillGradientAngle:e.fillGradientAngle,fillGradientOffsetRatioX:e.fillGradientOffsetRatioX,fillGradientOffsetRatioY:e.fillGradientOffsetRatioY,fillOpaqueRate:e.fillOpaqueRate,fillSymbolID:e.fillSymbolID,lineColor:Ie.fromJson(e.lineColor),lineSymbolID:e.lineSymbolID,lineWidth:e.lineWidth,markerAngle:e.markerAngle,markerSize:e.markerSize,markerSymbolID:e.markerSymbolID})}}s.ServerStyle=we;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class xe extends Ee{constructor(e){super(e),this.measure=null,e&&h.extend(this,e),this.CLASS_NAME="SuperMap.PointWithMeasure"}equals(e){var t=!1;if(null!=e){var r=this.x===e.x&&this.y===e.y&&this.measure===e.measure,s=isNaN(this.x)&&isNaN(this.y)&&isNaN(this.measure),n=isNaN(e.x)&&isNaN(e.y)&&isNaN(e.measure);t=r||s&&n}return t}toJson(){var e="{";return null!=this.measure&&void 0!=this.measure&&(e+='"measure":'+this.measure+","),e+='"x":'+this.x+",",e+='"y":'+this.y,e+="}"}destroy(){this.measure=null,this.x=null,this.y=null}static fromJson(e){if(e)return new xe({x:e.x,y:e.y,measure:e.measure})}}s.PointWithMeasure=xe;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Re extends ge{constructor(e,t){super(e,t),this.id=null,this.center=null,this.style=null,this.length=null,this.maxM=null,this.minM=null,this.parts=null,this.points=null,this.type=null,this.componentTypes=["SuperMap.Geometry.LinearRing","SuperMap.Geometry.LineString"],t&&h.extend(this,t),this.CLASS_NAME="SuperMap.Route",this.geometryType="LINEM"}toJson(){var e="{";if(null!=this.id&&void 0!=this.id&&(e+='"id":'+this.id+","),null!=this.center&&void 0!=this.center&&(e+='"center":'+this.center+","),null!=this.style&&void 0!=this.style&&(e+='"style":'+this.style+","),null!=this.length&&void 0!=this.length&&(e+='"length":'+this.length+","),null!=this.maxM&&void 0!=this.maxM&&(e+='"maxM":'+this.maxM+","),null!=this.minM&&void 0!=this.minM&&(e+='"minM":'+this.minM+","),null!=this.type&&void 0!=this.type&&(e+='"type":"'+this.type+'",'),null!=this.parts&&void 0!=this.parts){e+='"parts":['+this.parts[0];for(var t=1;t<this.parts.length;t++)e+=","+this.parts[t];e+="],"}if(null!=this.components&&this.components.length>0){e+='"points":[';for(var r=0,s=this.components.length;r<s;r++)for(var n=0,i=this.components[r].components.length;n<i;n++)e+=this.components[r].components[n].toJson()+",";e=e.replace(/,$/g,""),e+="]"}return e=e.replace(/,$/g,""),e+="}"}destroy(){var e=this;e.id=null,e.center=null,e.style=null,e.length=null,e.maxM=null,e.minM=null,e.type=null,e.parts=null,e.components.length=0,e.components=null,e.componentTypes=null}static fromJson(e){if(e){var t=e.parts||[],r=e.points||[],s=t.length,n=[];if(!(s>0))return null;for(var i=0,o=0,a=[];i<s;i++){for(var l=0;l<t[i];l++)a.push(xe.fromJson(r[o+l]));o+=t[i],a[0].equals(a[t[i]-1])?n.push(new Ne(a)):n.push(new Te(a)),a=[]}return new Re(n,{id:e.id,center:e.center,style:e.style,length:e.length,maxM:e.maxM,minM:e.minM,type:e.type,parts:e.parts})}}}s.Route=Re;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Le{constructor(e){this.id=0,this.style=null,this.parts=null,this.points=null,this.type=null,this.prjCoordSys=null,e&&h.extend(this,e),this.CLASS_NAME="SuperMap.ServerGeometry"}destroy(){var e=this;e.id=null,e.style=null,e.parts=null,e.partTopo=null,e.points=null,e.type=null,e.prjCoordSys=null}toGeometry(){var e=this;switch(e.type.toUpperCase()){case w.POINT:return e.toGeoPoint();case w.LINE:return e.toGeoLine();case w.LINEM:return e.toGeoLinem();case w.REGION:return e.toGeoRegion();case w.POINTEPS:return e.toGeoPoint();case w.LINEEPS:return e.toGeoLineEPS();case w.REGIONEPS:return e.toGeoRegionEPS()}}toGeoPoint(){var e=this.parts||[],t=this.points||[],r=e.length;if(r>0){if(1===r)return new Ee(t[0].x,t[0].y);var s=[];for(let e=0;e<r;e++)s.push(new Ee(t[e].x,t[e].y));return new ve(s)}return null}toGeoLine(){var e=this.parts||[],t=this.points||[],r=e.length;if(r>0){if(1===r){let r=[];for(let s=0;s<e[0];s++)r.push(new Ee(t[s].x,t[s].y));return r[0].equals(r[e[0]-1])?new Ne(r):new Te(r)}{let s=[];for(let n=0;n<r;n++){let r=[];for(let s=0;s<e[n];s++)r.push(new Ee(t[s].x,t[s].y));s.push(new Te(r)),t.splice(0,e[n])}return new Ce(s)}}return null}toGeoLineEPS(){var e,t,r,s,n,i=this.parts||[],o=this.points||[],a=i.length;if(a>0){if(1===a){for(e=0,r=[];e<i[0];e++)r.push(new Ee(o[e].x,o[e].y,o[e].type));return r[0].equals(r[i[0]-1])?(n=Te.createLineEPS(r),new Ne(n)):(n=Te.createLineEPS(r),new Te(n))}for(e=0,s=[];e<a;e++){for(t=0,r=[];t<i[e];t++)r.push(new Ee(o[t].x,o[t].y));n=Te.createLineEPS(r),s.push(new Te(n)),o.splice(0,i[e])}return new Ce(s)}return null}toGeoLinem(){return Re.fromJson(this)}toGeoRegion(){var e=this.parts||[],t=this.partTopo||[],r=this.points||[],s=e.length;if(s<=0)return null;var n=[],i=[];if(1==s){for(let e=0;e<r.length;e++)i.push(new Ee(r[e].x,r[e].y));return n.push(new be([new Ne(i)])),new _e(n)}var o=[],a=[],l=[],u=[],h=[];for(let n=0,o=0;n<s;n++){for(let t=0;t<e[n];t++)i.push(new Ee(r[o+t].x,r[o+t].y));o+=e[n];var c=new be([new Ne(i)]);i=[],l.push(c),0===t.length&&u.push(c.getBounds()),h.push(1),a.push(c.getArea())}if(Le.bubbleSort(a,l,t,u),0===t.length){var p=[];for(let e=1;e<l.length;e++)for(let t=e-1;t>=0;t--)if(p[e]=-1,u[t].containsBounds(u[e])){h[e]=-1*h[t],h[e]<0&&(p[e]=t);break}for(let e=0;e<l.length;e++)h[e]>0?n.push(l[e]):(n[p[e]].components=n[p[e]].components.concat(l[e].components),n.push(""))}else{n=new Array;for(let e=0;e<l.length;e++)if(t[e]&&-1==t[e]?o=o.concat(l[e].components):(o.length>0&&n.length>0&&(n[n.length-1].components=n[n.length-1].components.concat(o),o=[]),n.push(l[e])),e==s-1){var d=n.length;if(d)n[d-1].components=n[d-1].components.concat(o);else for(let e=0,t=o.length;e<t;e++)n.push(new be(o))}}return new _e(n)}toGeoRegionEPS(){var e=this.parts||[],t=this.partTopo||[],r=this.points||[],s=e.length;if(s<=0)return null;var n,i=[],o=[];if(1==s){for(var a=0;a<r.length;a++)o.push(new Ee(r[a].x,r[a].y));return n=Te.createLineEPS(o),i.push(new be([new Ne(n)])),new _e(i)}var l=[],u=[],h=[],c=[],p=[];for(let i=0,a=0;i<s;i++){for(let t=0;t<e[i];t++)o.push(new Ee(r[a+t].x,r[a+t].y));a+=e[i],n=Te.createLineEPS(o);var d=new be([new Ne(n)]);o=[],h.push(d),0===t.length&&c.push(d.getBounds()),p.push(1),u.push(d.getArea())}if(Le.bubbleSort(u,h,t,c),0===t.length){var m=[];for(let e=1;e<h.length;e++)for(let t=e-1;t>=0;t--)if(m[e]=-1,c[t].containsBounds(c[e])){p[e]=-1*p[t],p[e]<0&&(m[e]=t);break}for(let e=0;e<h.length;e++)p[e]>0?i.push(h[e]):(i[m[e]].components=i[m[e]].components.concat(h[e].components),i.push(""))}else{i=new Array;for(let e=0;e<h.length;e++)if(t[e]&&-1==t[e]?l=l.concat(h[e].components):(l.length>0&&i.length>0&&(i[i.length-1].components=i[i.length-1].components.concat(l),l=[]),i.push(h[e])),e==s-1){var f=i.length;if(f)i[f-1].components=i[f-1].components.concat(l);else for(let e=0,t=l.length;e<t;e++)i.push(new be(l))}}return new _e(i)}static fromJson(e){if(e)return new Le({id:e.id,style:we.fromJson(e.style),parts:e.parts,partTopo:e.partTopo,points:e.points,center:e.center,length:e.length,maxM:e.maxM,minM:e.minM,type:e.type})}static fromGeometry(e){if(e){var t=0,r=[],s=[],n=null,i=e.components,o=e.CLASS_NAME,a={epsgCode:e.SRID};if(isNaN(e.id)||(t=e.id),"SuperMap.Geometry.LinearRing"!=o&&"SuperMap.Geometry.LineString"!=o&&(e instanceof ve||e instanceof Ce)){let e=i.length;for(let t=0;t<e;t++){let e=i[t].getVertices().length;r.push(e);for(let r=0;r<e;r++)s.push(new Ee(i[t].getVertices()[r].x,i[t].getVertices()[r].y))}n="SuperMap.Geometry.MultiPoint"==o?w.POINT:w.LINE}else if(e instanceof _e){let e=i.length;for(let t=0;t<e;t++){let e=i[t].components,n=e.length;for(let t=0;t<n;t++){let n=e[t].getVertices().length+1;r.push(n);for(let r=0;r<n-1;r++)s.push(new Ee(e[t].getVertices()[r].x,e[t].getVertices()[r].y));s.push(new Ee(e[t].getVertices()[0].x,e[t].getVertices()[0].y))}}n=w.REGION}else if(e instanceof be){let e=i.length;for(let t=0;t<e;t++){let e=i[t].getVertices().length+1;r.push(e);for(let r=0;r<e-1;r++)s.push(new Ee(i[t].getVertices()[r].x,i[t].getVertices()[r].y));s.push(new Ee(i[t].getVertices()[0].x,i[t].getVertices()[0].y))}n=w.REGION}else{let t=e.getVertices().length;for(let r=0;r<t;r++)s.push(new Ee(e.getVertices()[r].x,e.getVertices()[r].y));e instanceof Ne&&(s.push(new Ee(e.getVertices()[0].x,e.getVertices()[0].y)),t++),r.push(t),n=e instanceof Ee?w.POINT:w.LINE}return new Le({id:t,style:null,parts:r,points:s,type:n,prjCoordSys:a})}}static IsClockWise(e){var t=e.length;if(t<3)return 0;var r=e[0].y*(e[t-1].x-e[1].x);e.push(e[0]);for(var s=1;s<t;s++)r+=e[s].y*(e[s-1].x-e[s+1].x);return.5*r}static bubbleSort(e,t,r,s){for(var n=0;n<e.length;n++)for(var i=0;i<e.length;i++)if(e[n]>e[i]){var o=e[i];e[i]=e[n],e[n]=o;var a=t[i];if(t[i]=t[n],t[n]=a,r&&r.length>0){var l=r[i];r[i]=r[n],r[n]=l}if(s&&s.length>0){var u=s[i];s[i]=s[n],s[n]=u}}}}s.ServerGeometry=Le;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Ae extends ue{constructor(e){super(e),this.ignoreExtraDims=!0,this.CLASS_NAME="SuperMap.Format.GeoJSON",this.parseCoords={point:function(e){if(0==this.ignoreExtraDims&&2!=e.length)throw"Only 2D points are supported: "+e;return new Ee(e[0],e[1])},multipoint:function(e){for(var t=[],r=null,s=0,n=e.length;s<n;++s){try{r=this.parseCoords.point.apply(this,[e[s]])}catch(e){throw e}t.push(r)}return new ve(t)},linestring:function(e){for(var t=[],r=null,s=0,n=e.length;s<n;++s){try{r=this.parseCoords.point.apply(this,[e[s]])}catch(e){throw e}t.push(r)}return new Te(t)},multilinestring:function(e){for(var t=[],r=null,s=0,n=e.length;s<n;++s){try{r=this.parseCoords.linestring.apply(this,[e[s]])}catch(e){throw e}t.push(r)}return new Ce(t)},polygon:function(e){for(var t,r,s=[],n=0,i=e.length;n<i;++n){try{r=this.parseCoords.linestring.apply(this,[e[n]])}catch(e){throw e}t=new Ne(r.components),s.push(t)}return new be(s)},multipolygon:function(e){for(var t=[],r=null,s=0,n=e.length;s<n;++s){try{r=this.parseCoords.polygon.apply(this,[e[s]])}catch(e){throw e}t.push(r)}return new _e(t)},box:function(e){if(2!=e.length)throw"GeoJSON box coordinates must have 2 elements";return new be([new Ne([new Ee(e[0][0],e[0][1]),new Ee(e[1][0],e[0][1]),new Ee(e[1][0],e[1][1]),new Ee(e[0][0],e[1][1]),new Ee(e[0][0],e[0][1])])])}},this.extract={feature:function(e){var t=this.extract.geometry.apply(this,[e.geometry]),r={type:"Feature",properties:this.createAttributes(e),geometry:t};return e.geometry&&"TEXT"===e.geometry.type&&(r.properties.texts=e.geometry.texts,r.properties.textStyle=e.geometry.textStyle),e.fid&&(r.id=e.fid),e.ID&&(r.id=e.ID),r},geometry:function(e){if(null==e)return null;!e.parts&&e.points&&(e.parts=[e.points.length]);var t,r=new Le(e).toGeometry()||e,s=r.geometryType||r.type;return"LinearRing"===s&&(s="LineString"),"LINEM"===s&&(s="MultiLineString"),t=this.extract[s.toLowerCase()].apply(this,[r]),"Collection"===(s="TEXT"===s?"Point":s)?{type:"GeometryCollection",geometries:t}:{type:s,coordinates:t}},point:function(e){var t=[e.x,e.y];for(var r in e)"x"===r||"y"===r||null===e[r]||isNaN(e[r])||t.push(e[r]);return t},text:function(e){return[e.points[0].x,e.points[0].y]},multipoint:function(e){for(var t=[],r=0,s=e.components.length;r<s;++r)t.push(this.extract.point.apply(this,[e.components[r]]));return t},linestring:function(e){for(var t=[],r=0,s=e.components.length;r<s;++r)t.push(this.extract.point.apply(this,[e.components[r]]));return t},multilinestring:function(e){for(var t=[],r=0,s=e.components.length;r<s;++r)t.push(this.extract.linestring.apply(this,[e.components[r]]));return t},polygon:function(e){for(var t=[],r=0,s=e.components.length;r<s;++r)t.push(this.extract.linestring.apply(this,[e.components[r]]));return t},multipolygon:function(e){for(var t=[],r=0,s=e.components.length;r<s;++r)t.push(this.extract.polygon.apply(this,[e.components[r]]));return t},collection:function(e){for(var t=e.components.length,r=new Array(t),s=0;s<t;++s)r[s]=this.extract.geometry.apply(this,[e.components[s]]);return r}}}read(e,t,r){t=t||"FeatureCollection";var s=null,n=null;if(n="string"==typeof e?super.read(e,r):e){if("string"!=typeof n.type);else if(this.isValidType(n,t))switch(t){case"Geometry":try{s=this.parseGeometry(n)}catch(e){}break;case"Feature":try{(s=this.parseFeature(n)).type="Feature"}catch(e){}break;case"FeatureCollection":switch(s=[],n.type){case"Feature":try{s.push(this.parseFeature(n))}catch(e){s=null}break;case"FeatureCollection":for(var i=0,o=n.features.length;i<o;++i)try{s.push(this.parseFeature(n.features[i]))}catch(e){s=null}break;default:try{var a=this.parseGeometry(n);s.push(new pe(a))}catch(e){s=null}}}}else;return s}write(e,t){return super.write(this.toGeoJSON(e),t)}fromGeoJSON(e,t,r){let s=this.read(e,t,r);return h.isArray(s)?s.map(e=>this._toiSevrerFeature(e)):this._toiSevrerFeature(s)}toGeoJSON(e){var t={type:null};if(h.isArray(e)){t.type="FeatureCollection";var r=e.length;t.features=new Array(r);for(var s=0;s<r;++s){var n=e[s];if(i(n)){let e={};e.geometry=n,t.features[s]=this.extract.feature.apply(this,[e])}else t.features[s]=this.extract.feature.apply(this,[n])}}else if(i(e)){let r={};r.geometry=e,t=this.extract.feature.apply(this,[r])}else t=this.extract.feature.apply(this,[e]);function i(e){return e.hasOwnProperty("parts")&&e.hasOwnProperty("points")}return t}isValidType(e,t){var r=!1;switch(t){case"Geometry":-1==h.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],e.type)||(r=!0);break;case"FeatureCollection":r=!0;break;default:e.type==t&&(r=!0)}return r}parseFeature(e){var t,r,s,n;s=e.properties?e.properties:{},n=e.geometry&&e.geometry.bbox||e.bbox;try{r=this.parseGeometry(e.geometry)}catch(e){throw e}return t=new pe(r,s),n&&(t.bounds=fe.fromArray(n)),e.id&&(t.fid=e.id),t}parseGeometry(e){if(null==e)return null;var t;if("GeometryCollection"==e.type){if(!h.isArray(e.geometries))throw"GeometryCollection must have geometries array: "+e;for(var r=e.geometries.length,s=new Array(r),n=0;n<r;++n)s[n]=this.parseGeometry.apply(this,[e.geometries[n]]);t=new ge(s)}else{if(!h.isArray(e.coordinates))throw"Geometry must have coordinates array: "+e;if(!this.parseCoords[e.type.toLowerCase()])throw"Unsupported geometry type: "+e.type;try{t=this.parseCoords[e.type.toLowerCase()].apply(this,[e.coordinates])}catch(e){throw e}}return t}createCRSObject(e){var t=e.layer.projection.toString(),r={};if(t.match(/epsg:/i)){var s=parseInt(t.substring(t.indexOf(":")+1));r=4326==s?{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:{type:"name",properties:{name:"EPSG:"+s}}}return r}_toiSevrerFeature(e){const t=e.attributes,r=[],s=[];for(var n in t)r.push(n),s.push(t[n]);const i={fieldNames:r,fieldValues:s,geometry:Le.fromGeometry(e.geometry)};return i.geometry.id=e.fid,i}createAttributes(e){if(!e)return null;var t={};!function(e,t){if(!e.hasOwnProperty("fieldNames")||!e.hasOwnProperty("fieldValues"))return;var r=e.fieldNames,s=e.fieldValues;for(var n in r)t[r[n]]=s[n]}(e,t);var r=["fieldNames","fieldValues","geometry"];for(var s in e)r.indexOf(s)>-1||(t[s]=e[s]);return t}}s.Format.GeoJSON=Ae;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Pe extends he{constructor(e,t){super(e,t),t=t||{},this.returnContent=!0,this.fromIndex=0,this.toIndex=19,this.maxFeatures=null,this.format=_.GEOJSON,h.extend(this,t);var r;t.format&&(this.format=t.format.toUpperCase()),r=this.url.substr(this.url.length-1,1),this.url+="/"==r?"featureResults.json?":"/featureResults.json?",this.CLASS_NAME="SuperMap.GetFeaturesServiceBase"}destroy(){super.destroy();var e=this;e.returnContent=null,e.fromIndex=null,e.toIndex=null,e.maxFeatures=null,e.format=null}processAsync(e){if(e){var t,r=this,s=!0;r.returnContent=e.returnContent,r.fromIndex=e.fromIndex,r.toIndex=e.toIndex,r.maxFeatures=e.maxFeatures,r.returnContent&&(r.url+="returnContent="+r.returnContent,s=!1),null!=r.fromIndex&&null!=r.toIndex&&!isNaN(r.fromIndex)&&!isNaN(r.toIndex)&&r.fromIndex>=0&&r.toIndex>=0&&!s&&(r.url+="&fromIndex="+r.fromIndex+"&toIndex="+r.toIndex),e.returnCountOnly&&(r.url+="&returnCountOnly="+e.returnContent),t=r.getJsonParameters(e),r.request({method:"POST",data:t,scope:r,success:r.serviceProcessCompleted,failure:r.serviceProcessFailed})}}serviceProcessCompleted(e){if(e=h.transformResult(e),this.format===_.GEOJSON&&e.features){var t=new Ae;e.features=t.toGeoJSON(e.features)}this.events.triggerEvent("processCompleted",{result:e})}}s.GetFeaturesServiceBase=Pe;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Oe extends Pe{constructor(e,t){super(e,t),this.CLASS_NAME="SuperMap.GetFeaturesBySQLService"}destroy(){super.destroy()}getJsonParameters(e){return oe.toJsonParameters(e)}}s.GetFeaturesBySQLService=Oe;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Me{constructor(e){e&&(this.customParams=null,this.prjCoordSys=null,this.expectCount=1e5,this.networkType=w.LINE,this.queryOption=x.ATTRIBUTEANDGEOMETRY,this.queryParams=null,this.startRecord=0,this.holdTime=10,this.returnCustomResult=!1,this.returnFeatureWithFieldCaption=!1,h.extend(this,e),this.CLASS_NAME="SuperMap.QueryParameters")}destroy(){var e=this;if(e.customParams=null,e.expectCount=null,e.networkType=null,e.queryOption=null,e.queryParams){for(var t=0,r=e.queryParams,s=r.length;t<s;t++)r[t].destroy();e.queryParams=null}e.startRecord=null,e.holdTime=null,e.returnCustomResult=null,e.prjCoordSys=null}}s.QueryParameters=Me;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class De extends Me{constructor(e){e&&(super(e),this.returnContent=!0,h.extend(this,e),this.CLASS_NAME="SuperMap.QueryBySQLParameters")}destroy(){super.destroy();this.returnContent=null}}s.QueryBySQLParameters=De;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Fe extends he{constructor(e,t){super(e,t),this.returnContent=!1,this.format=_.GEOJSON,this.returnFeatureWithFieldCaption=!1,t&&h.extend(this,t),this.CLASS_NAME="SuperMap.QueryService";var r,s=this;s.url&&(t&&t.format&&(s.format=t.format.toUpperCase()),r=s.url.substr(s.url.length-1,1),s.url+="/"===r?"queryResults.json?":"/queryResults.json?")}destroy(){super.destroy();this.returnContent=null,this.format=null}processAsync(e){if(e instanceof Me){var t,r=this,s=null;r.returnContent=e.returnContent,t=r.getJsonParameters(e),r.returnContent?r.url+="returnContent="+r.returnContent:(s=e.returnCustomResult)&&(r.url+="returnCustomResult="+s),r.returnFeatureWithFieldCaption=e.returnFeatureWithFieldCaption,r.request({method:"POST",data:t,scope:r,success:r.serviceProcessCompleted,failure:r.serviceProcessFailed})}}serviceProcessCompleted(e){e=h.transformResult(e);var t=new Ae;if(e&&e.recordsets)for(var r=0,s=e.recordsets,n=s.length;r<n;r++)s[r].features&&(!0===this.returnFeatureWithFieldCaption&&s[r].features.map(e=>(e.fieldNames=s[r].fieldCaptions,e)),this.format===_.GEOJSON&&(s[r].features=t.toGeoJSON(s[r].features)));this.events.triggerEvent("processCompleted",{result:e})}getQueryParameters(e){return new Me({customParams:e.customParams,expectCount:e.expectCount,networkType:e.networkType,queryOption:e.queryOption,queryParams:e.queryParams,startRecord:e.startRecord,prjCoordSys:e.prjCoordSys,holdTime:e.holdTime})}}s.QueryService=Fe;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Ue extends Fe{constructor(e,t){super(e,t),this.CLASS_NAME="SuperMap.QueryBySQLService"}destroy(){super.destroy()}getJsonParameters(e){if(e instanceof De){var t,r="";return t=this.getQueryParameters(e),r+="'queryMode':'SqlQuery','queryParameters':",r="{"+(r+=h.toJSON(t))+"}"}}}s.QueryBySQLService=Ue;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
let Ge={code:null,defaultCode:"en-US",getCode:function(){return s.Lang.code||s.Lang.setCode(),s.Lang.code},setCode:function(){var e=this.getLanguageFromCookie();e?s.Lang.code=e:(e=s.Lang.defaultCode,0===(e="Netscape"===navigator.appName?navigator.language:navigator.browserLanguage).indexOf("zh")&&(e="zh-CN"),0===e.indexOf("en")&&(e="en-US"),s.Lang.code=e)},getLanguageFromCookie(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){for(var r=e[t];" "===r.charAt(0);)r=r.substring(1);if(-1!==r.indexOf("language="))return r.substring("language=".length,r.length)}return""},i18n:function(e){var t=s.Lang[s.Lang.getCode()],r=t&&t[e];return r||(r=e),r}};s.Lang=Ge,s.i18n=s.Lang.i18n;var Be=r(1),Je=r.n(Be);
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
let ke={rABS:"undefined"!=typeof FileReader&&FileReader.prototype&&FileReader.prototype.readAsBinaryString,rABF:"undefined"!=typeof FileReader&&FileReader.prototype&&FileReader.prototype.readAsArrayBuffer,rAT:"undefined"!=typeof FileReader&&FileReader.prototype&&FileReader.prototype.readAsText,readFile(e,t,r,s,n){$.JSON===e||$.GEOJSON===e?this.readTextFile(t,r,s,n):$.EXCEL!==e&&$.CSV!==e||this.readXLSXFile(t,r,s,n)},readTextFile(e,t,r,s){let n=new FileReader;n.onloadend=function(e){t&&t.call(s,e.target.result)},n.onerror=function(e){r&&r.call(s,e)},this.rAT?n.readAsText(e.file,"utf-8"):n.readAsBinaryString(e.file)},readXLSXFile(e,t,r,s){let n=new FileReader;n.onloadend=function(e){let n=new Uint8Array(e.target.result),i=Je.a.read(n,{type:"array"});try{if(i&&i.SheetNames&&i.SheetNames.length>0){let e=i.SheetNames[0],r=Je.a.utils.sheet_to_csv(i.Sheets[e]);t&&t.call(s,r)}}catch(e){r&&r.call(s,e)}},n.onerror=function(e){r&&r.call(s,e)},this.rABF&&n.readAsArrayBuffer(e.file)},processDataToGeoJson(e,t,r,s,n){let i=null;if("EXCEL"===e||"CSV"===e)i=this.processExcelDataToGeoJson(t),r&&r.call(n,i);else if("JSON"===e||"GEOJSON"===e){let e=t;"string"==typeof e&&(e=JSON.parse(e)),"ISERVER"===e.type?i=e.data.recordsets[0].features:"FeatureCollection"===e.type?i=e:s&&s.call(n,Ge.i18n("msg_dataInWrongGeoJSONFormat")),r&&r.call(n,i)}else s&&s.call(n,Ge.i18n("msg_dataInWrongFormat"))},processExcelDataToGeoJson(e){let t=this.string2Csv(e),r=t.colTitles,s=-1,n=-1;for(let e=0,t=r.length;e<t;e++)this.isXField(r[e])&&(s=e),this.isYField(r[e])&&(n=e);let i=[];for(let e=0,r=t.rows.length;e<r;e++){let r=t.rows[e],o=Number(r[s]),a=Number(r[n]),l={};for(let r in t.colTitles){l[t.colTitles[r]]=t.rows[e][r]}let u={type:"Feature",geometry:{type:"Point",coordinates:[o,a]},properties:l};i.push(u)}return i},isXField(e){var t=e.toLowerCase();return"x"===t||"smx"===t||"jd"===t||"经度"===t||"东经"===t||"longitude"===t||"lot"===t||"lon"===t||"lng"===t||"x坐标"===t},isYField(e){var t=e.toLowerCase();return"y"===t||"smy"===t||"wd"===t||"纬度"===t||"北纬"===t||"latitude"===t||"lat"===t||"y坐标"===t},string2Csv(e,t){let r=e.split("\n"),s={};s.colTitles=t?[]:r[0].split(","),s.rows=[];for(let e=t?0:1;e<r.length;e++)r[e]&&s.rows.push(r[e].split(","));return s}};s.Widgets.FileReaderUtil=ke;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class He{constructor(e){this.datasets=e,this.EVENT_TYPES=["getdatafailed"],this.events=new p(this,null,this.EVENT_TYPES)}getDatasetInfo(e){let t=this.datasets.url,r=this;N.get(t).then(function(e){return e.json()}).then(function(t){if(t.datasetInfo){let s=t.datasetInfo;r.datasetsInfo={dataSourceName:s.dataSourceName,datasetName:s.name,mapName:t.name},e({result:r.datasetsInfo})}}).catch(function(e){console.log(e),r._fireFailedEvent(e)})}getDataFeatures(e,t){let r,n,i,o=e.result,a={name:o.datasetName+"@"+o.dataSourceName};Object.assign(a,this.datasets.queryInfo),r=new s.FilterParameter(a),n=new s.GetFeaturesBySQLParameters({queryParameter:r,datasetNames:[o.dataSourceName+":"+o.datasetName],fromIndex:0,toIndex:1e5}),(i=new s.GetFeaturesBySQLService(o.dataUrl,{eventListeners:{processCompleted:t,processFailed:function(){}}})).processAsync(n)}getLayerFeatures(e,t){let r,n,i,o=e.result,a={name:o.mapName};Object.assign(a,this.datasets.queryInfo),r=new s.FilterParameter(a),n=new s.QueryBySQLParameters({queryParams:[r],expectCount:1e5}),(i=new s.QueryBySQLService(o.dataUrl,{eventListeners:{processCompleted:t,processFailed:function(){}}})).processAsync(n)}getDataInfoByIptl(e){this.getServiceInfo(this.datasets.url,e)}getServiceInfo(e,t){let r=this;N.get(e,null,{withCredentials:this.datasets.withCredentials}).then(e=>e.json()).then(s=>{if(!1!==s.succeed)if(s.dataItemServices&&s.dataItemServices.length>0){let n;s.dataItemServices.forEach(s=>{if("RESTDATA"===s.serviceType&&"PUBLISHED"===s.serviceStatus)n=s;else{if("RESTMAP"!==s.serviceType||"PUBLISHED"!==s.serviceStatus)return void r.getDatafromContent(e,t);n=s}}),n&&r.getDatafromRest(n.serviceType,n.address,t)}else r.getDatafromContent(e,t);else r._fireFailedEvent(s)}).catch(e=>{console.log(e),r._fireFailedEvent(e)})}getDatafromContent(e,t){let r={result:{}},s=this;e+="/content.json?pageSize=9999999&currentPage=1",N.get(e,null,{withCredentials:this.datasets.withCredentials}).then(e=>e.json()).then(e=>{if(!1!==e.succeed){if(e.type){if("JSON"===e.type||"GEOJSON"===e.type){if(e.content=JSON.parse(e.content.trim()),!e.content.features)return void console.log(Ge.i18n("msg_jsonResolveFiled"));let t=this._formatGeoJSON(e.content);r.result.features={type:e.content.type,features:t}}else if("EXCEL"===e.type||"CSV"===e.type){let t=this._excelData2Feature(e.content);r.result.features={type:"FeatureCollection",features:t}}t(r,"content")}}else s._fireFailedEvent(e)},this).catch(e=>{console.log(e),s._fireFailedEvent(e)})}getDatafromRest(e,t,r){let s=this,n=this.datasets.withCredentials;if("RESTDATA"===e){let e,i,o=`${t}/data/datasources`;N.get(o,null,{withCredentials:n}).then(e=>e.json()).then(a=>{e=a.datasourceNames[0],o=`${t}/data/datasources/${e}/datasets`,N.get(o,null,{withCredentials:n}).then(e=>e.json()).then(n=>(i=n.datasetNames[0],s.getDatafromRestData(`${t}/data`,[e+":"+i],r),[e+":"+i])).catch(function(e){s._fireFailedEvent(e)})}).catch(function(e){s._fireFailedEvent(e)})}else{let e,i,o,a=`${t}/maps`;N.get(a,null,{withCredentials:n}).then(e=>e.json()).then(l=>{e=l[0].name,o=l[0].path,a=a=`${t}/maps/${e}/layers`,N.get(a,null,{withCredentials:n}).then(e=>e.json()).then(e=>(i=e[0].subLayers.layers[0].caption,s.getDatafromRestMap(i,o,r),i)).catch(function(e){s._fireFailedEvent(e)})}).catch(function(e){s._fireFailedEvent(e)})}}getDatafromRestData(e,t,r){let s=this;this.datasets.queryInfo.attributeFilter=this.datasets.queryInfo.attributeFilter||"SmID>0",this._getFeatureBySQL(e,t,this.datasets.queryInfo,e=>{r(e,"RESTDATA")},e=>{console.log(e),s._fireFailedEvent(e)})}getDatafromRestMap(e,t,r){let s=this;this.datasets.queryInfo.attributeFilter=this.datasets.queryInfo.attributeFilter||"smid=1",this._queryFeatureBySQL(t,e,this.datasets.queryInfo,null,null,e=>{r(e,"RESTMAP")},e=>{console.log(e),s._fireFailedEvent(e)})}_getFeatureBySQL(e,t,r,s,n){let i,o,a,l={name:t.join().replace(":","@")};Object.assign(l,r),i=new ie(l),a=new oe({queryParameter:i,datasetNames:t,fromIndex:0,toIndex:1e5,returnContent:!0}),(o=new Oe(e,{eventListeners:{processCompleted:e=>{s&&s(e)},processFailed:e=>{n&&n(e)}}})).processAsync(a)}_queryFeatureBySQL(e,t,r,s,n,i,o,a,l,u){var h,c,p={name:t};Object.assign(p,r),h=new ie(p),s&&(h.fields=s);var d={queryParams:[h]};u&&(d.queryOption=x.ATTRIBUTE),a&&(d.startRecord=a),l&&(d.expectCount=l),n&&(d.prjCoordSys={epsgCode:n}),c=new De(d),this._queryBySQL(e,c,e=>{"processCompleted"===e.type?i(e):o(e)})}_queryBySQL(e,t,r,s){new Ue(e,{eventListeners:{scope:this,processCompleted:r,processFailed:r},format:this._processFormat(s)}).processAsync(t)}_processFormat(e){return e||_.GEOJSON}_formatGeoJSON(e){let t=e.features;return t.forEach((e,t)=>{e.properties.index=t}),t}_excelData2Feature(e){let t=e.colTitles,r=-1,s=-1;for(let e=0,n=t.length;e<n;e++)ke.isXField(t[e])&&(r=e),ke.isYField(t[e])&&(s=e);let n=[];for(let t=0,i=e.rows.length;t<i;t++){let i=e.rows[t],o=Number(i[r]),a=Number(i[s]),l={};for(let r in e.colTitles){l[e.colTitles[r]]=e.rows[t][r]}l.index=t+"";let u={type:"Feature",geometry:{type:"Point",coordinates:[o,a]},properties:l};n.push(u)}return n}_fireFailedEvent(e){let t=e?{error:e,message:Ge.i18n("msg_getdatafailed")}:{message:Ge.i18n("msg_getdatafailed")};this.events.triggerEvent("getdatafailed",t)}}
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/class Ve{constructor(e){this.datasets=e.datasets,this.xField=[],this.yField=[],this.grid={top:"50px",bottom:"50px",left:"50px",right:"60px"},this.chartType=e.type||"bar",this._initXYField(e.chartOptions),this.EVENT_TYPES=["getdatafailed"],this.events=new p(this,null,this.EVENT_TYPES)}_initXYField(e){let t=this;e&&e.length>0&&e.forEach(function(e){e.xAxis&&t.xField.push({field:e.xAxis.field,name:e.xAxis.name}),e.yAxis&&t.yField.push({field:e.yAxis.field,name:e.yAxis.name})})}getDatasetInfo(e){this.createChart=e,this.datasets&&this._checkUrl(this.datasets.url)&&(this.chartModel=new He(this.datasets),"iServer"===this.datasets.type?this.chartModel.getDatasetInfo(this._getDatasetInfoSuccess.bind(this)):"iPortal"===this.datasets.type&&this.chartModel.getDataInfoByIptl(this._getDataInfoSuccess.bind(this)),this.chartModel.events.on({getdatafailed:e=>{this.events.triggerEvent("getdatafailed",e)}}))}_getDatasetInfoSuccess(e){let t=this.datasets.url,r=t.indexOf("rest");if(r>0){let s=t.indexOf("/",r+5),n=t.substring(r+5,s),i=t.substring(0,r+4)+"/data";if("maps"===n){let n=t.indexOf("/",s+1),o=t.substring(s+1,n);i=t.substring(0,r+4)+"/maps/"+o,e.result.dataUrl=i,this._getLayerFeatures(e)}else"data"===n&&(e.result.dataUrl=i,this._getDataFeatures(e))}}_getDataInfoSuccess(e,t){let r=this;"RESTMAP"===t?r._getChartDatasFromLayer(e):r._getChartDatas(e)}_getDataFeatures(e){this.chartModel.getDataFeatures(e,this._getChartDatas.bind(this))}_getLayerFeatures(e){this.chartModel.getLayerFeatures(e,this._getChartDatasFromLayer.bind(this))}_getChartDatas(e){if(e){this.features=e.result.features;let t=this.features.features,r={};if(t.length){let e=t[0],s=[],n=[];for(let t in e.properties)s.push(t),n.push(this._getDataType(e.properties[t]));r={features:t,fieldCaptions:s,fieldTypes:n,fieldValues:[]};for(let e in n){let s=[];for(let n in t){let i=t[n],o=r.fieldCaptions[e],a=i.properties[o];s.push(a)}r.fieldValues.push(s)}this.createChart(r)}}}_getChartDatasFromLayer(e){if(e.result.recordsets){let t=e.result.recordsets[0],r=t.features.features;this.features=t.features;let s={};if(r.length){s={features:t.features,fieldCaptions:t.fieldCaptions,fieldTypes:t.fieldTypes,fieldValues:[]};for(let e in s.fieldCaptions){let t=[];for(let n in r){let i=r[n],o=s.fieldCaptions[e],a=i.properties[o];t.push(a)}s.fieldValues.push(t)}this.createChart(s)}}}_createChartOptions(e){return this.calculatedData=this._createChartDatas(e),this.updateChartOptions(this.chartType)}changeType(e){if(e!==this.chartType)return this.chartType=e,this.updateChartOptions(this.chartType)}updateData(e,t,r){this.updateChart=r,this.xField=[],this.yField=[],this._initXYField(t),e.type=e.type||"iServer",e.withCredentials=e.withCredentials||!1,this.datasets=e,this.getDatasetInfo(this._updateDataSuccess.bind(this))}_updateDataSuccess(e){let t=this._createChartOptions(e);this.updateChart(t)}updateChartOptions(e,t){if(this.calculatedData){let r=this.grid,s=this._createChartSeries(this.calculatedData,e),n=[];for(let e in this.calculatedData.XData)n.push({value:this.calculatedData.XData[e].fieldsData});let i={type:"category",name:this.xField[0].name||"X",data:n,nameTextStyle:{color:"#fff",fontSize:14},splitLine:{show:!1},axisLine:{lineStyle:{color:"#eee"}}},o={type:"value",name:this.yFieldName||"Y",data:{},nameTextStyle:{color:"#fff",fontSize:14},splitLine:{show:!1},axisLine:{lineStyle:{color:"#eee"}}},a={formatter:"{b0}: {c0}"},l="#404a59";return t&&(t.grid&&(r=t.grid),t.tooltip&&(a=t.tooltip),t.backgroundColor&&(l=t.backgroundColor)),{backgroundColor:l,grid:r,series:s,xAxis:i,yAxis:o,tooltip:a}}}_createChartDatas(e){let t=0,r=[],s=e.fieldCaptions,n=this;s.forEach(function(e,r){n.xField[0]&&e===n.xField[0].field&&(t=r)}),this.yFieldName="",this.yField.forEach(function(e,t){0!==t&&(n.yFieldName=n.yFieldName+","),n.yFieldName=n.yFieldName+e.name,s.forEach(function(t,s){t===e.field&&r.push(s)})});let i=this._getAttrData(e,t),o=[];if(r.length>0)r.forEach(function(t){let r=[];for(let s in e.fieldValues[t])r.push({value:e.fieldValues[t][s]});o.push(r)});else{let e=[],t=[],r=i.length;for(let s=0;s<r;s++){let r=!1;for(let n=0,o=t.length;n<o;n++)if(i[s].fieldsData===t[n].fieldsData){e[n].value++,t[n].recordIndexs.push(s),r=!0;break}r||i[s].fieldsData&&(t.push({fieldsData:i[s].fieldsData,recordIndexs:[s]}),e.push({value:1}))}i=t,o=[e]}return{XData:i,YData:o}}_getAttrData(e,t){0===t&&(this.xField=[{field:e.fieldCaptions[t],name:e.fieldCaptions[t]}]);let r=[];for(let s=0,n=e.fieldValues[t].length;s<n;s++){let n=e.fieldValues[t][s];r.push({recordIndexs:s,fieldsData:n})}return r}_createChartSeries(e,t){let r=[];return e.YData.forEach(function(e){let s=0,n=[];for(let t of e)s=t.value,n.push({value:s});let i={type:t,data:n,name:"y"};r.push(i)}),r}_isDate(e){return/((^((1[8-9]\d{2})|([2-9]\d{3}))([-\/\._])(10|12|0?[13578])([-\/\._])(3[01]|[12][0-9]|0?[1-9])$)|(^((1[8-9]\d{2})|([2-9]\d{3}))([-\/\._])(11|0?[469])([-\/\._])(30|[12][0-9]|0?[1-9])$)|(^((1[8-9]\d{2})|([2-9]\d{3}))([-\/\._])(0?2)([-\/\._])(2[0-8]|1[0-9]|0?[1-9])$)|(^([2468][048]00)([-\/\._])(0?2)([-\/\._])(29)$)|(^([3579][26]00)([-\/\._])(0?2)([-\/\._])(29)$)|(^([1][89][0][48])([-\/\._])(0?2)([-\/\._])(29)$)|(^([2-9][0-9][0][48])([-\/\._])(0?2)([-\/\._])(29)$)|(^([1][89][2468][048])([-\/\._])(0?2)([-\/\._])(29)$)|(^([2-9][0-9][2468][048])([-\/\._])(0?2)([-\/\._])(29)$)|(^([1][89][13579][26])([-\/\._])(0?2)([-\/\._])(29)$)|(^([2-9][0-9][13579][26])([-\/\._])(0?2)([-\/\._])(29)$))/gi.test(e)}_isNumber(e){let t=Number(e);return 0===t||!isNaN(t)}_getDataType(e){if(null!==e&&void 0!==e&&""!==e){if(this._isDate(e))return"DATE";if(this._isNumber(e))return"NUMBER"}return"STRING"}_checkUrl(e){let t;return t=!(""===e||!this._isMatchUrl(e))&&(!/^http[s]?:\/\/localhost/.test(e)&&!/^http[s]?:\/\/127.0.0.1/.test(e))}_isMatchUrl(e){return new RegExp("(https?|http|file|ftp)://[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]").test(e)}getStyle(){return{grid:this.grid,tooltip:this.tooltip,backgroundColor:this.backgroundColor}}getFeatures(){return this.features}setStyle(e){return this.updateChartOptions(this.chartType,e)}}s.Widgets.ChartViewModel=Ve;s.Widgets.Chart=
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class{constructor(e,t){this.domID=e,this.chartType=t.type||"bar",t.datasets.type=t.datasets.type||"iServer",t.datasets.withCredentials=t.datasets.withCredentials||!1,this.viewModel=new Ve(t),this._fillDataToView()}onAdd(e){this.addChart=e}_fillDataToView(){let e=new te;this.viewModel.getDatasetInfo(this._createChart.bind(this)),this.viewModel.events.on({getdatafailed:t=>{e.showView(t.message)}})}getStyle(){return this.viewModel.getStyle()}getFeatures(){return this.viewModel.getFeatures()}setStyle(e){let t=this.viewModel.setStyle(e);this._updateChart(t)}changeType(e){if(this.chartType!==e){this.chartType=e;let t=this.viewModel.changeType(e);this._updateChart(t)}}updateData(e,t){let r=this;this.viewModel.updateData(e,t,function(e){r._updateChart(e),r.addChart&&r.addChart()})}_createChart(e){this.echart=se.a.init(document.getElementById(this.domID),null,{renderer:"canvas"});let t=this.viewModel._createChartOptions(e);this.echart.setOption(t),this.addChart&&this.addChart()}_updateChart(e){this.echart&&(this.echart.clear(),this.echart.setOption(e))}};
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at/r* http://www.apache.org/licenses/LICENSE-2.0.html.*/
class je{constructor(e){e=e||{},this.id=e.id?e.id:null,this.rootContainer=null}getElement(){return this.id&&(this.rootContainer.id=this.id),this.rootContainer}_initView(){}showView(){this.rootContainer.hidden=!1}closeView(){this.rootContainer.hidden=!0}}s.Widgets.TemplateBase=je;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class qe extends je{constructor(e){super(e);let t=e.title?e.title:"";this._initView(t)}_initView(e){const t=document.createElement("div");t.setAttribute("class","widget-container");const r=document.createElement("div");r.setAttribute("class","widget-title");const s=document.createElement("div");s.innerHTML=e,r.appendChild(s),t.appendChild(r);const n=document.createElement("div");return n.setAttribute("class","widget-content"),t.appendChild(n),this.content=n,this.rootContainer=t,t}getContentElement(){return this.content}appendContent(e){this.content.appendChild(e)}}s.Widgets.CommonContainer=qe;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class We extends je{constructor(e){super(e),this._initView(e)}_initView(e){let t=this._createElement("div","widget-selecttool");if(e.labelName){this._createElement("label","widget-selecttool__lable--describe",t).innerHTML=e.labelName}let r=this._createElement("div","widget-selecttool--chart",t);r.setAttribute("tabindex","1");let s=this._createElement("div","widget-selecttool__name",r);s.title=e.optionsArr[0],s.innerHTML=e.optionsArr[0];let n=this._createElement("div","widget-selecttool__trianglebtn--chart",r),i=this._createElement("div","widget-triangle-down-img",n),o=this._createElement("div","widget-selecttool__content",r),a=this._createElement("div","widget-selecttool__content--chart",o),l=this._createElement("div","widget-selecttool__scrollarea__content",a);l.setAttribute("tabindex","1"),this.createOptions(l,e.optionsArr),this.optionClickEvent(l,s,e.optionsClickCb),this._selectClickEvent(r,o,i),this.rootContainer=t}createOptions(e,t){for(let r in t){let s=this._createElement("div","widget-selecttool__option",e);s.title=t[r],s.innerHTML=t[r]}}_selectClickEvent(e,t,r){e.onclick=function(e){"block"===t.style.display?(t.style.display="none",r.className="widget-triangle-down-img"):(t.style.display="block",r.className="triangle-up-img"),e.preventDefault(),e.stopPropagation()},e.onmousedown=function(e){e.target!==this&&(this.focus(),e.preventDefault(),e.stopPropagation())},e.onblur=function(){t.style.display="none",r.className="widget-triangle-down-img"}}_createElement(e,t,r){let s=document.createElement(e||"div");return t&&(s.className=t),r&&r.appendChild(s),s}optionClickEvent(e,t,r){for(let s=0;s<e.children.length;s++){let n=e.children[s];n.onclick=function(){t.innerHTML=n.innerHTML,t.title=n.title,n.getAttribute("data-value")&&t.setAttribute("data-value",n.getAttribute("data-value")),r&&r(n)}}}}s.Widgets.Select=We;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Ke extends je{constructor(e){super(e),this._initView(e)}_initView(e){let t=document.createElement("div");t.className="widget-dropdownbox--container";let r=document.createElement("div");r.setAttribute("tabindex","1"),r.className="widget-dropdownbox",t.appendChild(r);let s=document.createElement("div");r.appendChild(s),this._createDropDownOption(e[0],s);let n=document.createElement("div");n.className="widget-dropdownbox__triangle-btn",r.appendChild(n);let i=document.createElement("div");i.className="widget-triangle-down-img",n.appendChild(i);let o={parentEle:r,dropDownContent:["widget-dropdownbox__content widget-dropdownbox__content--chart","dropDownContent"],scrollareaContent:"widget-selecttool__scrollarea__content",optionsArr:e,triangleBtn:i,dropDownTopContainer:s};this._createDropDownBox(o),this.rootContainer=t}_createDropDownBox(e){let t=e.parentEle,r=e.dropDownTopContainer,s=document.createElement("div");s.className=e.dropDownContent[0],t.appendChild(s);let n=document.createElement("div");n.className=e.scrollareaContent,s.appendChild(n);let i=e.optionsArr;for(let e=0;e<i.length;e++)this._createDropDownOption(i[e],n);let o=e.triangleBtn;this._dropDownClickEvent(t,s,o),this._eleOnblur(t,s,o);let a=n.children;for(let e=0;e<a.length;e++)a[e].onclick=function(){r.innerHTML=a[e].outerHTML}}_createDropDownOption(e,t){let r=document.createElement("div");r.className="widget-dropdownbox__item";let s=e;s.dataValue&&r.setAttribute("data-value",s.dataValue),t.appendChild(r);let n=document.createElement("div");n.className="widget-dropdownbox__item__img",r.appendChild(n);let i=document.createElement("div");s.icon.className&&(i.className=s.icon.className),s.icon.background&&(i.style.background=s.icon.background),n.appendChild(i);let o=document.createElement("div");o.className="widget-dropdownbox__item__title",o.title=s.title,o.innerHTML=s.title,r.appendChild(o);let a=document.createElement("div");a.className="widget-dropdownbox__item__remark",a.title=s.remark,a.innerHTML=s.remark,r.appendChild(a)}_dropDownClickEvent(e,t,r){e.onclick=function(e){"block"===t.style.display?(t.style.display="none",r.className="widget-triangle-down-img"):(t.style.display="block",r.className="triangle-up-img"),e.preventDefault(),e.stopPropagation()},e.onmousedown=function(e){e.target!==this&&(this.focus(),e.preventDefault(),e.stopPropagation())}}_eleOnblur(e,t,r){e.onblur=function(){t.style.display="none",r.className="widget-triangle-down-img"}}_createElement(e,t,r){let s=document.createElement(e||"div");return t&&(s.className=t),r&&r.appendChild(s),s}}s.Widgets.DropDownBox=Ke;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Ye extends je{constructor(e){super(e=e||{}),e.title=e.title?e.title:"",this._initView(e.title)}_initView(e){const t=document.createElement("div");t.setAttribute("class","widget-popcontainer");const r=document.createElement("div");r.setAttribute("class","widget-popcontainer__header");const s=document.createElement("label");s.setAttribute("class","widget-popcontainer__header__title"),s.innerHTML=e,r.appendChild(s);const n=document.createElement("span");n.setAttribute("class","supermapol-icons-clear widget-popcontainer__header__close"),n.onclick=this.closeView.bind(this),t.appendChild(n),t.appendChild(r);const i=document.createElement("div");i.setAttribute("class","widget-popcontainer__content"),this.content=i,t.appendChild(i),this.rootContainer=t}appendContent(e){this.content.appendChild(e)}}s.Widgets.PopContainer=Ye;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Qe extends Ye{constructor(e){e.title=e.title?e.title:"属性",super(e),this.rootContainer.firstChild.hidden=!0,e.attributes=e.attributes?e.attributes:[],this._createAttributesTable(e.attributes)}_createAttributesTable(e){const t=document.createElement("table");t.setAttribute("class","widget-popcontainer__content__table");const r=document.createElement("tbody");let s=!0;for(let t in e){const n=document.createElement("tr");s&&n.setAttribute("class","widget-popcontainer__content__td--color");const i=document.createElement("td"),o=document.createElement("Span");o.innerHTML=t,i.appendChild(o);const a=document.createElement("td");a.innerHTML=e[t],n.appendChild(i),n.appendChild(a),r.appendChild(n),s=!s}t.appendChild(r),this.appendContent(t)}}s.Widgets.AttributesPopContainer=Qe;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Xe extends je{constructor(e){super(e),this._initView()}_initView(){const e=document.createElement("div");e.setAttribute("class","widget-tabpage");const t=document.createElement("ul");this.header=t;const r=document.createElement("div");r.setAttribute("class","widget-tabpage__content"),this.content=r,e.appendChild(t),e.appendChild(r),this.rootContainer=e}setTabs(e){this.removeAllTabs(),this.appendTabs(e)}appendTabs(e){for(let t=0;t<e.length;t++){let r=document.createElement("span");r.index=t,r.appendChild(document.createTextNode(e[t].title)),r.onclick=this._changeTabsPage.bind(this);let s=e[t].content;s.index=t,s.hidden=!0,this.header.appendChild(r),this.content.appendChild(s)}this.header.firstChild.setAttribute("class","on"),this.content.firstChild.hidden=!1}removeTab(e){this.header.removeChild(this.header.children[e]),this.content.removeChild(this.content.children[e])}removeAllTabs(){for(let e=this.header.children.length;e>0;e--)this.header.removeChild(this.header.children[e]),this.content.removeChild(this.content.children[e])}_changeTabsPage(e){const t=e.target.index;for(let e=0;e<this.header.children.length;e++)this.header.children[e].setAttribute("class",""),this.content.children[e].hidden=!0,e===t&&(this.header.children[e].setAttribute("class","on"),this.content.children[e].hidden=!1)}}s.Widgets.IndexTabsPageContainer=Xe;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ze extends Xe{constructor(e){super(e),this.rootContainer.classList.add("widget-citytabpage--noneBoxShadow"),this.config=e.config,h.isArray(this.config)?(this.header.hidden=!0,this._createCityItem("城市",this.config),this.content.style.border="none"):(this._createTabs(),this.header.onclick=(e=>{for(let e=0;e<this.header.children.length;e++)this.header.children[e].setAttribute("class","");e.target.setAttribute("class","on"),this._createCityContent(e.target.innerHTML)}))}_createTabs(){if(h.isArray(this.config))for(let e=0;e<this.config.length;e++){let t="";for(const r in this.config[e])t+=r;let r=document.createElement("li");r.innerHTML=t,this.header.appendChild(r)}else for(const e in this.config){let t=document.createElement("li");t.innerHTML=e,this.header.appendChild(t)}this.header.firstChild.setAttribute("class","on"),this._createCityContent(this.header.firstChild.innerHTML)}_createCityContent(e){for(let e=this.content.children.length;e>0;e--)this.content.removeChild(this.content.children[e-1]);const t=this.config[e];for(let e in t)this._createCityItem(e,t[e])}_createCityItem(e,t){const r=document.createElement("div"),s=document.createElement("div");s.setAttribute("class","widget-citytabpag__py-key"),s.innerHTML=e,r.appendChild(s);const n=document.createElement("div");n.setAttribute("class","widget-citytabpag__content");for(let e=0;e<t.length;e++){let r=document.createElement("span");r.innerHTML=t[e],n.appendChild(r)}"HOT"===e&&(n.style.width="428px"),r.appendChild(n),this.content.appendChild(r)}}s.Widgets.CityTabsPage=ze;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class $e extends je{constructor(e){super(e),this.navTabsTitle=null,this.navTabsContent=null,e.tabs=e.tabs?e.tabs:[],this._initView(e.tabs)}_initView(e){const t=document.createElement("div");t.setAttribute("class","widget-navtabspage");const r=document.createElement("span");r.setAttribute("class","supermapol-icons-close"),r.onclick=this.closeView.bind(this),t.appendChild(r);const s=document.createElement("div");this.navTabsTitle=s,s.setAttribute("class","widget-navtabspage__title"),t.appendChild(s);const n=document.createElement("div");this.navTabsContent=n,n.setAttribute("class","widget-navtabspage__content"),t.appendChild(n),e.length>0&&this.appendTabs(e),this.rootContainer=t}setTabs(e){this.removeAllTabs(),this.appendTabs(e)}appendTabs(e){for(let t=0;t<e.length;t++){let r=document.createElement("span");r.index=t,r.appendChild(document.createTextNode(e[t].title)),r.onclick=this._changeTabsPage.bind(this);let s=e[t].content;s.index=t,s.hidden=!0,this.navTabsTitle.appendChild(r),this.navTabsContent.appendChild(s)}this.navTabsTitle.firstChild.setAttribute("class","widget-navtabspage__tabs--select"),this.navTabsContent.firstChild.hidden=!1}removeTab(e){this.navTabsTitle.removeChild(this.navTabsTitle.children[e]),this.navTabsContent.removeChild(this.navTabsContent.children[e])}removeAllTabs(){for(let e=this.navTabsTitle.children.length;e>0;e--)this.navTabsTitle.removeChild(this.navTabsTitle.children[e]),this.navTabsContent.removeChild(this.navTabsContent.children[e])}_changeTabsPage(e){const t=e.target.index;for(let e=0;e<this.navTabsTitle.children.length;e++)this.navTabsTitle.children[e].setAttribute("class",""),this.navTabsContent.children[e].hidden=!0,e===t&&(this.navTabsTitle.children[e].setAttribute("class","widget-navtabspage__tabs--select"),this.navTabsContent.children[e].hidden=!1)}}s.Widgets.NavTabsPage=$e;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Ze extends je{constructor(e){super(e=e||{}),this.currentPage=0,this.pageNumberLis=[],this.currentPageNumberLis=[],this.linkageEvent=null,e.contents=e.contents?e.contents:null,e.pageCounts=e.pageCounts?e.pageCounts:0,this._initView(e.contents,e.pageCounts)}setLinkageEvent(e){this.linkageEvent=e}_initView(e,t){const r=document.createElement("div");r.setAttribute("class","widget-pagination");const s=document.createElement("div");s.setAttribute("class","widget-pagination__content"),r.appendChild(s),this.content=s;const n=document.createElement("ul");n.setAttribute("class","widget-pagination__link"),n.onclick=this._changePageEvent.bind(this),r.appendChild(n),this._createLink(n),this.link=n,e&&this.setContent(e),0!==t&&this.setPageLink(t),this.rootContainer=r}setContent(e){this.clearContent(),this.appendContent(e)}appendContent(e){this.content.appendChild(e)}clearContent(){for(let e=this.content.children.length-1;e>=0;e--)this.content.removeChild(this.content.children[e])}setPageLink(e){this.pageNumberLis=[],this.currentPageNumberLis=[],this.clearPageLink(),this._createPageLi(e),this._appendPageLink()}_createPageLi(e){for(let t=0;t<e;t++){const e=document.createElement("li");e.innerHTML=t+1,this.pageNumberLis.push(e)}if(this.pageNumberLis[0].setAttribute("class","active"),this.currentPage=1,e<5)this.currentPageNumberLis=this.pageNumberLis;else for(let e=0;e<5;e++)this.currentPageNumberLis.push(this.pageNumberLis[e])}_appendPageLink(){for(let e=0;e<this.currentPageNumberLis.length;e++)this.link.insertBefore(this.currentPageNumberLis[e],this.link.childNodes[this.link.children.length-2]);for(let e=0;e<this.currentPageNumberLis.length;e++)this.currentPageNumberLis[e].setAttribute("class",""),Number(this.currentPageNumberLis[e].innerHTML)===this.currentPage&&this.currentPageNumberLis[e].setAttribute("class","active");this._changeDisableState(),this.linkageEvent&&this.linkageEvent(this.currentPage)}clearPageLink(){for(let e=this.link.children.length-3;e>1;e--)this.link.removeChild(this.link.children[e])}_createLink(e){for(let t=0;t<4;t++){const r=document.createElement("li");r.setAttribute("class","disable");const s=document.createElement("span");r.appendChild(s),0===t?(s.id="first",s.setAttribute("class","supermapol-icons-first")):1===t?(s.id="prev",s.setAttribute("class","supermapol-icons-prev")):2===t?(s.id="next",s.setAttribute("class","supermapol-icons-next")):3===t&&(s.id="last",s.setAttribute("class","supermapol-icons-last")),e.appendChild(r)}}_changePageEvent(e){const t=e.target;if("disable"===t.parentElement.classList[0])return;let r;if(t.id)r=t.id;else{if(!Number(t.innerHTML))return;r=Number(t.innerHTML)}this._prePageNum(r),this.clearPageLink(),this._appendPageLink()}_changeDisableState(){this.link.children[0].setAttribute("class",""),this.link.children[1].setAttribute("class",""),this.link.children[this.link.children.length-1].setAttribute("class",""),this.link.children[this.link.children.length-2].setAttribute("class",""),1===this.currentPage&&(this.link.children[0].setAttribute("class","disable"),this.link.children[1].setAttribute("class","disable")),this.currentPage===this.pageNumberLis.length&&(this.link.children[this.link.children.length-1].setAttribute("class","disable"),this.link.children[this.link.children.length-2].setAttribute("class","disable"))}_prePageNum(e){const t=[];if(this.currentPage="first"===e?1:"last"===e?this.pageNumberLis.length:"prev"===e?this.currentPage-1:"next"===e?this.currentPage+1:e,this.pageNumberLis.length<=5)for(let e=0;e<this.pageNumberLis.length;e++)t.push(this.pageNumberLis[e]);else if(this.currentPage<=3)for(let e=0;e<5;e++)t.push(this.pageNumberLis[e]);else if(this.currentPage>=this.pageNumberLis.length-3)for(let e=this.pageNumberLis.length-5;e<this.pageNumberLis.length;e++)t.push(this.pageNumberLis[e]);else for(let e=this.currentPage-3;e<=this.currentPage+1;e++)t.push(this.pageNumberLis[e]);t.length>0&&(this.currentPageNumberLis=t)}}s.Widgets.PaginationContainer=Ze;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
let et={getFileType:e=>/^.*\.(?:xls|xlsx)$/i.test(e)?$.EXCEL:/^.*\.(?:csv)$/i.test(e)?$.CSV:/^.*\.(?:geojson|json)$/i.test(e)?$.GEOJSON:null};
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/var tt=window.SuperMap=window.SuperMap||{};tt.REST=tt.REST||{};var rt=r(0),st=rt.baiduMapLayer?rt.baiduMapLayer.__proto__:Function;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/class nt extends st{constructor(e,t,r,s){if(super(e,r,s),!st)return this;s=s||{},this.init(s),this.argCheck(s),this.canvasLayer=t,this.clickEvent=this.clickEvent.bind(this),this.mousemoveEvent=this.mousemoveEvent.bind(this),this.bindEvent()}clickEvent(e){var t=e.xy;super.clickEvent(t,e)}mousemoveEvent(e){var t=e.xy;super.mousemoveEvent(t,e)}bindEvent(){var e=this.map;this.options.methods&&(this.options.methods.click&&e.events.on({click:this.clickEvent}),this.options.methods.mousemove&&e.events.on({mousemove:this.mousemoveEvent}))}unbindEvent(){var e=this.map;this.options.methods&&(this.options.methods.click&&e.events.un({click:this.clickEvent}),this.options.methods.mousemove&&e.events.un({mousemove:this.mousemoveEvent}))}getContext(){return this.canvasLayer&&this.canvasLayer.canvasContext}addData(e,t){var r=e;e&&e.get&&(r=e.get()),this.dataSet.add(r),this.update({options:t})}setData(e,t){var r=e;e&&e.get&&(r=e.get()),this.dataSet=this.dataSet||new rt.DataSet,this.dataSet.set(r),this.update({options:t})}getData(){return this.dataSet}removeData(e){if(this.dataSet){var t=this.dataSet.get({filter:function(t){return null==e||"function"!=typeof e||!e(t)}});this.dataSet.set(t),this.update({options:null})}}clearData(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}render(e){this._canvasUpdate(e)}transferToMercator(){if(this.options.coordType&&["bd09mc","coordinates_mercator"].indexOf(this.options.coordType)>-1){var e=this.dataSet.get();e=this.dataSet.transferCoordinate(e,function(e){var t=tt.Projection.transform({x:e[0],y:e[1]},"EPSG:3857","EPSG:4326");return[t.x,t.y]},"coordinates","coordinates"),this.dataSet._set(e)}}_canvasUpdate(e){if(this.canvasLayer){var t=this.options.animation,r=this.getContext(),s=this.map;if(this.isEnabledTime()){if(void 0===e)return void this.clear(r);"2d"===this.context&&(r.save(),r.globalCompositeOperation="destination-out",r.fillStyle="rgba(0, 0, 0, .1)",r.fillRect(0,0,r.canvas.width,r.canvas.height),r.restore())}else this.clear(r);if("2d"===this.context)for(var n in this.options)r[n]=this.options[n];else r.clear(r.COLOR_BUFFER_BIT);if(!(this.options.minZoom&&s.getZoom()<this.options.minZoom||this.options.maxZoom&&s.getZoom()>this.options.maxZoom)){var i=this.canvasLayer,o={fromColumn:"coordinates",transferCoordinate:function(e){var t={lon:e[0],lat:e[1]},r=s.getViewPortPxFromLonLat(t);return[r.x,r.y]}};void 0!==e&&(o.filter=function(r){var s=t.trails||10;return e&&r.time>e-s&&r.time<e});var a=this.dataSet.get(o);this.processData(a),this.options._size=this.options.size;var l=s.getViewPortPxFromLonLat(i.transferToMapLatLng({lon:0,lat:0})),u=Math.pow(2,14-s.getZoom());"m"==this.options.unit?(this.options.size&&(this.options._size=this.options.size/u),this.options.width&&(this.options._width=this.options.width/u),this.options.height&&(this.options._height=this.options.height/u)):(this.options._size=this.options.size,this.options._height=this.options.height,this.options._width=this.options.width),this.drawContext(r,a,this.options,l),this.options.updateCallback&&this.options.updateCallback(e)}}}init(e){this.options=e,this.initDataRange(e),this.context=this.options.context||"2d",this.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(this.options.zIndex),this.initAnimator()}addAnimatorEvent(){this.map.events.on({movestart:this.animatorMovestartEvent.bind(this)}),this.map.events.on({moveend:this.animatorMoveendEvent.bind(this)})}clear(e){e&&e.clearRect&&e.clearRect(0,0,e.canvas.width,e.canvas.height)}show(){this.map.addLayer(this.canvasLayer)}hide(){this.map.removeLayer(this.canvasLayer)}draw(){this.canvasLayer.redraw()}}
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/class it extends tt.Layer{constructor(e,t){if(super(e,t),this.dataSet=null,this.options=null,this.supported=!1,this.canvas=null,this.canvasContext=null,t&&tt.Util.extend(this,t),this.canvas=document.createElement("canvas"),this.canvas.getContext){this.supported=!0,this.canvas.style.position="absolute",this.canvas.style.top="0px",this.canvas.style.left="0px",this.div.appendChild(this.canvas);var r=this.options&&this.options.context||"2d";this.canvasContext=this.canvas.getContext(r);var s="undefined"==typeof window?{}:window,n=this.devicePixelRatio=s.devicePixelRatio;"2d"==this.options.context&&this.canvasContext.scale(n,n),this.attribution="© 2018 百度 <a href='http://mapv.baidu.com' target='_blank'>MapV</a> with <span>© <a target='_blank' href='http://iclient.supermap.io' style='color: #08c;text-decoration: none;'>SuperMap iClient</a></span>",this.CLASS_NAME="SuperMap.Layer.MapVLayer"}}destroy(){this.dataSet=null,this.options=null,this.renderer=null,this.supported=null,this.canvas=null,this.canvasContext=null,this.maxWidth=null,this.maxHeight=null,super.destroy()}addData(e,t){this.renderer&&this.renderer.addData(e,t)}setData(e,t){this.renderer&&this.renderer.setData(e,t)}getData(){return this.renderer&&(this.dataSet=this.renderer.getData()),this.dataSet}removeData(e){this.renderer&&this.renderer.removeData(e)}clearData(){this.renderer.clearData()}setMap(e){super.setMap(e),this.renderer=new nt(e,this,this.dataSet,this.options),this.supported?this.redraw():this.map.removeLayer(this)}moveTo(e,t,r){if(super.moveTo(e,t,r),this.supported){if(this.zoomChanged=t,!r){this.div.style.visibility="hidden",this.div.style.left=-parseInt(this.map.layerContainerDiv.style.left)+"px",this.div.style.top=-parseInt(this.map.layerContainerDiv.style.top)+"px";var s=this.map.getSize();this.div.style.width=parseInt(s.w)+"px",this.div.style.height=parseInt(s.h)+"px",this.canvas.width=parseInt(s.w),this.canvas.height=parseInt(s.h),this.canvas.style.width=this.div.style.width,this.canvas.style.height=this.div.style.height,this.maxWidth=s.w,this.maxHeight=s.h,this.div.style.visibility="",t||this.renderer&&this.renderer.render()}t&&this.renderer&&this.renderer.render()}}transferToMapLatLng(e){var t="EPSG:4326",r=this.map.getUnits()||"degree";return["m","meter"].indexOf(r.toLowerCase())>-1&&(t="EPSG:3857"),new tt.LonLat(e.lon,e.lat).transform("EPSG:4326",t)}}tt.Layer.MapVLayer=it;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ot extends he{constructor(e,t){super(e,t),this.CLASS_NAME="SuperMap.AddressMatchService"}destroy(){super.destroy()}code(e,t){t instanceof X&&this.processAsync(e,t)}decode(e,t){t instanceof z&&this.processAsync(e,t)}processAsync(e,t){var r=this;N.get(e,t,{proxy:r.proxy}).then(function(e){return e.json()}).then(function(e){e?r.serviceProcessCompleted(e):r.serviceProcessFailed(e)}).catch(function(e){r.eventListeners.processFailed({error:e})})}serviceProcessCompleted(e){super.serviceProcessCompleted(e)}serviceProcessFailed(e){super.serviceProcessFailed(e)}}s.AddressMatchService=ot;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class at extends he{constructor(e,t){super(e,t),this.CLASS_NAME="SuperMap.REST.AddressMatchService"}code(e,t){var r=this;new ot(r.url,{proxy:r.proxy,withCredentials:r.withCredentials,serverType:r.serverType,eventListeners:{scope:r,processCompleted:t,processFailed:t}}).code(r.url+"/geocoding",e)}decode(e,t){var r=this;new ot(r.url,{proxy:r.proxy,withCredentials:r.withCredentials,serverType:r.serverType,eventListeners:{scope:r,processCompleted:t,processFailed:t}}).decode(r.url+"/geodecoding",e)}}tt.REST.AddressMatchService=at;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class lt extends he{constructor(e,t){(t=t||{}).EVENT_TYPES=["processCompleted","processFailed","processRunning"],super(e,t),this.CLASS_NAME="SuperMap.ProcessingServiceBase"}destroy(){super.destroy()}getJobs(e){var t=this;N.get(t._processUrl(e),null,{proxy:t.proxy}).then(function(e){return e.json()}).then(function(e){t.events.triggerEvent("processCompleted",{result:e})}).catch(function(e){t.eventListeners.processFailed({error:e})})}addJob(e,t,r,s){var n=this,i=null;t&&t instanceof r&&(i=new Object,r.toObject(t,i));var o={proxy:n.proxy,headers:{"Content-Type":"application/x-www-form-urlencoded"},withCredentials:n.withCredentials,isInTheSameDomain:n.isInTheSameDomain};N.post(n._processUrl(e),JSON.stringify(i),o).then(function(e){return e.json()}).then(function(e){e.succeed?n.serviceProcessCompleted(e,s):n.serviceProcessFailed(e)}).catch(function(e){n.serviceProcessFailed({error:e})})}serviceProcessCompleted(e,t){e=h.transformResult(e),t=t||1e3;var r=this;if(e)var s=setInterval(function(){N.get(r._processUrl(e.newResourceLocation),{_t:(new Date).getTime()}).then(function(e){return e.json()}).then(function(e){r.events.triggerEvent("processRunning",{id:e.id,state:e.state}),"LOST"!==e.state.runState&&"KILLED"!==e.state.runState&&"FAILED"!==e.state.runState||(clearInterval(s),r.events.triggerEvent("processFailed",{error:e.state.errorMsg,state:e.state.runState})),"FINISHED"===e.state.runState&&e.setting.serviceInfo&&(clearInterval(s),r.events.triggerEvent("processCompleted",{result:e}))}).catch(function(e){clearInterval(s),r.events.triggerEvent("processFailed",{error:e})})},t)}serviceProcessFailed(e){super.serviceProcessFailed(e)}_processUrl(e){return-1===e.indexOf(".json")&&(e+=".json"),b.getToken(e)&&(e+="?token="+b.getToken(e)),e}}s.ProcessingServiceBase=lt;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ut extends lt{constructor(e,t){super(e,t),this.url+="/spatialanalyst/density",this.CLASS_NAME="SuperMap.KernelDensityJobsService"}destroy(){super.destroy()}getKernelDensityJobs(){super.getJobs(this.url)}getKernelDensityJob(e){super.getJobs(this.url+"/"+e)}addKernelDensityJob(e,t){super.addJob(this.url,e,H,t)}}s.KernelDensityJobsService=ut;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ht extends lt{constructor(e,t){super(e,t),this.url+="/spatialanalyst/query",this.CLASS_NAME="SuperMap.SingleObjectQueryJobsService"}destroy(){super.destroy()}getQueryJobs(){super.getJobs(this.url)}getQueryJob(e){super.getJobs(this.url+"/"+e)}addQueryJob(e,t){super.addJob(this.url,e,V,t)}}s.SingleObjectQueryJobsService=ht;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ct extends lt{constructor(e,t){super(e,t),this.url+="/spatialanalyst/aggregatepoints",this.CLASS_NAME="SuperMap.SummaryMeshJobsService"}destroy(){super.destroy()}getSummaryMeshJobs(){super.getJobs(this.url)}getSummaryMeshJob(e){super.getJobs(this.url+"/"+e)}addSummaryMeshJob(e,t){super.addJob(this.url,e,q,t)}}s.SummaryMeshJobsService=ct;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class pt extends lt{constructor(e,t){super(e,t),this.url+="/spatialanalyst/summaryregion",this.CLASS_NAME="SuperMap.SummaryRegionJobsService"}destroy(){super.destroy()}getSummaryRegionJobs(){super.getJobs(this.url)}getSummaryRegionJob(e){super.getJobs(this.url+"/"+e)}addSummaryRegionJob(e,t){super.addJob(this.url,e,W,t)}}s.SummaryRegionJobsService=pt;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class dt{constructor(e){e=e||{},this.datasetName="",this.datasetVectorClip="",this.geometryClip="",this.mode=O.CLIP,this.output=null,this.mappingParameters=null,h.extend(this,e),this.CLASS_NAME="SuperMap.VectorClipJobsParameter"}destroy(){this.datasetName=null,this.datasetVectorClip=null,this.geometryClip=null,this.mode=null,this.output instanceof J&&(this.output.destroy(),this.output=null),this.mappingParameters instanceof k&&(this.mappingParameters.destroy(),this.mappingParameters=null)}static toObject(e,t){for(var r in e)"datasetName"!==r?"output"!==r?(t.analyst=t.analyst||{},t.analyst[r]=e[r],"mappingParameters"===r&&(t.analyst[r]=t.analyst[r]||{},t.analyst.mappingParameters=e[r])):(t.output=t.output||{},t.output=e[r]):(t.input=t.input||{},t.input[r]=e[r])}}s.VectorClipJobsParameter=dt;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class mt extends lt{constructor(e,t){super(e,t),this.url+="/spatialanalyst/vectorclip",this.CLASS_NAME="SuperMap.VectorClipJobsService"}destroy(){super.destroy()}getVectorClipJobs(){super.getJobs(this.url)}getVectorClipJob(e){super.getJobs(this.url+"/"+e)}addVectorClipJob(e,t){super.addJob(this.url,e,dt,t)}}s.VectorClipJobsService=mt;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class ft extends lt{constructor(e,t){super(e,t),this.url+="/spatialanalyst/overlay",this.CLASS_NAME="SuperMap.OverlayGeoJobsService"}destroy(){super.destroy()}getOverlayGeoJobs(){super.getJobs(this.url)}getOverlayGeoJob(e){super.getJobs(this.url+"/"+e)}addOverlayGeoJob(e,t){super.addJob(this.url,e,K,t)}}s.OverlayGeoJobsService=ft;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class yt extends lt{constructor(e,t){super(e,t),this.url+="/spatialanalyst/buffers",this.CLASS_NAME="SuperMap.BuffersAnalystJobsService"}destroy(){super.destroy()}getBuffersJobs(){super.getJobs(this.url)}getBuffersJob(e){super.getJobs(this.url+"/"+e)}addBuffersJob(e,t){super.addJob(this.url,e,Y,t)}}s.BuffersAnalystJobsService=yt;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class gt extends lt{constructor(e,t){super(e,t),this.url+="/spatialanalyst/topologyvalidator",this.CLASS_NAME="SuperMap.TopologyValidatorJobsService"}destroy(){super.destroy()}getTopologyValidatorJobs(){super.getJobs(this.url)}getTopologyValidatorJob(e){super.getJobs(this.url+"/"+e)}addTopologyValidatorJob(e,t){super.addJob(this.url,e,Q,t)}}s.TopologyValidatorJobsService=gt;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Et extends lt{constructor(e,t){super(e,t),this.url+="/spatialanalyst/summaryattributes",this.CLASS_NAME="SuperMap.SummaryAttributesJobsService"}destroy(){super.destroy()}getSummaryAttributesJobs(){super.getJobs(this.url)}getSummaryAttributesJob(e){super.getJobs(this.url+"/"+e)}addSummaryAttributesJob(e,t){super.addJob(this.url,e,j,t)}}s.SummaryAttributesJobsService=Et;
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class vt extends he{constructor(e,t){super(e,t),this.kernelDensityJobs={},this.summaryMeshJobs={},this.queryJobs={},this.summaryRegionJobs={},this.vectorClipJobs={},this.overlayGeoJobs={},this.buffersJobs={},this.topologyValidatorJobs={},this.summaryAttributesJobs={}}getKernelDensityJobs(e,t){var r=this,s=r._processFormat(t);new ut(r.url,{proxy:r.proxy,withCredentials:r.withCredentials,serverType:r.serverType,eventListeners:{scope:r,processCompleted:e,processFailed:e},format:s}).getKernelDensityJobs()}getKernelDensityJob(e,t,r){var s=this,n=s._processFormat(r);new ut(s.url,{proxy:s.proxy,withCredentials:s.withCredentials,serverType:s.serverType,eventListeners:{scope:s,processCompleted:t,processFailed:t},format:n}).getKernelDensityJob(e)}addKernelDensityJob(e,t,r,s){var n=this,i=n._processFormat(s);new ut(n.url,{proxy:n.proxy,withCredentials:n.withCredentials,eventListeners:{scope:n,processCompleted:t,processFailed:t,processRunning(e){n.kernelDensityJobs[e.id]=e.state}},format:i}).addKernelDensityJob(e,r)}getKernelDensityJobState(e){return this.kernelDensityJobs[e]}getSummaryMeshJobs(e,t){var r=this,s=r._processFormat(t);new ct(r.url,{proxy:r.proxy,withCredentials:r.withCredentials,serverType:r.serverType,eventListeners:{scope:r,processCompleted:e,processFailed:e},format:s}).getSummaryMeshJobs()}getSummaryMeshJob(e,t,r){var s=this,n=s._processFormat(r);new ct(s.url,{proxy:s.proxy,withCredentials:s.withCredentials,serverType:s.serverType,eventListeners:{scope:s,processCompleted:t,processFailed:t},format:n}).getSummaryMeshJob(e)}addSummaryMeshJob(e,t,r,s){var n=this,i=n._processFormat(s);new ct(n.url,{proxy:n.proxy,withCredentials:n.withCredentials,eventListeners:{scope:n,processCompleted:t,processFailed:t,processRunning(e){n.summaryMeshJobs[e.id]=e.state}},format:i}).addSummaryMeshJob(e,r)}getSummaryMeshJobState(e){return this.summaryMeshJobs[e]}getQueryJobs(e,t){var r=this,s=r._processFormat(t);new ht(r.url,{proxy:r.proxy,withCredentials:r.withCredentials,serverType:r.serverType,eventListeners:{scope:r,processCompleted:e,processFailed:e},format:s}).getQueryJobs()}getQueryJob(e,t,r){var s=this,n=s._processFormat(r);new ht(s.url,{proxy:s.proxy,withCredentials:s.withCredentials,serverType:s.serverType,eventListeners:{scope:s,processCompleted:t,processFailed:t},format:n}).getQueryJob(e)}addQueryJob(e,t,r,s){var n=this,i=n._processParams(e),o=n._processFormat(s);new ht(n.url,{proxy:n.proxy,withCredentials:n.withCredentials,eventListeners:{scope:n,processCompleted:t,processFailed:t,processRunning(e){n.queryJobs[e.id]=e.state}},format:o}).addQueryJob(i,r)}getQueryJobState(e){return this.queryJobs[e]}getSummaryRegionJobs(e,t){var r=this,s=r._processFormat(t);new pt(r.url,{proxy:r.proxy,withCredentials:r.withCredentials,serverType:r.serverType,eventListeners:{scope:r,processCompleted:e,processFailed:e},format:s}).getSummaryRegionJobs()}getSummaryRegionJob(e,t,r){var s=this,n=s._processFormat(r);new pt(s.url,{proxy:s.proxy,withCredentials:s.withCredentials,serverType:s.serverType,eventListeners:{scope:s,processCompleted:t,processFailed:t},format:n}).getSummaryRegionJob(e)}addSummaryRegionJob(e,t,r,s){var n=this,i=n._processFormat(s);new pt(n.url,{proxy:n.proxy,withCredentials:n.withCredentials,eventListeners:{scope:n,processCompleted:t,processFailed:t,processRunning(e){n.summaryRegionJobs[e.id]=e.state}},format:i}).addSummaryRegionJob(e,r)}getSummaryRegionJobState(e){return this.summaryRegionJobs[e]}getVectorClipJobs(e,t){var r=this,s=r._processFormat(t);new mt(r.url,{proxy:r.proxy,withCredentials:r.withCredentials,serverType:r.serverType,eventListeners:{scope:r,processCompleted:e,processFailed:e},format:s}).getVectorClipJobs()}getVectorClipJob(e,t,r){var s=this,n=s._processFormat(r);new mt(s.url,{proxy:s.proxy,withCredentials:s.withCredentials,serverType:s.serverType,eventListeners:{scope:s,processCompleted:t,processFailed:t},format:n}).getVectorClipJob(e)}addVectorClipJob(e,t,r,s){var n=this,i=n._processParams(e),o=n._processFormat(s);new mt(n.url,{proxy:n.proxy,withCredentials:n.withCredentials,serverType:n.serverType,eventListeners:{scope:n,processCompleted:t,processFailed:t,processRunning(e){n.vectorClipJobs[e.id]=e.state}},format:o}).addVectorClipJob(i,r)}getVectorClipJobState(e){return this.vectorClipJobs[e]}getOverlayGeoJobs(e,t){var r=this,s=r._processFormat(t);new ft(r.url,{proxy:r.proxy,withCredentials:r.withCredentials,serverType:r.serverType,eventListeners:{scope:r,processCompleted:e,processFailed:e},format:s}).getOverlayGeoJobs()}getOverlayGeoJob(e,t,r){var s=this,n=s._processFormat(r);new ft(s.url,{proxy:s.proxy,withCredentials:s.withCredentials,serverType:s.serverType,eventListeners:{scope:s,processCompleted:t,processFailed:t},format:n}).getOverlayGeoJob(e)}addOverlayGeoJob(e,t,r,s){var n=this,i=n._processFormat(s);new ft(n.url,{proxy:n.proxy,withCredentials:n.withCredentials,serverType:n.serverType,eventListeners:{scope:n,processCompleted:t,processFailed:t,processRunning:function(e){n.overlayGeoJobs[e.id]=e.state}},format:i}).addOverlayGeoJob(e,r)}getoverlayGeoJobState(e){return this.overlayGeoJobs[e]}getBuffersJobs(e,t){var r=this,s=r._processFormat(t);new yt(r.url,{proxy:r.proxy,withCredentials:r.withCredentials,serverType:r.serverType,eventListeners:{scope:r,processCompleted:e,processFailed:e},format:s}).getBuffersJobs()}getBuffersJob(e,t,r){var s=this,n=s._processFormat(r);new yt(s.url,{proxy:s.proxy,withCredentials:s.withCredentials,serverType:s.serverType,eventListeners:{scope:s,processCompleted:t,processFailed:t},format:n}).getBuffersJob(e)}addBuffersJob(e,t,r,s){var n=this,i=n._processFormat(s);new yt(n.url,{proxy:n.proxy,withCredentials:n.withCredentials,serverType:n.serverType,eventListeners:{scope:n,processCompleted:t,processFailed:t,processRunning:function(e){n.buffersJobs[e.id]=e.state}},format:i}).addBuffersJob(e,r)}getBuffersJobState(e){return this.buffersJobs[e]}getTopologyValidatorJobs(e,t){var r=this,s=r._processFormat(t);new gt(r.url,{proxy:r.proxy,withCredentials:r.withCredentials,serverType:r.serverType,eventListeners:{scope:r,processCompleted:e,processFailed:e},format:s}).getTopologyValidatorJobs()}getTopologyValidatorJob(e,t,r){var s=this,n=s._processFormat(r);new gt(s.url,{proxy:s.proxy,withCredentials:s.withCredentials,serverType:s.serverType,eventListeners:{scope:s,processCompleted:t,processFailed:t},format:n}).getTopologyValidatorJob(e)}addTopologyValidatorJob(e,t,r,s){var n=this,i=n._processFormat(s);new gt(n.url,{proxy:n.proxy,withCredentials:n.withCredentials,serverType:n.serverType,eventListeners:{scope:n,processCompleted:t,processFailed:t,processRunning:function(e){n.topologyValidatorJobs[e.id]=e.state}},format:i}).addTopologyValidatorJob(e,r)}getTopologyValidatorJobState(e){return this.topologyValidatorJobs[e]}getSummaryAttributesJobs(e,t){var r=this,s=r._processFormat(t);new Et(r.url,{proxy:r.proxy,withCredentials:r.withCredentials,serverType:r.serverType,eventListeners:{scope:r,processCompleted:e,processFailed:e},format:s}).getSummaryAttributesJobs()}getSummaryAttributesJob(e,t,r){var s=this,n=s._processFormat(r);new Et(s.url,{proxy:s.proxy,withCredentials:s.withCredentials,serverType:s.serverType,eventListeners:{scope:s,processCompleted:t,processFailed:t},format:n}).getSummaryAttributesJob(e)}addSummaryAttributesJob(e,t,r,s){var n=this,i=n._processFormat(s);new Et(n.url,{proxy:n.proxy,withCredentials:n.withCredentials,serverType:n.serverType,eventListeners:{scope:n,processCompleted:t,processFailed:t,processRunning:function(e){n.summaryAttributesJobs[e.id]=e.state}},format:i}).addSummaryAttributesJob(e,r)}getSummaryAttributesJobState(e){return this.summaryAttributesJobs[e]}_processFormat(e){return e||_.GEOJSON}_processParams(e){return e?(e.geometryQuery&&(e.geometryQuery=this._convertPatams(e.geometryQuery)),e.geometryClip&&(e.geometryClip=this._convertPatams(e.geometryClip)),e):{}}_convertPatams(e){var t={};if(e.length<1)t="";else{for(var r=[],s=0;s<e.length;s++){var n={};n.x=e[s].x,n.y=e[s].y,r.push(n)}t.type="REGION",t.points=r}return t}}tt.REST.ProcessingService=vt,
/* Copyright© 2000 - 2019 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/r.d(t,"ElasticSearch",function(){return f}),r.d(t,"SecurityManager",function(){return b}),r.d(t,"KernelDensityJobParameter",function(){return H}),r.d(t,"SingleObjectQueryJobsParameter",function(){return V}),r.d(t,"SummaryAttributesJobsParameter",function(){return j}),r.d(t,"SummaryMeshJobParameter",function(){return q}),r.d(t,"SummaryRegionJobParameter",function(){return W}),r.d(t,"OverlayGeoJobParameter",function(){return K}),r.d(t,"BuffersAnalystJobsParameter",function(){return Y}),r.d(t,"TopologyValidatorJobsParameter",function(){return Q}),r.d(t,"OutputSetting",function(){return J}),r.d(t,"MappingParameters",function(){return k}),r.d(t,"GeoCodingParameter",function(){return X}),r.d(t,"GeoDecodingParameter",function(){return z}),r.d(t,"FileTypes",function(){return $}),r.d(t,"FileConfig",function(){return Z}),r.d(t,"FileModel",function(){return ee}),r.d(t,"MessageBox",function(){return te}),r.d(t,"CommonContainer",function(){return qe}),r.d(t,"DropDownBox",function(){return Ke}),r.d(t,"Select",function(){return We}),r.d(t,"AttributesPopContainer",function(){return Qe}),r.d(t,"PopContainer",function(){return Ye}),r.d(t,"IndexTabsPageContainer",function(){return Xe}),r.d(t,"CityTabsPage",function(){return ze}),r.d(t,"NavTabsPage",function(){return $e}),r.d(t,"PaginationContainer",function(){return Ze}),r.d(t,"widgetsUtil",function(){return et}),r.d(t,"FileReaderUtil",function(){return ke}),r.d(t,"MapVLayer",function(){return it}),r.d(t,"MapVRenderer",function(){return nt}),r.d(t,"AddressMatchService",function(){return at}),r.d(t,"ProcessingService",function(){return vt}),r.d(t,"SuperMap",function(){return tt})},function(e,t){!function(t){"use strict";if(t.__disableNativeFetch||!t.fetch){a.prototype.append=function(e,t){e=i(e),t=o(t);var r=this.map[e];r||(r=[],this.map[e]=r),r.push(t)},a.prototype.delete=function(e){delete this.map[i(e)]},a.prototype.get=function(e){var t=this.map[i(e)];return t?t[0]:null},a.prototype.getAll=function(e){return this.map[i(e)]||[]},a.prototype.has=function(e){return this.map.hasOwnProperty(i(e))},a.prototype.set=function(e,t){this.map[i(e)]=[o(t)]},a.prototype.forEach=function(e,t){Object.getOwnPropertyNames(this.map).forEach(function(r){this.map[r].forEach(function(s){e.call(t,s,r,this)},this)},this)};var r={blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t},s=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];p.prototype.clone=function(){return new p(this)},c.call(p.prototype),c.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new a(this.headers),url:this.url})},m.error=function(){var e=new m(null,{status:0,statusText:""});return e.type="error",e};var n=[301,302,303,307,308];m.redirect=function(e,t){if(-1===n.indexOf(t))throw new RangeError("Invalid status code");return new m(null,{status:t,headers:{location:e}})},t.Headers=a,t.Request=p,t.Response=m,t.fetch=function(e,t){return new Promise(function(s,n){var i;i=p.prototype.isPrototypeOf(e)&&!t?e:new p(e,t);var o=new XMLHttpRequest;var l=!1;function u(){if(4===o.readyState){var e=1223===o.status?204:o.status;if(e<100||e>599){if(l)return;return l=!0,void n(new TypeError("Network request failed"))}var t={status:e,statusText:o.statusText,headers:function(e){var t=new a;return e.getAllResponseHeaders().trim().split("\n").forEach(function(e){var r=e.trim().split(":"),s=r.shift().trim(),n=r.join(":").trim();t.append(s,n)}),t}(o),url:"responseURL"in o?o.responseURL:/^X-Request-URL:/m.test(o.getAllResponseHeaders())?o.getResponseHeader("X-Request-URL"):void 0},r="response"in o?o.response:o.responseText;l||(l=!0,s(new m(r,t)))}}o.onreadystatechange=u,o.onload=u,o.onerror=function(){l||(l=!0,n(new TypeError("Network request failed")))},o.open(i.method,i.url,!0);try{"include"===i.credentials&&("withCredentials"in o?o.withCredentials=!0:console&&console.warn&&console.warn("withCredentials is not supported, you can ignore this warning"))}catch(e){console&&console.warn&&console.warn("set withCredentials error:"+e)}"responseType"in o&&r.blob&&(o.responseType="blob"),i.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),o.send(void 0===i._bodyInit?null:i._bodyInit)})},t.fetch.polyfill=!0,void 0!==e&&e.exports&&(e.exports=t.fetch)}function i(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function o(e){return"string"!=typeof e&&(e=String(e)),e}function a(e){this.map={},e instanceof a?e.forEach(function(e,t){this.append(t,e)},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function l(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function u(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function h(e){var t=new FileReader;return t.readAsArrayBuffer(e),u(t)}function c(){return this.bodyUsed=!1,this._initBody=function(e,t){if(this._bodyInit=e,"string"==typeof e)this._bodyText=e;else if(r.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e,this._options=t;else if(r.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(e){if(!r.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e))throw new Error("unsupported BodyInit type")}else this._bodyText=""},r.blob?(this.blob=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(h)},this.text=function(){var e,t,r,s,n,i,o,a=l(this);if(a)return a;if(this._bodyBlob)return e=this._bodyBlob,t=this._options,r=new FileReader,s=t.headers.map["content-type"]?t.headers.map["content-type"].toString():"",n=/charset\=[0-9a-zA-Z\-\_]*;?/,i=e.type.match(n)||s.match(n),o=[e],i&&o.push(i[0].replace(/^charset\=/,"").replace(/;$/,"")),r.readAsText.apply(r,o),u(r);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var e=l(this);return e||Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(d)}),this.json=function(){return this.text().then(JSON.parse)},this}function p(e,t){var r,n,i=(t=t||{}).body;if(p.prototype.isPrototypeOf(e)){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new a(e.headers)),this.method=e.method,this.mode=e.mode,i||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=e;if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new a(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),s.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i,t)}function d(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),s=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(s),decodeURIComponent(n))}}),t}function m(e,t){t||(t={}),this._initBody(e,t),this.type="default",this.status=t.status,this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText,this.headers=t.headers instanceof a?t.headers:new a(t.headers),this.url=t.url||""}}("undefined"!=typeof self?self:this)},function(e,t){var r,s,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{s="function"==typeof clearTimeout?clearTimeout:o}catch(e){s=o}}();var l,u=[],h=!1,c=-1;function p(){h&&l&&(h=!1,l.length?u=l.concat(u):c=-1,u.length&&d())}function d(){if(!h){var e=a(p);h=!0;for(var t=u.length;t;){for(l=u,u=[];++c<t;)l&&l[c].run();c=-1,t=u.length}l=null,h=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===o||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function f(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new m(e,t)),1!==u.length||h||a(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=f,n.addListener=f,n.once=f,n.off=f,n.removeListener=f,n.removeAllListeners=f,n.emit=f,n.prependListener=f,n.prependOnceListener=f,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,r){(function(e,t){!function(e,r){"use strict";if(!e.setImmediate){var s,n,i,o,a,l=1,u={},h=!1,c=e.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(e);p=p&&p.setTimeout?p:e,"[object process]"==={}.toString.call(e.process)?s=function(e){t.nextTick(function(){m(e)})}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){m(e.data)},s=function(e){i.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,s=function(e){var t=c.createElement("script");t.onreadystatechange=function(){m(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):s=function(e){setTimeout(m,0,e)}:(o="setImmediate$"+Math.random()+"$",a=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&m(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",a,!1):e.attachEvent("onmessage",a),s=function(t){e.postMessage(o+t,"*")}),p.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var n={callback:e,args:t};return u[l]=n,s(l),l++},p.clearImmediate=d}function d(e){delete u[e]}function m(e){if(h)setTimeout(m,0,e);else{var t=u[e];if(t){h=!0;try{!function(e){var t=e.callback,s=e.args;switch(s.length){case 0:t();break;case 1:t(s[0]);break;case 2:t(s[0],s[1]);break;case 3:t(s[0],s[1],s[2]);break;default:t.apply(r,s)}}(t)}finally{d(e),h=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,r(3),r(9))},function(e,t,r){(function(e){var s=void 0!==e&&e||"undefined"!=typeof self&&self||window,n=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(n.call(setTimeout,s,arguments),clearTimeout)},t.setInterval=function(){return new i(n.call(setInterval,s,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(s,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r(10),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(3))}]);